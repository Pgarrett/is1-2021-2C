

----QUIT----(9 March 2021 14:58:42) CuisUniversity-4532.image priorSource: 13044060!

----STARTUP---- (9 March 2021 14:58:43) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4532.image!


----QUIT----(9 March 2021 14:58:43) CuisUniversity-4532.image priorSource: 16885479!

----STARTUP---- (25 October 2021 20:34:34) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/19-MarsRover-ElRegreso/MarsRover-WithHeading.st----!

TestCase subclass: #MarsRoverReportTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!

!classDefinition: #MarsRoverReportTest category: 'MarsRover-WithHeading' stamp: 'PhG 10/25/2021 20:50:16'!
TestCase subclass: #MarsRoverReportTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRoverReportTest methodsFor: 'nil' stamp: 'PhG 10/25/2021 20:50:53'!
test01! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:53:32'!
test01RoverMovesForwardIsInformedInPositionLog! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:53:50' prior: 50859841!
test01RoverMovesForwardIsInformedInPositionLog

	| marsRover |
	
	marsRover := MarsRover new.! !

!methodRemoval: MarsRoverReportTest #test01 stamp: 'PhG 10/25/2021 20:54:03'!
test01!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:54:14' prior: 50859846!
test01RoverMovesForwardIsInformedInPositionLog

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth .! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:54:47' prior: 50859856!
test01RoverMovesForwardIsInformedInPositionLog

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	marsRover processCommand: 'ff'.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:55:00' prior: 50859864!
test01RoverMovesForwardIsInformedInPositionLog

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	marsRover process: 'ff'.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:55:37' prior: 50859873!
test01RoverMovesForwardIsInformedInPositionLog

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	self assert: OrderedCollection new equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:56:06'!
test01PositionLogIsEmptyWhenRoverDidNotMove

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	self assert: OrderedCollection new equals: 	marsRover positionLog.! !

!methodRemoval: MarsRoverReportTest #test01RoverMovesForwardIsInformedInPositionLog stamp: 'PhG 10/25/2021 20:56:06'!
test01RoverMovesForwardIsInformedInPositionLog

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	self assert: OrderedCollection new equals: 	marsRover positionLog.!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:56:08'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 20:56:16'!
positionLog
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 20:56:24' prior: 50859914!
positionLog
	^OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:56:25'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:56:25'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:56:48'!
test02DirectionLogIsEmptyWhenRoverDidNotMove

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	self assert: OrderedCollection new equals: 	marsRover directionLog.! !

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:56:50'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 20:56:57'!
directionLog
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 20:57:05' prior: 50859943!
directionLog
	^OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:57:06'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:57:06'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:57:06'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:57:21'!
test03FullLogIsEmptyWhenRoverDidNotMove

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	self assert: OrderedCollection new equals: 	marsRover directionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:57:24' prior: 50859963!
test03FullLogIsEmptyWhenRoverDidNotMove

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	self assert: OrderedCollection new equals: 	marsRover fullLog.! !

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:57:26'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 20:57:36'!
fullLog
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 20:57:41' prior: 50859985!
fullLog
	^OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:57:43'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:57:43'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:57:43'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 20:57:43'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:58:11'!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	self assert: OrderedCollection new equals: 	marsRover fullLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:58:22' prior: 50860008!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: OrderedCollection new equals: 	marsRover fullLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:58:39' prior: 50860018!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 'f') equals: 	marsRover fullLog.! !

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 20:58:47'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 20:59:07' prior: 50860029!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 'f') equals: 	marsRover positionLog.! !

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/25/2021 21:00:14'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head commandsExecuted'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRover methodsFor: 'initialization' stamp: 'PhG 10/25/2021 21:00:13' prior: 50859525!
initializeAt: aPosition heading: aHeadingType

	position := aPosition.
	head := aHeadingType for: self.
	commandsExecuted := OrderedCollection new.! !

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/25/2021 21:00:54'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionCommandsExecuted'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRover methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:00:54' prior: 50860064!
initializeAt: aPosition heading: aHeadingType

	position := aPosition.
	head := aHeadingType for: self.
	positionCommandsExecuted := OrderedCollection new.! !

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/25/2021 21:01:06'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionCommandsExecuted directionCommandsExecuted'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRover methodsFor: 'initialization' stamp: 'PhG 10/25/2021 21:01:05' prior: 50860081!
initializeAt: aPosition heading: aHeadingType

	position := aPosition.
	head := aHeadingType for: self.
	positionCommandsExecuted := OrderedCollection new.
	directionCommandsExecuted := OrderedCollection new.! !
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/25/2021 21:03:14' prior: 50859607!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ ^ self moveForward ].
	(self isBackwardCommand: aCommand) ifTrue: [ ^ self moveBackward ].
	(self isRotateRightCommand: aCommand) ifTrue: [ self rotateRight ].
	(self isRotateLeftCommand: aCommand) ifTrue: [ ^ self rotateLeft ].

	self signalInvalidCommand.! !

!testRun: #MarsRoverTest #test01DoesNotMoveWhenNoCommand stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test02IsAtFailsForDifferentPosition stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test03IsAtFailsForDifferentHeading stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test04IncrementsYAfterMovingForwardWhenHeadingNorth stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test06DecrementsYAfterMovingBackwardsWhenHeadingNorth stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test07PointToEashAfterRotatingRightWhenHeadingNorth stamp: 'PhG 10/25/2021 21:03:24'!
ERROR!

!testRun: #MarsRoverTest #test08PointsToWestAfterRotatingLeftWhenPointingNorth stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test09DoesNotProcessInvalidCommand stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test10CanProcessMoreThanOneCommand stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test11IncrementsXAfterMovingForwareWhenHeadingEast stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test12DecrementsXAfterMovingBackwardWhenHeadingEast stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test13PointsToSouthAfterRotatingRightWhenHeadingEast stamp: 'PhG 10/25/2021 21:03:24'!
ERROR!

!testRun: #MarsRoverTest #test14PointsToNorthAfterRotatingLeftWhenPointingEast stamp: 'PhG 10/25/2021 21:03:24'!
PASSED!

!testRun: #MarsRoverTest #test15ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingSouth stamp: 'PhG 10/25/2021 21:03:24'!
ERROR!

!testRun: #MarsRoverTest #test16ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingWest stamp: 'PhG 10/25/2021 21:03:24'!
ERROR!
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/25/2021 21:04:03' prior: 50860109!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ ^ self moveForward ].
	(self isBackwardCommand: aCommand) ifTrue: [ ^ self moveBackward ].
	(self isRotateRightCommand: aCommand) ifTrue: [ ^ self rotateRight ].
	(self isRotateLeftCommand: aCommand) ifTrue: [ ^ self rotateLeft ].

	self signalInvalidCommand.! !
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/25/2021 21:06:14' prior: 50860178!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ ^ self moveForward ].
	(self isBackwardCommand: aCommand) ifTrue: [ ^ self moveBackward ].
	(self isRotateRightCommand: aCommand) ifTrue: [ 
		^ self rotateRight 
		].
	(self isRotateLeftCommand: aCommand) ifTrue: [ ^ self rotateLeft ].

	self signalInvalidCommand.! !
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/25/2021 21:07:19' prior: 50860192!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ 
		self moveForward.
		positionCommandsExecuted add: position.
		^ self
		].
	(self isBackwardCommand: aCommand) ifTrue: [ ^ self moveBackward ].
	(self isRotateRightCommand: aCommand) ifTrue: [ ^ self rotateRight ].
	(self isRotateLeftCommand: aCommand) ifTrue: [ ^ self rotateLeft ].

	self signalInvalidCommand.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:07:37' prior: 50860045!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 1@2) equals: 	marsRover positionLog.! !

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:07:48'!
FAILURE!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:08:15' prior: 50859918!
positionLog
	^positionCommandsExecuted.! !

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:08:19'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:08:19'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:08:19'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:08:19'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:08:19'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:08:56'!
test05PositionLogContainsForwardEntriesWhenRoverMovesForwardTwice

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 1@2) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:09:07' prior: 50860261!
test05PositionLogContainsForwardEntriesWhenRoverMovesForwardTwice

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'ff'.
	
	self assert: (OrderedCollection with: 1@3) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:09:12' prior: 50860273!
test05PositionLogContainsForwardEntriesWhenRoverMovesForwardTwice

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'ff'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@3) equals: 	marsRover positionLog.! !

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardEntriesWhenRoverMovesForwardTwice stamp: 'PhG 10/25/2021 21:09:18'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:09:18'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:09:18'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:09:18'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:09:18'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardEntriesWhenRoverMovesForwardTwice stamp: 'PhG 10/25/2021 21:09:18'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:09:24' prior: 50860285!
test05PositionLogContainsForwardEntriesWhenRoverMovesForwardTwice

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@3) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:09:50'!
test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@3) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:09:54' prior: 50860333!
test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@1) equals: 	marsRover positionLog.! !

!methodRemoval: MarsRoverReportTest #test05PositionLogContainsForwardEntriesWhenRoverMovesForwardTwice stamp: 'PhG 10/25/2021 21:09:57'!
test05PositionLogContainsForwardEntriesWhenRoverMovesForwardTwice

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@3) equals: 	marsRover positionLog.!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:10:00'!
FAILURE!
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/25/2021 21:10:34' prior: 50860206!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ 
		self moveForward.
		positionCommandsExecuted add: position.
		^ self
		].
	(self isBackwardCommand: aCommand) ifTrue: [ 
		self moveBackward.
		positionCommandsExecuted add: position.
		^ self
		].
	(self isRotateRightCommand: aCommand) ifTrue: [ ^ self rotateRight ].
	(self isRotateLeftCommand: aCommand) ifTrue: [ ^ self rotateLeft ].

	self signalInvalidCommand.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:10:37'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:10:37'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:10:37'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:10:37'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:10:37'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:11:20'!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@1) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:11:22' prior: 50860413!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@1) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:11:32' prior: 50860425!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:11:38' prior: 50860437!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: 	marsRover directionLog.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:11:43'!
FAILURE!
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/25/2021 21:12:11' prior: 50860376!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ 
		self moveForward.
		positionCommandsExecuted add: position.
		^ self
		].
	(self isBackwardCommand: aCommand) ifTrue: [ 
		self moveBackward.
		positionCommandsExecuted add: position.
		^ self
		].
	(self isRotateRightCommand: aCommand) ifTrue: [ 
		self rotateRight.
		directionCommandsExecuted add: head.
		^ self.
		].
	(self isRotateLeftCommand: aCommand) ifTrue: [ ^ self rotateLeft ].

	self signalInvalidCommand.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:12:16'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:12:16'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:12:16'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:12:16'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:12:16'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:12:16'!
FAILURE!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:12:16'!
FAILURE!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:12:36' prior: 50859947!
directionLog
	^directionCommandsExecuted .! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:12:37' prior: 50860512!
directionLog
	^directionCommandsExecuted.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:12:55'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:12:55'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:12:55'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:12:55'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:12:55'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:12:55'!
FAILURE!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:12:55'!
FAILURE!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:13:13'!
FAILURE!

self directionLog!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:14:56'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:15:09' prior: 50860449!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: 	marsRover directionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:15:49' prior: 50860559!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover expected result |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	expected :=  (OrderedCollection with: MarsRoverHeadingEast).
	result :=	marsRover directionLog.
	self assert: expected equals: result.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:15:56'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:16:30' prior: 50860571!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover expected result |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	expected :=  (OrderedCollection with: MarsRoverHeadingEast new).
	result :=	marsRover directionLog.
	self assert: expected equals: result.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:16:32'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:16:42' prior: 50860589!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover expected result |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	expected :=  (OrderedCollection with: (MarsRoverHeadingEast new)).
	result :=	marsRover directionLog.
	self assert: expected equals: result.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:16:43'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:16:50' prior: 50860607!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover expected result |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	expected :=  (OrderedCollection with: #MarsRoverHeadingEast).
	result :=	marsRover directionLog.
	self assert: expected equals: result.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:16:51'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:16:56' prior: 50860625!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover expected result |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	expected :=  (OrderedCollection with: MarsRoverHeadingEast).
	result :=	marsRover directionLog.
	self assert: expected equals: result.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:17:31' prior: 50860643!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover expected result |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	expected :=  (OrderedCollection with: (MarsRoverHeadingEast for: marsRover)).
	result :=	marsRover directionLog.
	self assert: expected equals: result.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:17:33'!
FAILURE!
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/25/2021 21:21:04' prior: 50860465!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ 
		self moveForward.
		positionCommandsExecuted add: position.
		^ self
		].
	(self isBackwardCommand: aCommand) ifTrue: [ 
		self moveBackward.
		positionCommandsExecuted add: position.
		^ self
		].
	(self isRotateRightCommand: aCommand) ifTrue: [ 
		self rotateRight.
		directionCommandsExecuted add: (head class).
		^ self.
		].
	(self isRotateLeftCommand: aCommand) ifTrue: [ ^ self rotateLeft ].

	self signalInvalidCommand.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:21:10'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:21:21' prior: 50860657!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover expected result |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	expected :=  (OrderedCollection with: MarsRoverHeadingEast ).
	result :=	marsRover directionLog.
	self assert: expected equals: result.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:21:26' prior: 50860699!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover expected result |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	expected := OrderedCollection with: MarsRoverHeadingEast.
	result :=	marsRover directionLog.
	self assert: expected equals: result.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:21:27'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:21:27'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:21:27'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:21:27'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:21:27'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:21:27'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:21:27'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:21:47' prior: 50860713!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: marsRover directionLog.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:21:50'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:21:50'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:21:50'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:21:50'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:21:50'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:21:50'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:21:50'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:22:09'!
test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: marsRover directionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:22:18' prior: 50860795!
test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast with: MarsRoverHeadingNorth) equals: marsRover directionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:22:21' prior: 50860808!
test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'rl'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast with: MarsRoverHeadingNorth) equals: marsRover directionLog.! !

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/25/2021 21:22:22'!
FAILURE!
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/25/2021 21:22:48' prior: 50860675!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ 
		self moveForward.
		positionCommandsExecuted add: position.
		^ self
		].
	(self isBackwardCommand: aCommand) ifTrue: [ 
		self moveBackward.
		positionCommandsExecuted add: position.
		^ self
		].
	(self isRotateRightCommand: aCommand) ifTrue: [ 
		self rotateRight.
		directionCommandsExecuted add: (head class).
		^ self.
		].
	(self isRotateLeftCommand: aCommand) ifTrue: [ 
		self rotateLeft.
		directionCommandsExecuted add: (head class).
		^self.
		].

	self signalInvalidCommand.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:22:54'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:22:54'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:22:54'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:22:54'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:22:54'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:22:54'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/25/2021 21:22:54'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:24:02'!
test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'rl'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast with: MarsRoverHeadingNorth) equals: marsRover directionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:24:07' prior: 50860889!
test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast with: MarsRoverHeadingNorth) equals: marsRover directionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:24:21' prior: 50860903!
test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: marsRover fullLog.! !

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:24:23'!
FAILURE!

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/25/2021 21:24:46'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionCommandsExecuted directionCommandsExecuted allComandsExecuted'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRover methodsFor: 'initialization' stamp: 'PhG 10/25/2021 21:24:44' prior: 50860099!
initializeAt: aPosition heading: aHeadingType

	position := aPosition.
	head := aHeadingType for: self.
	positionCommandsExecuted := OrderedCollection new.
	directionCommandsExecuted := OrderedCollection new.
	allComandsExecuted := OrderedCollection new.! !
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/25/2021 21:25:14' prior: 50860839!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ 
		self moveForward.
		positionCommandsExecuted add: position.
		allComandsExecuted add: position.
		^ self
		].
	(self isBackwardCommand: aCommand) ifTrue: [ 
		self moveBackward.
		positionCommandsExecuted add: position.
		allComandsExecuted add: position.
		^ self
		].
	(self isRotateRightCommand: aCommand) ifTrue: [ 
		self rotateRight.
		directionCommandsExecuted add: (head class).
		allComandsExecuted add: (head class).
		^ self.
		].
	(self isRotateLeftCommand: aCommand) ifTrue: [ 
		self rotateLeft.
		directionCommandsExecuted add: (head class).
		allComandsExecuted add: (head class).
		^self.
		].

	self signalInvalidCommand.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:25:16'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:25:16'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:25:16'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:25:16'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:25:16'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:25:16'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/25/2021 21:25:16'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:25:16'!
FAILURE!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:25:16'!
FAILURE!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:25:28' prior: 50859989!
fullLog
	^allComandsExecuted .! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:25:29' prior: 50861021!
fullLog
	^allComandsExecuted.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:25:31'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:25:31'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:25:31'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:25:31'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:25:31'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:25:31'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/25/2021 21:25:31'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:25:31'!
PASSED!

----SNAPSHOT----(25 October 2021 21:25:40) CuisUniversity-4532.image priorSource: 16885703!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:26:42'!
test09CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: marsRover fullLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:27:02' prior: 50861067!
test09CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: 1@2 equals: marsRover currentPositionStatus.! !

!testRun: #MarsRoverReportTest #test09CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/25/2021 21:27:28'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:27:35'!
currentPositionStatus
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:27:44' prior: 50861095!
currentPositionStatus
	^position.! !

!testRun: #MarsRoverReportTest #test09CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!

!testRun: #MarsRoverReportTest #test09CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/25/2021 21:28:00'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:28:23'!
test10CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: 1@2 equals: marsRover currentPositionStatus.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:28:59'!
test10CurrentDirectionStatusIsHeadingEastWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: 1@2 equals: marsRover currentPositionStatus.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:29:14' prior: 50861159!
test10CurrentDirectionStatusIsHeadingEastWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: MarsRoverHeadingEast equals: marsRover currentDirectionStatus.! !

!testRun: #MarsRoverReportTest #test10CurrentDirectionStatusIsHeadingEastWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:29:23'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:29:30'!
currentDirectionStatus
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:29:38' prior: 50861185!
currentDirectionStatus
	^head class.! !

!testRun: #MarsRoverReportTest #test10CurrentDirectionStatusIsHeadingEastWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test09CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test10CurrentDirectionStatusIsHeadingEastWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!

!testRun: #MarsRoverReportTest #test10CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/25/2021 21:29:40'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:30:10'!
test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: MarsRoverHeadingEast equals: marsRover currentDirectionStatus.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:30:12' prior: 50861247!
test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fr'.
	
	self assert: MarsRoverHeadingEast equals: marsRover currentDirectionStatus.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:30:28' prior: 50861259!
test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: marsRover currentDirectionStatus.! !

!methodRemoval: MarsRoverReportTest #test10CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/25/2021 21:31:13'!
test10CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: 1@2 equals: marsRover currentPositionStatus.!

!testRun: #MarsRoverReportTest #test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:31:18'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/25/2021 21:31:50' prior: 50861271!
test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: marsRover currentFullStatus.! !

!testRun: #MarsRoverReportTest #test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:31:51'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:32:04'!
currentFullStatus
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/25/2021 21:32:19' prior: 50861319!
currentFullStatus
	^OrderedCollection with: position with: (head class).! !

!testRun: #MarsRoverReportTest #test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test09CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test10CurrentDirectionStatusIsHeadingEastWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:32:21'!
PASSED!

!testRun: #MarsRoverReportTest #test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test09CurrentPositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test10CurrentDirectionStatusIsHeadingEastWhenRoverRotatedRight stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

!testRun: #MarsRoverReportTest #test11CurrentFullStatusIsAStepForwardAndHeadingEastWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/25/2021 21:33:03'!
PASSED!

----STARTUP---- (26 October 2021 08:41:42) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!

!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 08:42:57'!
moveTowards: anOffset
	
	position := position + (0@-1)! !
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 08:43:02' prior: 50861440!
moveTowards: anOffset
	
	position := position + anOffset! !
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 08:43:31' prior: 50859597!
moveWest
	
	self moveTowards: -1@0.! !
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 08:43:38' prior: 50859593!
moveSouth
	
	self moveTowards: 0@-1! !
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 08:43:47' prior: 50859589!
moveNorth
	
	self moveTowards: 0@1! !
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 08:43:52' prior: 50859581!
moveEast
	
	self moveTowards: 1@0! !

!testRun: #MarsRoverTest #test01DoesNotMoveWhenNoCommand stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test02IsAtFailsForDifferentPosition stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test03IsAtFailsForDifferentHeading stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test04IncrementsYAfterMovingForwardWhenHeadingNorth stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test06DecrementsYAfterMovingBackwardsWhenHeadingNorth stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test07PointToEashAfterRotatingRightWhenHeadingNorth stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test08PointsToWestAfterRotatingLeftWhenPointingNorth stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test09DoesNotProcessInvalidCommand stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test10CanProcessMoreThanOneCommand stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test11IncrementsXAfterMovingForwareWhenHeadingEast stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test12DecrementsXAfterMovingBackwardWhenHeadingEast stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test13PointsToSouthAfterRotatingRightWhenHeadingEast stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test14PointsToNorthAfterRotatingLeftWhenPointingEast stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test15ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingSouth stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverTest #test16ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingWest stamp: 'PhG 10/26/2021 08:43:55'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 08:43:58'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 08:43:58'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 08:43:58'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 08:43:58'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 08:43:58'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 08:43:58'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 08:43:58'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 08:43:58'!
PASSED!
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 08:44:23'!
nowHead: newDirection
	
	head := newDirection! !
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 08:44:42' prior: 50859543!
headWest
	
	self nowHead: (MarsRoverHeadingWest for: self)! !
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 08:44:50' prior: 50859539!
headSouth
	
	self nowHead: (MarsRoverHeadingSouth for: self)! !
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 08:44:59' prior: 50859535!
headNorth
	
	self nowHead: (MarsRoverHeadingNorth for: self)! !
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 08:45:06' prior: 50859531!
headEast
	
	self nowHead: (MarsRoverHeadingEast for: self)! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 08:45:08'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 08:45:08'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 08:45:08'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 08:45:08'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 08:45:08'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 08:45:08'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 08:45:08'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 08:45:08'!
PASSED!

!testRun: #MarsRoverTest #test01DoesNotMoveWhenNoCommand stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test02IsAtFailsForDifferentPosition stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test03IsAtFailsForDifferentHeading stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test04IncrementsYAfterMovingForwardWhenHeadingNorth stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test06DecrementsYAfterMovingBackwardsWhenHeadingNorth stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test07PointToEashAfterRotatingRightWhenHeadingNorth stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test08PointsToWestAfterRotatingLeftWhenPointingNorth stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test09DoesNotProcessInvalidCommand stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test10CanProcessMoreThanOneCommand stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test11IncrementsXAfterMovingForwareWhenHeadingEast stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test12DecrementsXAfterMovingBackwardWhenHeadingEast stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test13PointsToSouthAfterRotatingRightWhenHeadingEast stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test14PointsToNorthAfterRotatingLeftWhenPointingEast stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test15ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingSouth stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!

!testRun: #MarsRoverTest #test16ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingWest stamp: 'PhG 10/26/2021 08:45:10'!
PASSED!
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/26/2021 08:46:17' prior: 50860956!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ 
		self moveForward.
		
		^ self
		].
	(self isBackwardCommand: aCommand) ifTrue: [ 
		self moveBackward.
		positionCommandsExecuted add: position.
		allComandsExecuted add: position.
		^ self
		].
	(self isRotateRightCommand: aCommand) ifTrue: [ 
		self rotateRight.
		directionCommandsExecuted add: (head class).
		allComandsExecuted add: (head class).
		^ self.
		].
	(self isRotateLeftCommand: aCommand) ifTrue: [ 
		self rotateLeft.
		directionCommandsExecuted add: (head class).
		allComandsExecuted add: (head class).
		^self.
		].

	self signalInvalidCommand.! !
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 08:46:26' prior: 50861445!
moveTowards: anOffset
	
	position := position + anOffset.
	positionCommandsExecuted add: position.
	allComandsExecuted add: position.! !
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/26/2021 08:46:54' prior: 50861670!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ ^ self moveForward ].
	(self isBackwardCommand: aCommand) ifTrue: [ ^		self moveBackward ].
	(self isRotateRightCommand: aCommand) ifTrue: [ 
		self rotateRight.
		directionCommandsExecuted add: (head class).
		allComandsExecuted add: (head class).
		^ self.
		].
	(self isRotateLeftCommand: aCommand) ifTrue: [ 
		self rotateLeft.
		directionCommandsExecuted add: (head class).
		allComandsExecuted add: (head class).
		^self.
		].

	self signalInvalidCommand.! !
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 08:47:10' prior: 50861555!
nowHead: newDirection
	
	head := newDirection.
	directionCommandsExecuted add: (head class).
	allComandsExecuted add: (head class).! !
!MarsRover methodsFor: 'command processing' stamp: 'PhG 10/26/2021 08:47:32' prior: 50861701!
processCommand: aCommand

	(self isForwardCommand: aCommand) ifTrue: [ ^ self moveForward ].
	(self isBackwardCommand: aCommand) ifTrue: [ ^		self moveBackward ].
	(self isRotateRightCommand: aCommand) ifTrue: [ ^		self rotateRight ].
	(self isRotateLeftCommand: aCommand) ifTrue: [ ^		self rotateLeft ].

	self signalInvalidCommand.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 08:47:39'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 08:47:39'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 08:47:39'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 08:47:39'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 08:47:39'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 08:47:39'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 08:47:39'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 08:47:39'!
PASSED!

!testRun: #MarsRoverTest #test01DoesNotMoveWhenNoCommand stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test02IsAtFailsForDifferentPosition stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test03IsAtFailsForDifferentHeading stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test04IncrementsYAfterMovingForwardWhenHeadingNorth stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test06DecrementsYAfterMovingBackwardsWhenHeadingNorth stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test07PointToEashAfterRotatingRightWhenHeadingNorth stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test08PointsToWestAfterRotatingLeftWhenPointingNorth stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test09DoesNotProcessInvalidCommand stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test10CanProcessMoreThanOneCommand stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test11IncrementsXAfterMovingForwareWhenHeadingEast stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test12DecrementsXAfterMovingBackwardWhenHeadingEast stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test13PointsToSouthAfterRotatingRightWhenHeadingEast stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test14PointsToNorthAfterRotatingLeftWhenPointingEast stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test15ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingSouth stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!

!testRun: #MarsRoverTest #test16ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingWest stamp: 'PhG 10/26/2021 08:47:41'!
PASSED!
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 08:48:11' prior: 50861721!
nowHead: newDirection
	
	head := newDirection.
	"aca van a venir los push"
	directionCommandsExecuted add: (head class).
	allComandsExecuted add: (head class).! !

----QUIT----(26 October 2021 08:56:47) CuisUniversity-4532.image priorSource: 16941200!

----STARTUP---- (26 October 2021 18:30:37) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!

!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:36:32' prior: 50860917!
test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: marsRover fullLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:37:11'!
test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: 1@2 equals: marsRover fullLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:37:16' prior: 50861861!
test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: 1@2 equals: marsRover positionStatus.! !

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:37:18'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:37:30'!
positionStatus
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:37:44' prior: 50861886!
positionStatus
	^positionCommandsExecuted last.! !

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:37:45'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:38:12'!
test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'f'.
	
	self assert: 1@2 equals: marsRover positionStatus.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:38:28' prior: 50861938!
test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: MarsRoverHeadingEast equals: marsRover directionStatus.! !

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:38:30'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:38:35'!
directionStatus
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:38:42' prior: 50861964!
directionStatus
	^directionCommandsExecuted last.! !

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:38:43'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:39:14'!
test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'r'.
	
	self assert: MarsRoverHeadingEast equals: marsRover directionStatus.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:39:36' prior: 50862021!
test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: marsRover fullStatus.! !

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 18:39:38'!
ERROR!
!MarsRover methodsFor: '*DenotativeObject' stamp: 'PhG 10/26/2021 18:39:42'!
fullStatus
	self shouldBeImplemented.! !
!MarsRover methodsFor: '*DenotativeObject' stamp: 'PhG 10/26/2021 18:39:59' prior: 50862052!
fullStatus
	^OrderedCollection with: positionCommandsExecuted last with: directionCommandsExecuted last.! !

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 18:40:00'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:42:02' prior: 50859892!
test01PositionLogIsEmptyWhenRoverDidNotMove

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	marsRover collectPositions.
	
	self assert: OrderedCollection new equals: 	marsRover positionLog.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:42:04'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:42:45'!
collectPositions
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:42:56' prior: 50862132!
collectPositions
	positionCommandsExecuted := OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 18:42:59'!
PASSED!
!MarsRover methodsFor: 'initialization' stamp: 'PhG 10/26/2021 18:43:14' prior: 50860945!
initializeAt: aPosition heading: aHeadingType

	position := aPosition.
	head := aHeadingType for: self.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:43:39' prior: 50859930!
test02DirectionLogIsEmptyWhenRoverDidNotMove

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	marsRover collectHeading.
	
	self assert: OrderedCollection new equals: 	marsRover directionLog.! !

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:43:41'!
ERROR!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:43:48' prior: 50862202!
test02DirectionLogIsEmptyWhenRoverDidNotMove

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	marsRover collectHeadings.
	
	self assert: OrderedCollection new equals: 	marsRover directionLog.! !

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:43:51'!
ERROR!
!MarsRover methodsFor: 'accessing' stamp: 'PhG 10/26/2021 18:43:55'!
collectHeadings
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'accessing' stamp: 'PhG 10/26/2021 18:44:07' prior: 50862231!
collectHeadings
	directionCommandsExecuted := OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:44:09'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:44:09'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:44:09'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:44:09'!
FAILURE!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 18:44:09'!
ERROR!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 18:44:09'!
ERROR!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:44:09'!
ERROR!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 18:44:09'!
ERROR!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 18:44:09'!
ERROR!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:44:09'!
ERROR!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:44:09'!
ERROR!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 18:44:09'!
ERROR!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:44:46' prior: 50859973!
test03FullLogIsEmptyWhenRoverDidNotMove

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	marsRover collectAll.
	
	self assert: OrderedCollection new equals: 	marsRover fullLog.! !

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:44:49'!
ERROR!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:45:03' prior: 50862295!
test03FullLogIsEmptyWhenRoverDidNotMove

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	marsRover collectAllLogs.
	
	self assert: OrderedCollection new equals: 	marsRover fullLog.! !

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:45:05'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:45:11'!
collectAllLogs
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:45:32' prior: 50862322!
collectAllLogs
	allComandsExecuted := OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:45:33'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:45:33'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:45:33'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 18:45:33'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 18:45:33'!
ERROR!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 18:45:33'!
ERROR!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:45:33'!
ERROR!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 18:45:33'!
ERROR!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 18:45:33'!
ERROR!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:45:33'!
ERROR!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 18:45:33'!
ERROR!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 18:45:34'!
ERROR!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:45:53' prior: 50860222!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	marsRover collectPositions.
	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 1@2) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:45:58' prior: 50860346!
test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover collectPositions.
	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@1) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:46:14' prior: 50860755!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover collectHeadings.
	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: marsRover directionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:46:18' prior: 50860821!
test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover collectHeadings.
	marsRover process: 'rl'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast with: MarsRoverHeadingNorth) equals: marsRover directionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:46:27' prior: 50861848!
test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover collectAllLogs.
	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: marsRover fullLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 18:46:48' prior: 50861872!
test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover collectPositionStatus.
	marsRover process: 'f'.
	
	self assert: 1@2 equals: marsRover positionStatus.! !

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:46:50'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:47:04'!
collectPositionStatus
	self shouldBeImplemented.! !

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 18:48:20'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionCommandsExecuted directionCommandsExecuted allComandsExecuted positionStatus'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:48:18' prior: 50862467!
collectPositionStatus
	positionStatus := OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:48:23'!
ERROR!
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 18:49:16' prior: 50861693!
moveTowards: anOffset
	
	position := position + anOffset.
	positionCommandsExecuted ifNotNil: [positionCommandsExecuted add: position].
	allComandsExecuted ifNotNil: [allComandsExecuted add: position].
	positionStatus ifNotNil: [positionStatus add: position].! !

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:49:18'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 18:49:34' prior: 50861890!
positionStatus
	^positionStatus last.! !

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 18:49:35'!
FAILURE!

----QUIT----(26 October 2021 18:51:04) CuisUniversity-4532.image priorSource: 16966050!

----STARTUP---- (26 October 2021 19:06:43) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:07:17'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:07:17'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:07:17'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:07:17'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:07:17'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:07:17'!
ERROR!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:07:17'!
ERROR!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:07:17'!
ERROR!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:07:17'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:07:17'!
ERROR!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:07:17'!
ERROR!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:07:26'!
ERROR!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:07:31'!
ERROR!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:07:35'!
ERROR!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:07:39'!
ERROR!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:07:43'!
ERROR!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:08:19' prior: 50861949!
test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover collectDirectionStatus.
	marsRover process: 'r'.
	
	self assert: MarsRoverHeadingEast equals: marsRover directionStatus.! !

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:08:21'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:08:29'!
collectDirectionStatus
	self shouldBeImplemented.! !

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 19:08:48'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionCommandsExecuted directionCommandsExecuted allComandsExecuted positionStatus directionStatus'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:08:46' prior: 50862614!
collectDirectionStatus
	directionStatus := OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:08:50'!
ERROR!
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 19:09:53' prior: 50861832!
nowHead: newDirection
	
	head := newDirection.
	directionCommandsExecuted ifNotNil: [directionCommandsExecuted add: (head class)].
	allComandsExecuted ifNotNil: [allComandsExecuted add: (head class)].
	directionStatus ifNotNil: [directionStatus add: (head class)].! !

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:09:55'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:10:06' prior: 50861968!
directionStatus
	^directionStatus last.! !

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:10:07'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:10:07'!
ERROR!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:10:07'!
ERROR!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:10:25'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:10:39' prior: 50862057!
fullStatus
	^OrderedCollection with: positionStatus last with: directionStatus last.! !

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:10:40'!
ERROR!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:11:08' prior: 50862034!
test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward

	| marsRover |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	marsRover collectFullStatus.
	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: marsRover fullStatus.! !

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:11:12'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:11:18'!
collectFullStatus
	self shouldBeImplemented.! !

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 19:11:30'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionCommandsExecuted directionCommandsExecuted allComandsExecuted positionStatus directionStatus fullStatus'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:11:27' prior: 50862756!
collectFullStatus
	fullStatus := OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:11:31'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:11:40' prior: 50862725!
fullStatus
	^fullStatus .! !

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:11:43'!
FAILURE!
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 19:12:29' prior: 50862492!
moveTowards: anOffset
	
	position := position + anOffset.
	positionCommandsExecuted ifNotNil: [positionCommandsExecuted add: position].
	allComandsExecuted ifNotNil: [allComandsExecuted add: position].
	positionStatus ifNotNil: [positionStatus add: position].
	fullStatus ifNotNil: [fullStatus add: position].! !
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 19:12:46' prior: 50862640!
nowHead: newDirection
	
	head := newDirection.
	directionCommandsExecuted ifNotNil: [directionCommandsExecuted add: (head class)].
	allComandsExecuted ifNotNil: [allComandsExecuted add: (head class)].
	directionStatus ifNotNil: [directionStatus add: (head class)].
	fullStatus ifNotNil: [fullStatus add: (head class)].! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:12:49'!
PASSED!

----SNAPSHOT----(26 October 2021 19:13:01) CuisUniversity-4532.image priorSource: 16987704!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:13:35'!
PASSED!

Object subclass: #Log
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!

!classDefinition: #Log category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 19:38:47'!
Object subclass: #Log
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!Log methodsFor: 'nil' stamp: 'PhG 10/26/2021 19:43:00' overrides: 16881312!
update: aChange! !

!classDefinition: #Log category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 19:43:42'!
Object subclass: #Log
	instanceVariableNames: 'updates'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:43:39' prior: 50862929 overrides: 16881312!
update: anUpdate
	updates add: anUpdate.! !
!Log methodsFor: 'nil' stamp: 'PhG 10/26/2021 19:43:59' overrides: 16896425!
initialize
	updates := OrderedCollection new.! !
!Log methodsFor: 'nil' stamp: 'PhG 10/26/2021 19:44:33' overrides: 16882188!
print
	^updates copy.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:45:04' prior: 50862949 overrides: 16882188!
print
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:47:57' prior: 50862384!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover x |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	x := Log new.
	marsRover notifyPositionsChangesTo: x.
	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 1@2) equals: 	marsRover positionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:48:09' prior: 50862960!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover x |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	x := Log new.
	marsRover notifyPositionsChangesTo: x.
	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 1@2) equals: 	x print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:48:20' prior: 50862973!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 1@2) equals: 	positionLogger print.! !

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:48:26'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:48:37'!
notifyPositionsChangesTo: aLog 
	self shouldBeImplemented.! !

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 19:49:24'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionCommandsExecuted directionCommandsExecuted allComandsExecuted positionStatus directionStatus fullStatus positionSubscribers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:49:22' prior: 50863004!
notifyPositionsChangesTo: aPositionSubscriber
	positionSubscribers add: aPositionSubscriber.! !

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:49:27'!
ERROR!
!MarsRover methodsFor: 'initialization' stamp: 'PhG 10/26/2021 19:49:51' prior: 50862195!
initializeAt: aPosition heading: aHeadingType

	position := aPosition.
	head := aHeadingType for: self.
	positionSubscribers := OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:49:56'!
FAILURE!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:49:56'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:49:56'!
FAILURE!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:50:06'!
FAILURE!
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 19:50:49' prior: 50862791!
moveTowards: anOffset
	
	position := position + anOffset.
	positionSubscribers do: [:aPositionSusbscriber | aPositionSusbscriber update: position].
	positionCommandsExecuted ifNotNil: [positionCommandsExecuted add: position].
	allComandsExecuted ifNotNil: [allComandsExecuted add: position].
	positionStatus ifNotNil: [positionStatus add: position].
	fullStatus ifNotNil: [fullStatus add: position].! !
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 19:50:58' prior: 50863098!
moveTowards: anOffset
	
	position := position + anOffset.
	positionSubscribers do: [:aPositionSusbscriber | aPositionSusbscriber update: position].
	allComandsExecuted ifNotNil: [allComandsExecuted add: position].
	positionStatus ifNotNil: [positionStatus add: position].
	fullStatus ifNotNil: [fullStatus add: position].! !

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:51:03'!
FAILURE!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:51:03'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:51:03'!
FAILURE!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:51:18'!
FAILURE!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:51:18'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:51:18'!
FAILURE!

positionLogger print!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:55:18'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:55:23'!
FAILURE!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:55:23'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:55:23'!
FAILURE!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:55:35'!
FAILURE!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:55:35'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:55:35'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:56:09' prior: 50862397!
test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@1) equals: 	positionLogger print.! !

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:56:13'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:56:13'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:56:13'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:56:13'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:56:13'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:56:13'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:56:14'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:56:14'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:56:14'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:56:14'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:56:14'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:56:14'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:56:38' prior: 50862119!
test01PositionLogIsEmptyWhenRoverDidNotMove

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	
	self assert: OrderedCollection new equals: 	positionLogger print.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:56:40'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:57:00' prior: 50862411!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionLogger := Log new.
	marsRover notifyDirectionChangesTo: positionLogger.
	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: marsRover directionLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:57:07' prior: 50863503!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionLogger := Log new.
	marsRover notifyDirectionChangesTo: positionLogger.
	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: positionLogger print.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:57:09'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:57:18'!
notifyDirectionChangesTo: aLog 
	self shouldBeImplemented.! !

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 19:57:41'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionCommandsExecuted directionCommandsExecuted allComandsExecuted positionStatus directionStatus fullStatus positionSubscribers directionSubscribers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 19:57:39' prior: 50863536!
notifyDirectionChangesTo: aDirectionSubscriber 
	directionSubscribers add: aDirectionSubscriber! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:57:44'!
ERROR!
!MarsRover methodsFor: 'initialization' stamp: 'PhG 10/26/2021 19:58:02' prior: 50863032!
initializeAt: aPosition heading: aHeadingType

	position := aPosition.
	head := aHeadingType for: self.
	positionSubscribers := OrderedCollection new.
	directionSubscribers := OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:58:08'!
FAILURE!
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 19:58:52' prior: 50862804!
nowHead: newDirection
	
	head := newDirection.
	directionSubscribers do: [:aDirectionSusbscriber | aDirectionSusbscriber update: (head class)].
	allComandsExecuted ifNotNil: [allComandsExecuted add: (head class)].
	directionStatus ifNotNil: [directionStatus add: (head class)].
	fullStatus ifNotNil: [fullStatus add: (head class)].! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:58:58'!
FAILURE!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:58:58'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:58:58'!
FAILURE!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:59:22' prior: 50862424!
test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionLogger := Log new.
	marsRover notifyDirectionChangesTo: positionLogger.
	marsRover process: 'rl'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast with: MarsRoverHeadingNorth) equals: positionLogger print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:59:32' prior: 50863646!
test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	directionLogger := Log new.
	marsRover notifyDirectionChangesTo: directionLogger.
	marsRover process: 'rl'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast with: MarsRoverHeadingNorth) equals: directionLogger print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 19:59:37' prior: 50863518!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	directionLogger := Log new.
	marsRover notifyDirectionChangesTo: directionLogger.
	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: directionLogger print.! !

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:59:39'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 19:59:43'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:00:07' prior: 50862217!
test02DirectionLogIsEmptyWhenRoverDidNotMove

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	marsRover collectHeadings.
	
	self assert: OrderedCollection new equals: 	directionLogger print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:00:17' prior: 50863751!
test02DirectionLogIsEmptyWhenRoverDidNotMove

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	directionLogger := Log new.
	marsRover notifyDirectionChangesTo: directionLogger.
	
	self assert: OrderedCollection new equals: 	directionLogger print.! !

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:00:17'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:00:17'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:00:17'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:00:17'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:00:18'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:00:18'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:00:18'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:00:18'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:00:18'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:00:18'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:00:18'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:00:18'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:01:14' prior: 50862438!
test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight

	| marsRover allChangesLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	allChangesLogger := Log new.
	marsRover notifyAllChangesTo: allChangesLogger.
	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: allChangesLogger print.! !

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:01:18'!
ERROR!
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 20:01:25'!
notifyAllChangesTo: aLog 
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'report' stamp: 'PhG 10/26/2021 20:02:11' prior: 50863849!
notifyAllChangesTo: aSubscriber 
	self notifyPositionsChangesTo: aSubscriber.
	self notifyDirectionChangesTo: aSubscriber.! !

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:02:13'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:02:41' prior: 50862309!
test03FullLogIsEmptyWhenRoverDidNotMove

	| marsRover allChangesLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	allChangesLogger := Log new.
	marsRover notifyAllChangesTo: allChangesLogger.
	
	self assert: OrderedCollection new equals: 	marsRover fullLog.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:02:46' prior: 50863916!
test03FullLogIsEmptyWhenRoverDidNotMove

	| marsRover allChangesLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	allChangesLogger := Log new.
	marsRover notifyAllChangesTo: allChangesLogger.
	
	self assert: OrderedCollection new equals: 	allChangesLogger print.! !

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:02:48'!
PASSED!

!methodRemoval: MarsRover #collectAllLogs stamp: 'PhG 10/26/2021 20:02:57'!
collectAllLogs
	allComandsExecuted := OrderedCollection new.!

!methodRemoval: MarsRover #collectHeadings stamp: 'PhG 10/26/2021 20:03:06'!
collectHeadings
	directionCommandsExecuted := OrderedCollection new.!

!methodRemoval: MarsRover #collectPositions stamp: 'PhG 10/26/2021 20:03:10'!
collectPositions
	positionCommandsExecuted := OrderedCollection new.!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:03:26'!
PASSED!

Object subclass: #MarsRover
	instanceVariableNames: 'position head positionStatus directionStatus fullStatus positionSubscribers directionSubscribers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 20:03:40'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionStatus directionStatus fullStatus positionSubscribers directionSubscribers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:03:45'!
PASSED!

Object subclass: #Status
	instanceVariableNames: 'update'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!

!classDefinition: #Status category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 20:05:29'!
Object subclass: #Status
	instanceVariableNames: 'update'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!Status methodsFor: 'nil' stamp: 'PhG 10/26/2021 20:05:49' overrides: 16882188!
print
	^update copy! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:06:01' overrides: 16881312!
update: anUpdate
	update := anUpdate! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:06:02' prior: 50864139 overrides: 16881312!
update: anUpdate
	update := anUpdate.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:07:00' prior: 50862452!
test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover positionStatus |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionStatus := Status new.
	marsRover notifyPositionsChangesTo: positionStatus.
	marsRover process: 'f'.
	
	self assert: 1@2 equals: positionStatus print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:07:32' prior: 50862598!
test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight

	| marsRover directionStatus |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	directionStatus := Status new.
	marsRover notifyDirectionChangesTo: directionStatus.
	marsRover process: 'r'.
	
	self assert: MarsRoverHeadingEast equals: directionStatus print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:08:31' prior: 50862737!
test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward

	| marsRover allStatus |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	allStatus := Status new.
	marsRover notifyAllChangesTo: allStatus.
	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: allStatus print.! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:09:53'!
updatePosition: aPositionUpdate
	update := aPositionUpdate.! !

!classDefinition: #Status category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 20:10:00'!
Object subclass: #Status
	instanceVariableNames: 'update positionUpdate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:09:59' prior: 50864193!
updatePosition: aPositionUpdate
	positionUpdate := aPositionUpdate.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:14' prior: 50864163!
test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight

	| marsRover directionStatus |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	directionStatus := Status new.
	marsRover notifyDirectionChangesTo: directionStatus.
	marsRover process: 'r'.
	
	self assert: MarsRoverHeadingEast equals: directionStatus printDirection.! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:22'!
printAll
	^update copy! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:25'!
printPosition
	^update copy! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56'!
printDirection
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56'!
printDirection
	^update copy! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50863367!
test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@1) equals: 	positionLogger printDirection.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50862986!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 1@2) equals: 	positionLogger printDirection.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50863437!
test01PositionLogIsEmptyWhenRoverDidNotMove

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	
	self assert: OrderedCollection new equals: 	positionLogger printDirection.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50864149!
test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover positionStatus |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionStatus := Status new.
	marsRover notifyPositionsChangesTo: positionStatus.
	marsRover process: 'f'.
	
	self assert: 1@2 equals: positionStatus printDirection.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50863678!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	directionLogger := Log new.
	marsRover notifyDirectionChangesTo: directionLogger.
	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: directionLogger printDirection.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50863662!
test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	directionLogger := Log new.
	marsRover notifyDirectionChangesTo: directionLogger.
	marsRover process: 'rl'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast with: MarsRoverHeadingNorth) equals: directionLogger printDirection.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50863828!
test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight

	| marsRover allChangesLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	allChangesLogger := Log new.
	marsRover notifyAllChangesTo: allChangesLogger.
	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: allChangesLogger printDirection.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50863762!
test02DirectionLogIsEmptyWhenRoverDidNotMove

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	directionLogger := Log new.
	marsRover notifyDirectionChangesTo: directionLogger.
	
	self assert: OrderedCollection new equals: 	directionLogger printDirection.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50864178!
test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward

	| marsRover allStatus |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	allStatus := Status new.
	marsRover notifyAllChangesTo: allStatus.
	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: allStatus printDirection.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:12:56' prior: 50863929!
test03FullLogIsEmptyWhenRoverDidNotMove

	| marsRover allChangesLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	allChangesLogger := Log new.
	marsRover notifyAllChangesTo: allChangesLogger.
	
	self assert: OrderedCollection new equals: 	allChangesLogger printDirection.! !

!methodRemoval: Log #print stamp: 'PhG 10/26/2021 20:12:56'!
print
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.!

!methodRemoval: Status #print stamp: 'PhG 10/26/2021 20:12:56'!
print
	^update copy!
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:13:03' prior: 50864230!
printPosition
	^positionUpdate copy! !

!classDefinition: #Status category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 20:13:10'!
Object subclass: #Status
	instanceVariableNames: 'directionUpdate positionUpdate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:13:10' prior: 50864240!
printDirection
	^directionUpdate copy! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:13:10' prior: 50864226!
printAll
	^directionUpdate copy! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:13:10' prior: 50864144 overrides: 16881312!
update: anUpdate
	directionUpdate := anUpdate.! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:13:25' prior: 50864419!
printAll
	^OrderedCollection with: positionUpdate with: directionUpdate .! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:13:25' prior: 50864429!
printAll
	^OrderedCollection with: positionUpdate with: directionUpdate.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:13:49' prior: 50864365!
test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward

	| marsRover allStatus |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	allStatus := Status new.
	marsRover notifyAllChangesTo: allStatus.
	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: allStatus printAll.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:14:00' prior: 50864289!
test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward

	| marsRover positionStatus |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionStatus := Status new.
	marsRover notifyPositionsChangesTo: positionStatus.
	marsRover process: 'f'.
	
	self assert: 1@2 equals: positionStatus printPosition.! !

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:14:01'!
FAILURE!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:14:46'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:14:46'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:14:46'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:14:46'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:14:46'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:14:46'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:14:46'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:14:46'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:14:46'!
FAILURE!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:14:46'!
FAILURE!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:14:46'!
FAILURE!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:14:57'!
FAILURE!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:16:16'!
updateDirection: anUpdate
	updates add: anUpdate.! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:16:16'!
updateDirection: anUpdate
	directionUpdate := anUpdate.! !
!MarsRover methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:16:16' prior: 50863114!
moveTowards: anOffset
	
	position := position + anOffset.
	positionSubscribers do: [:aPositionSusbscriber | aPositionSusbscriber updateDirection: position].
	allComandsExecuted ifNotNil: [allComandsExecuted add: position].
	positionStatus ifNotNil: [positionStatus add: position].
	fullStatus ifNotNil: [fullStatus add: position].! !
!MarsRover methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:16:16' prior: 50863578!
nowHead: newDirection
	
	head := newDirection.
	directionSubscribers do: [:aDirectionSusbscriber | aDirectionSusbscriber updateDirection: (head class)].
	allComandsExecuted ifNotNil: [allComandsExecuted add: (head class)].
	directionStatus ifNotNil: [directionStatus add: (head class)].
	fullStatus ifNotNil: [fullStatus add: (head class)].! !

!methodRemoval: Log #update: stamp: 'PhG 10/26/2021 20:16:16'!
update: anUpdate
	updates add: anUpdate.!

!methodRemoval: Status #update: stamp: 'PhG 10/26/2021 20:16:16'!
update: anUpdate
	directionUpdate := anUpdate.!
!MarsRover methodsFor: 'moving' stamp: 'PhG 10/26/2021 20:16:34' prior: 50864539!
moveTowards: anOffset
	
	position := position + anOffset.
	positionSubscribers do: [:aPositionSusbscriber | aPositionSusbscriber updatePosition: position].! !
!MarsRover methodsFor: 'heading' stamp: 'PhG 10/26/2021 20:16:42' prior: 50864553!
nowHead: newDirection
	
	head := newDirection.
	directionSubscribers do: [:aDirectionSusbscriber | aDirectionSusbscriber updateDirection: (head class)].! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:16:44'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:16:45'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:16:45'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:16:45'!
ERROR!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:16:45'!
ERROR!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:16:45'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:16:45'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:16:45'!
ERROR!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:16:45'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:16:45'!
FAILURE!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:16:45'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:16:56' prior: 50864261!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 1@2) equals: 	positionLogger printPosition.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:17:07' prior: 50864245!
test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@1) equals: 	positionLogger printPosition.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:17:12' prior: 50864335!
test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight

	| marsRover allChangesLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	allChangesLogger := Log new.
	marsRover notifyAllChangesTo: allChangesLogger.
	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: allChangesLogger printAll.! !

!testRun: #MarsRoverTest #test01DoesNotMoveWhenNoCommand stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test02IsAtFailsForDifferentPosition stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test03IsAtFailsForDifferentHeading stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test04IncrementsYAfterMovingForwardWhenHeadingNorth stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test06DecrementsYAfterMovingBackwardsWhenHeadingNorth stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test07PointToEashAfterRotatingRightWhenHeadingNorth stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test08PointsToWestAfterRotatingLeftWhenPointingNorth stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test09DoesNotProcessInvalidCommand stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test10CanProcessMoreThanOneCommand stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test11IncrementsXAfterMovingForwareWhenHeadingEast stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test12DecrementsXAfterMovingBackwardWhenHeadingEast stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test13PointsToSouthAfterRotatingRightWhenHeadingEast stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test14PointsToNorthAfterRotatingLeftWhenPointingEast stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test15ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingSouth stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverTest #test16ForwardBackwardsAndRotateRightWorkAsExpectedWhenPointingWest stamp: 'PhG 10/26/2021 20:17:32'!
PASSED!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:17:34'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:17:34'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:17:34'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:17:34'!
ERROR!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:17:34'!
ERROR!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:17:34'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:17:34'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:17:34'!
ERROR!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:17:34'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:17:34'!
FAILURE!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:17:34'!
PASSED!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:17:51'!
printPosition
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:17:55'!
printAll
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:12'!
updatePosition: anUpdate
	updates add: anUpdate.! !

!classDefinition: #Log category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 20:18:24'!
Object subclass: #Log
	instanceVariableNames: 'updates positionUpdates'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:23' prior: 50864803!
updatePosition: anUpdate
	positionUpdates add: anUpdate.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:31' prior: 50864816!
updatePosition: aPositionUpdate
	positionUpdates add: aPositionUpdate.! !

!classDefinition: #Log category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 20:18:40'!
Object subclass: #Log
	instanceVariableNames: 'directionUpdates positionUpdates'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:40' prior: 50864791!
printPosition
	"Usamos esto para no tener que assertear sobre los streams"
	^directionUpdates copy.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:40' prior: 50862945 overrides: 16896425!
initialize
	directionUpdates := OrderedCollection new.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:40' prior: 50864234!
printDirection
	"Usamos esto para no tener que assertear sobre los streams"
	^directionUpdates copy.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:40' prior: 50864529!
updateDirection: anUpdate
	directionUpdates add: anUpdate.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:40' prior: 50864797!
printAll
	"Usamos esto para no tener que assertear sobre los streams"
	^directionUpdates copy.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:46' prior: 50864854!
updateDirection: aDirectionUpdate
	directionUpdates add: aDirectionUpdate.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:18:55' prior: 50864842 overrides: 16896425!
initialize
	positionUpdates := OrderedCollection new.
	directionUpdates := OrderedCollection new.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:18:59'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:18:59'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:18:59'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:18:59'!
FAILURE!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:18:59'!
FAILURE!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:18:59'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:18:59'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:18:59'!
FAILURE!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:18:59'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:18:59'!
FAILURE!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:18:59'!
PASSED!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:19:52' overrides: 16881312!
update: anUpdate
	directionUpdates add: anUpdate.! !

!classDefinition: #Log category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 20:19:57'!
Object subclass: #Log
	instanceVariableNames: 'updates positionUpdates'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:19:57' prior: 50864927 overrides: 16881312!
update: anUpdate
	updates add: anUpdate.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:19:57' prior: 50864835!
printPosition
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:19:57' prior: 50864871 overrides: 16896425!
initialize
	positionUpdates := OrderedCollection new.
	updates := OrderedCollection new.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:19:57' prior: 50864847!
printDirection
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:19:57' prior: 50864865!
updateDirection: aDirectionUpdate
	updates add: aDirectionUpdate.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:19:57' prior: 50864859!
printAll
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.! !

!methodRemoval: Log #updateDirection: stamp: 'PhG 10/26/2021 20:20:04'!
updateDirection: aDirectionUpdate
	updates add: aDirectionUpdate.!

!methodRemoval: Log #updatePosition: stamp: 'PhG 10/26/2021 20:20:06'!
updatePosition: aPositionUpdate
	positionUpdates add: aPositionUpdate.!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:20:12' overrides: 16882188!
print
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.! !

!methodRemoval: Log #printAll stamp: 'PhG 10/26/2021 20:20:14'!
printAll
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.!

!methodRemoval: Log #printDirection stamp: 'PhG 10/26/2021 20:20:16'!
printDirection
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.!

!methodRemoval: Log #printPosition stamp: 'PhG 10/26/2021 20:20:18'!
printPosition
	"Usamos esto para no tener que assertear sobre los streams"
	^updates copy.!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:20:21' prior: 50864952 overrides: 16896425!
initialize
	updates := OrderedCollection new.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:20:42'!
updateDirection: anUpdate
	updates add: anUpdate.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:20:52'!
updatePosition: anUpdate
	updates add: anUpdate.! !

!methodRemoval: Log #update: stamp: 'PhG 10/26/2021 20:20:52'!
update: anUpdate
	updates add: anUpdate.!
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:20:58' prior: 50865014!
updatePosition: aPositionUpdate
	updates add: aPositionUpdate.! !
!Log methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:21:05' prior: 50865010!
updateDirection: aDirectionUpdate
	updates add: aDirectionUpdate.! !

!methodRemoval: MarsRover #collectDirectionStatus stamp: 'PhG 10/26/2021 20:21:19'!
collectDirectionStatus
	directionStatus := OrderedCollection new.!

!methodRemoval: MarsRover #collectFullStatus stamp: 'PhG 10/26/2021 20:21:20'!
collectFullStatus
	fullStatus := OrderedCollection new.!

!methodRemoval: MarsRover #collectPositionStatus stamp: 'PhG 10/26/2021 20:21:22'!
collectPositionStatus
	positionStatus := OrderedCollection new.!

!methodRemoval: MarsRover #directionLog stamp: 'PhG 10/26/2021 20:21:28'!
directionLog
	^directionCommandsExecuted.!

!methodRemoval: MarsRover #directionStatus stamp: 'PhG 10/26/2021 20:21:29'!
directionStatus
	^directionStatus last.!

!methodRemoval: MarsRover #fullLog stamp: 'PhG 10/26/2021 20:21:31'!
fullLog
	^allComandsExecuted.!

!methodRemoval: MarsRover #fullStatus stamp: 'PhG 10/26/2021 20:21:32'!
fullStatus
	^fullStatus .!

!methodRemoval: MarsRover #positionLog stamp: 'PhG 10/26/2021 20:21:38'!
positionLog
	^positionCommandsExecuted.!

!methodRemoval: MarsRover #positionStatus stamp: 'PhG 10/26/2021 20:21:41'!
positionStatus
	^positionStatus last.!

Object subclass: #MarsRover
	instanceVariableNames: 'position head positionSubscribers directionSubscribers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!

!classDefinition: #MarsRover category: 'MarsRover-WithHeading' stamp: 'PhG 10/26/2021 20:21:50'!
Object subclass: #MarsRover
	instanceVariableNames: 'position head positionSubscribers directionSubscribers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover-WithHeading'!

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:21:54'!
ERROR!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:21:54'!
ERROR!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:21:54'!
ERROR!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:21:54'!
ERROR!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:21:54'!
ERROR!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:21:54'!
ERROR!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:21:54'!
ERROR!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:21:54'!
ERROR!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:21:54'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:21:54'!
FAILURE!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:21:54'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:22:02' prior: 50864276!
test01PositionLogIsEmptyWhenRoverDidNotMove

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	
	self assert: OrderedCollection new equals: 	positionLogger print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:22:08' prior: 50864352!
test02DirectionLogIsEmptyWhenRoverDidNotMove

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	directionLogger := Log new.
	marsRover notifyDirectionChangesTo: directionLogger.
	
	self assert: OrderedCollection new equals: 	directionLogger print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:22:12' prior: 50864381!
test03FullLogIsEmptyWhenRoverDidNotMove

	| marsRover allChangesLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	allChangesLogger := Log new.
	marsRover notifyAllChangesTo: allChangesLogger.
	
	self assert: OrderedCollection new equals: 	allChangesLogger print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:22:16' prior: 50864640!
test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.
	
	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	marsRover process: 'f'.
	
	self assert: (OrderedCollection with: 1@2) equals: 	positionLogger print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:22:21' prior: 50864655!
test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards

	| marsRover positionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	positionLogger := Log new.
	marsRover notifyPositionsChangesTo: positionLogger.
	marsRover process: 'fb'.
	
	self assert: (OrderedCollection with: 1@2 with: 1@1) equals: 	positionLogger print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:22:28' prior: 50864303!
test06DirectionLogContainsEastEntryWhenRoverRotatedRight

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	directionLogger := Log new.
	marsRover notifyDirectionChangesTo: directionLogger.
	marsRover process: 'r'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast) equals: directionLogger print.! !
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:22:35' prior: 50864318!
test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft

	| marsRover directionLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	directionLogger := Log new.
	marsRover notifyDirectionChangesTo: directionLogger.
	marsRover process: 'rl'.
	
	self assert: (OrderedCollection with: MarsRoverHeadingEast with: MarsRoverHeadingNorth) equals: directionLogger print.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:22:37'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:22:37'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:22:37'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:22:37'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:22:37'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:22:37'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:22:37'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:22:37'!
ERROR!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:22:37'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:22:37'!
FAILURE!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:22:37'!
PASSED!
!MarsRoverReportTest methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:22:44' prior: 50864671!
test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight

	| marsRover allChangesLogger |
	
	marsRover := MarsRover at: 1@1 heading: MarsRoverHeadingNorth.

	allChangesLogger := Log new.
	marsRover notifyAllChangesTo: allChangesLogger.
	marsRover process: 'fr'.
	
	self assert: (OrderedCollection with: 1@2 with: MarsRoverHeadingEast) equals: allChangesLogger print.! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:22:46'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:22:47'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:22:47'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:22:47'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:22:47'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:22:47'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:22:47'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:22:47'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:22:47'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:22:47'!
FAILURE!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:22:47'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:22:47'!
FAILURE!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:23:25'!
FAILURE!
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:24:00' prior: 50864534!
updateDirection: aDirectionUpdate
	directionUpdate := aDirectionUpdate.! !
!Status methodsFor: 'as yet unclassified' stamp: 'PhG 10/26/2021 20:24:19' prior: 50864414!
printDirection
	^directionUpdate! !

!testRun: #MarsRoverReportTest #test01PositionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test02DirectionLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test03FullLogIsEmptyWhenRoverDidNotMove stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test04PositionLogContainsForwardEntryWhenRoverMovesForwardOnce stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test05PositionLogContainsForwardAndBackwardEntriesWhenRoverMovedForwardAndBackwards stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test06DirectionLogContainsEastEntryWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test07DirectionLogContainsEastAndNorthEntriesWhenRoverRotatedRightAndLeft stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test08FullLogContainsNewForwardPositionAndRotatedEastEntriesWhenRoverMovedForwardAndRotatedRight stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test09PositionStatusContainsNewForwardPositionWhenRoverMovedForward stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test10DirectionStatusContainsEastAsNewDirectionPositionWhenRoverRotatedRight stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

!testRun: #MarsRoverReportTest #test11FullStatusContainsEastAsNewDirectionAndNewForwardPositionWhenRoverRotatedRightAndMovedForward stamp: 'PhG 10/26/2021 20:24:21'!
PASSED!

----SNAPSHOT----(26 October 2021 20:26:25) CuisUniversity-4532.image priorSource: 16998887!

----QUIT----(26 October 2021 21:22:05) CuisUniversity-4532.image priorSource: 17080521!

----STARTUP---- (30 October 2021 08:46:41) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/TusLibros.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/parcial/soluciones-catedra/ISW1-2021-2C-1erParcial.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/Packages/TerseGuide.pck.st----!

!testRun: #TestsCart #test01ANewCartShouldBeEmpty stamp: 'PhG 10/30/2021 09:04:30'!
PASSED!

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 10/30/2021 09:04:30'!
PASSED!

!testRun: #TestsCart #test03ACartWithABookShouldContainIt stamp: 'PhG 10/30/2021 09:04:30'!
PASSED!

!testRun: #TestsCart #test04AddingABookNotInCatalogueToAcartShouldThrowError stamp: 'PhG 10/30/2021 09:04:30'!
PASSED!

!testRun: #TestsCart #test05ACartCanHaveMultipleCopiesOfTheSameBook stamp: 'PhG 10/30/2021 09:04:30'!
PASSED!
!Catalogue methodsFor: 'testing' stamp: 'PhG 10/30/2021 09:04:59' prior: 50865571!
contains: aBookToSearch
	^listOfBooksInCatalogue includes: aBookToSearch.
"	^ (listOfBooksInCatalogue select: [:aBook| aBook = aBookToSearch ]) notEmpty ."! !

!testRun: #TestsCart #test01ANewCartShouldBeEmpty stamp: 'PhG 10/30/2021 09:05:02'!
PASSED!

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 10/30/2021 09:05:02'!
PASSED!

!testRun: #TestsCart #test03ACartWithABookShouldContainIt stamp: 'PhG 10/30/2021 09:05:02'!
PASSED!

!testRun: #TestsCart #test04AddingABookNotInCatalogueToAcartShouldThrowError stamp: 'PhG 10/30/2021 09:05:02'!
PASSED!

!testRun: #TestsCart #test05ACartCanHaveMultipleCopiesOfTheSameBook stamp: 'PhG 10/30/2021 09:05:02'!
PASSED!
!Catalogue methodsFor: 'testing' stamp: 'PhG 10/30/2021 09:05:12' prior: 50869185!
contains: aBookToSearch
	^listOfBooksInCatalogue includes: aBookToSearch.! !

!classDefinition: #Catalogue category: 'TusLibros' stamp: 'PhG 10/30/2021 09:05:26'!
Object subclass: #Catalogue
	instanceVariableNames: 'books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Catalogue methodsFor: 'as yet unclassified' stamp: 'PhG 10/30/2021 09:05:26' prior: 50865562!
initializeWithBook: aBook
	self initialize .
	books add: aBook .! !
!Catalogue methodsFor: 'as yet unclassified' stamp: 'PhG 10/30/2021 09:05:26' prior: 50865557 overrides: 16896425!
initialize
	books _ OrderedCollection new.! !
!Catalogue methodsFor: 'as yet unclassified' stamp: 'PhG 10/30/2021 09:05:26' prior: 50869209!
contains: aBookToSearch
	^books includes: aBookToSearch.! !
!Catalogue methodsFor: 'as yet unclassified' stamp: 'PhG 10/30/2021 09:05:26' prior: 50865567!
with: aBook
	books add: aBook .! !
!Catalogue methodsFor: 'initialization' stamp: 'PhG 10/30/2021 09:05:40' prior: 50869222!
initializeWithBook: aBook
	self initialize.
	books add: aBook.! !
!Catalogue methodsFor: 'initialization' stamp: 'PhG 10/30/2021 09:05:53' prior: 50869238!
with: aBook
	books add: aBook.! !
!Cart methodsFor: 'testing' stamp: 'PhG 10/30/2021 09:07:29' prior: 50865513!
contains: aBookToSearch 
	^books includes: aBookToSearch.! !
!Cart methodsFor: 'nil' stamp: 'PhG 10/30/2021 09:08:42'!
assertBookIsInCatalogue
! !
!Cart methodsFor: 'operation' stamp: 'PhG 10/30/2021 09:09:07' prior: 50865506!
addBook: aBook 
	
	self assertBookIsInCatalogue: aBook
	
	books add: aBook.! !
!Cart methodsFor: 'operation' stamp: 'PhG 10/30/2021 09:09:16' prior: 50869259!
addBook: aBook 
	
	self assertBookIsInCatalogue: aBook.
	
	books add: aBook.! !
!Cart methodsFor: 'assertions' stamp: 'PhG 10/30/2021 09:09:29'!
assertBookIsInCatalogue: aBook
	(catalogue contains: aBook) ifFalse: [ ^self error: self class canNotAddBookNotInCatalogue.].! !

!methodRemoval: Cart #assertBookIsInCatalogue stamp: 'PhG 10/30/2021 09:09:32'!
assertBookIsInCatalogue
!
!Cart methodsFor: 'assertions' stamp: 'PhG 10/30/2021 09:10:26'!
signalBookNotInCatalogue
	^self error: self class canNotAddBookNotInCatalogue! !
!Cart methodsFor: 'assertions' stamp: 'PhG 10/30/2021 09:10:46' prior: 50869269!
assertBookIsInCatalogue: aBook
	(catalogue contains: aBook) ifFalse: [ self signalBookNotInCatalogue].! !
!Cart methodsFor: 'exceptions' stamp: 'PhG 10/30/2021 09:11:17' prior: 50869279!
signalBookNotInCatalogue
	
	self error: self class canNotAddBookNotInCatalogue! !
!Cart methodsFor: 'assertions' stamp: 'PhG 10/30/2021 09:11:25' prior: 50869285!
assertBookIsInCatalogue: aBook
	(catalogue contains: aBook) ifFalse: [ self signalBookNotInCatalogue ].! !
!Cart methodsFor: 'assertions' stamp: 'PhG 10/30/2021 09:12:11' prior: 50869297!
assertBookIsInCatalogue: aBook
	
	(catalogue contains: aBook) ifFalse: [ self signalBookNotInCatalogue ].! !
!Cart methodsFor: 'testing' stamp: 'PhG 10/30/2021 09:12:22' prior: 50869251!
contains: aBookToSearch 

	^books includes: aBookToSearch.! !
!Cart methodsFor: 'testing' stamp: 'PhG 10/30/2021 09:12:26' prior: 50865519!
isEmpty

	^books isEmpty .! !
!Cart methodsFor: 'testing' stamp: 'PhG 10/30/2021 09:12:29' prior: 50865522!
quantityOfBook: aBook

	^(books select: [ :aBookInCart | aBookInCart = aBook]) size .! !
!Cart methodsFor: 'initialization' stamp: 'PhG 10/30/2021 09:12:41' prior: 50865501!
initializeWithCatalogue: aCatalogo

	catalogue _ aCatalogo.
	books _ OrderedCollection new.! !
!Cart methodsFor: 'testing' stamp: 'PhG 10/30/2021 09:13:48' prior: 50869318!
quantityOfBook: aBook

	^books occurrencesOf: aBook.
	"^(books select: [ :aBookInCart | aBookInCart = aBook]) size ."! !

!testRun: #TestsCart #test01ANewCartShouldBeEmpty stamp: 'PhG 10/30/2021 09:13:50'!
PASSED!

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 10/30/2021 09:13:50'!
PASSED!

!testRun: #TestsCart #test03ACartWithABookShouldContainIt stamp: 'PhG 10/30/2021 09:13:50'!
PASSED!

!testRun: #TestsCart #test04AddingABookNotInCatalogueToAcartShouldThrowError stamp: 'PhG 10/30/2021 09:13:50'!
PASSED!

!testRun: #TestsCart #test05ACartCanHaveMultipleCopiesOfTheSameBook stamp: 'PhG 10/30/2021 09:13:50'!
PASSED!
!Cart methodsFor: 'testing' stamp: 'PhG 10/30/2021 09:13:56' prior: 50869330!
quantityOfBook: aBook

	^books occurrencesOf: aBook.! !

!classDefinition: #Cart category: 'TusLibros' stamp: 'PhG 10/30/2021 09:14:55'!
Object subclass: #Cart
	instanceVariableNames: 'booksInCart catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 10/30/2021 09:14:55' prior: 50869324!
initializeWithCatalogue: aCatalogo

	catalogue _ aCatalogo.
	booksInCart _ OrderedCollection new.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 10/30/2021 09:14:55' prior: 50869314!
isEmpty

	^booksInCart isEmpty .! !
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 10/30/2021 09:14:55' prior: 50869309!
contains: aBookToSearch 

	^booksInCart includes: aBookToSearch.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 10/30/2021 09:14:55' prior: 50869264!
addBook: aBook 
	
	self assertBookIsInCatalogue: aBook.
	
	booksInCart add: aBook.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 10/30/2021 09:14:55' prior: 50869353!
quantityOfBook: aBook

	^booksInCart occurrencesOf: aBook.! !
!Cart methodsFor: 'initialization' stamp: 'PhG 10/30/2021 09:15:09' prior: 50869365!
initializeWithCatalogue: aCatalogue

	catalogue _ aCatalogue.
	booksInCart _ OrderedCollection new.! !

----SNAPSHOT----(30 October 2021 09:15:35) CuisUniversity-4532.image priorSource: 17080614!

----QUIT----(30 October 2021 11:52:17) CuisUniversity-4532.image priorSource: 17207878!

----STARTUP---- (30 October 2021 12:01:47) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


----QUIT----(30 October 2021 12:02:00) CuisUniversity-4532.image priorSource: 17207971!

----STARTUP---- (1 November 2021 17:04:57) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!classRemoval: #Catalogue stamp: 'PhG 11/1/2021 17:05:13'!
Object subclass: #Catalogue
	instanceVariableNames: 'books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'PhG 11/1/2021 17:05:14'!
Object subclass: #Cart
	instanceVariableNames: 'booksInCart catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #TestsCart stamp: 'PhG 11/1/2021 17:05:14'!
TestCase subclass: #TestsCart
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #ResidentialZone stamp: 'PhG 11/1/2021 17:05:17'!
Zone subclass: #ResidentialZone
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'ISW1-2021-2C-1erParcial'!

!classRemoval: #IndustrialZone stamp: 'PhG 11/1/2021 17:05:17'!
Zone subclass: #IndustrialZone
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'ISW1-2021-2C-1erParcial'!

!classRemoval: #CommertialZone stamp: 'PhG 11/1/2021 17:05:18'!
Zone subclass: #CommertialZone
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'ISW1-2021-2C-1erParcial'!

!classRemoval: #Zone stamp: 'PhG 11/1/2021 17:05:18'!
Object subclass: #Zone
	instanceVariableNames: 'numberOfCells'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'ISW1-2021-2C-1erParcial'!

!classRemoval: #Service stamp: 'PhG 11/1/2021 17:05:19'!
Object subclass: #Service
	instanceVariableNames: 'waterProduced energyProduced'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'ISW1-2021-2C-1erParcial'!

!classRemoval: #City stamp: 'PhG 11/1/2021 17:05:20'!
Object subclass: #City
	instanceVariableNames: 'zones services'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'ISW1-2021-2C-1erParcial'!

!classRemoval: #CityTest stamp: 'PhG 11/1/2021 17:05:21'!
TestCase subclass: #CityTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'ISW1-2021-2C-1erParcial'!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/TusLibros.st----!
!TestsCart methodsFor: 'tests carritos' stamp: 'PhG 11/1/2021 17:07:58' prior: 50869487!
test01ANewCartShouldBeEmpty
	
	|cart|
	
	cart _ Cart withCatalogue: (OrderedCollection new).
	
	self assert: cart isEmpty.! !

!testRun: #TestsCart #test01ANewCartShouldBeEmpty stamp: 'PhG 11/1/2021 17:08:06'!
PASSED!

!testRun: #TestsCart #test01ANewCartShouldBeEmpty stamp: 'PhG 11/1/2021 17:08:06'!
PASSED!

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 11/1/2021 17:08:06'!
PASSED!

!testRun: #TestsCart #test03ACartWithABookShouldContainIt stamp: 'PhG 11/1/2021 17:08:06'!
PASSED!

!testRun: #TestsCart #test04AddingABookNotInCatalogueToAcartShouldThrowError stamp: 'PhG 11/1/2021 17:08:06'!
PASSED!

!testRun: #TestsCart #test05ACartCanHaveMultipleCopiesOfTheSameBook stamp: 'PhG 11/1/2021 17:08:06'!
PASSED!
!TestsCart methodsFor: 'tests carritos' stamp: 'PhG 11/1/2021 17:09:00' prior: 50869494!
test02ACartWithABookIsNotEmpty

	|cart book catalogue|

	book _ '1234'.
	catalogue _ OrderedCollection with: book.	
	cart _ Cart withCatalogue: catalogue .

	cart addBook: book.

	self deny: cart isEmpty.! !

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 11/1/2021 17:09:01'!
PASSED!

!testRun: #TestsCart #test01ANewCartShouldBeEmpty stamp: 'PhG 11/1/2021 17:09:01'!
PASSED!

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 11/1/2021 17:09:01'!
PASSED!

!testRun: #TestsCart #test03ACartWithABookShouldContainIt stamp: 'PhG 11/1/2021 17:09:01'!
PASSED!

!testRun: #TestsCart #test04AddingABookNotInCatalogueToAcartShouldThrowError stamp: 'PhG 11/1/2021 17:09:01'!
PASSED!

!testRun: #TestsCart #test05ACartCanHaveMultipleCopiesOfTheSameBook stamp: 'PhG 11/1/2021 17:09:01'!
PASSED!
!TestsCart methodsFor: 'tests carritos' stamp: 'PhG 11/1/2021 17:09:15' prior: 50869504!
test03ACartWithABookShouldContainIt

	|cart book|
	book _ '1234'.
	cart _ Cart withCatalogue: (OrderedCollection with: book).
	
	cart addBook: book.
	
	self assert: (cart contains: book).! !

!testRun: #TestsCart #test03ACartWithABookShouldContainIt stamp: 'PhG 11/1/2021 17:09:19'!
PASSED!

!testRun: #TestsCart #test01ANewCartShouldBeEmpty stamp: 'PhG 11/1/2021 17:09:19'!
PASSED!

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 11/1/2021 17:09:19'!
PASSED!

!testRun: #TestsCart #test03ACartWithABookShouldContainIt stamp: 'PhG 11/1/2021 17:09:19'!
PASSED!

!testRun: #TestsCart #test04AddingABookNotInCatalogueToAcartShouldThrowError stamp: 'PhG 11/1/2021 17:09:19'!
PASSED!

!testRun: #TestsCart #test05ACartCanHaveMultipleCopiesOfTheSameBook stamp: 'PhG 11/1/2021 17:09:19'!
PASSED!
!TestsCart methodsFor: 'tests carritos' stamp: 'PhG 11/1/2021 17:18:15' prior: 50869631!
test02ACartWithABookIsNotEmpty

	|cart book catalogue|

	book _ 1234.
	catalogue _ OrderedCollection with: book.	
	cart _ Cart withCatalogue: catalogue .

	cart addBook: book.

	self deny: cart isEmpty.! !

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 11/1/2021 17:18:16'!
PASSED!

!testRun: #TestsCart #test01ANewCartShouldBeEmpty stamp: 'PhG 11/1/2021 17:18:16'!
PASSED!

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 11/1/2021 17:18:16'!
PASSED!

!testRun: #TestsCart #test03ACartWithABookShouldContainIt stamp: 'PhG 11/1/2021 17:18:16'!
PASSED!

!testRun: #TestsCart #test04AddingABookNotInCatalogueToAcartShouldThrowError stamp: 'PhG 11/1/2021 17:18:16'!
PASSED!

!testRun: #TestsCart #test05ACartCanHaveMultipleCopiesOfTheSameBook stamp: 'PhG 11/1/2021 17:18:16'!
PASSED!
!TestsCart methodsFor: 'tests carritos' stamp: 'PhG 11/1/2021 17:18:22' prior: 50869688!
test02ACartWithABookIsNotEmpty

	|cart book catalogue|

	book _ '1234'.
	catalogue _ OrderedCollection with: book.	
	cart _ Cart withCatalogue: catalogue .

	cart addBook: book.

	self deny: cart isEmpty.! !
!Cart methodsFor: 'initialization' stamp: 'PhG 11/1/2021 17:28:10' prior: 50869550!
initializeWithCatalogue: aCatalogue

	catalogue _ aCatalogue.
	booksInCart _ Bag new.! !

!testRun: #TestsCart #test01ANewCartShouldBeEmpty stamp: 'PhG 11/1/2021 17:28:13'!
PASSED!

!testRun: #TestsCart #test02ACartWithABookIsNotEmpty stamp: 'PhG 11/1/2021 17:28:13'!
PASSED!

!testRun: #TestsCart #test03ACartWithABookShouldContainIt stamp: 'PhG 11/1/2021 17:28:13'!
PASSED!

!testRun: #TestsCart #test04AddingABookNotInCatalogueToAcartShouldThrowError stamp: 'PhG 11/1/2021 17:28:13'!
PASSED!

!testRun: #TestsCart #test05ACartCanHaveMultipleCopiesOfTheSameBook stamp: 'PhG 11/1/2021 17:28:13'!
PASSED!

!classDefinition: #Cart category: 'TusLibros' stamp: 'PhG 11/1/2021 17:31:49'!
Object subclass: #Cart
	instanceVariableNames: 'products catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 17:31:49' prior: 50869727!
initializeWithCatalogue: aCatalogue

	catalogue _ aCatalogue.
	products _ Bag new.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 17:31:49' prior: 50869566!
isEmpty

	^products isEmpty .! !
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 17:31:49' prior: 50869561!
contains: aBookToSearch 

	^products includes: aBookToSearch.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 17:31:49' prior: 50869556!
addBook: aBook 
	
	self assertBookIsInCatalogue: aBook.
	
	products add: aBook.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 17:31:49' prior: 50869570!
quantityOfBook: aBook

	^products occurrencesOf: aBook.! !
!Cart methodsFor: 'adding books' stamp: 'PhG 11/1/2021 17:31:56' prior: 50869771!
addBook: aProduct 
	
	self assertBookIsInCatalogue: aProduct.
	
	products add: aProduct.! !
!Cart methodsFor: 'adding books' stamp: 'PhG 11/1/2021 17:35:08'!
addProduct: aProduct 
	
	self assertBookIsInCatalogue: aProduct.
	
	products add: aProduct.! !
!TestsCart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 17:35:08' prior: 50869528!
test05ACartCanHaveMultipleCopiesOfTheSameBook

	|cart book catalogue|
	
	book _'1234'.
	catalogue _ OrderedCollection with: book.
	cart _ Cart withCatalogue: catalogue.
	cart addProduct: book.
	cart addProduct: book.
	
	self assert: 2 equals: (cart quantityOfBook: book).! !
!TestsCart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 17:35:08' prior: 50869660!
test03ACartWithABookShouldContainIt

	|cart book|
	book _ '1234'.
	cart _ Cart withCatalogue: (OrderedCollection with: book).
	
	cart addProduct: book.
	
	self assert: (cart contains: book).! !
!TestsCart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 17:35:08' prior: 50869513!
test04AddingABookNotInCatalogueToAcartShouldThrowError

	|cart book catalogue |
	
	book _'1234'.
	catalogue _ OrderedCollection new.
	cart _ Cart withCatalogue: catalogue.
	
	self 
		should: [ cart addProduct: book.]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: Cart canNotAddBookNotInCatalogue equals: anError messageText.
			self assert: true equals: cart isEmpty .]! !
!TestsCart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 17:35:08' prior: 50869717!
test02ACartWithABookIsNotEmpty

	|cart book catalogue|

	book _ '1234'.
	catalogue _ OrderedCollection with: book.	
	cart _ Cart withCatalogue: catalogue .

	cart addProduct: book.

	self deny: cart isEmpty.! !

!methodRemoval: Cart #addBook: stamp: 'PhG 11/1/2021 17:35:08'!
addBook: aProduct 
	
	self assertBookIsInCatalogue: aProduct.
	
	products add: aProduct.!
!TestsCart methodsFor: 'tests carritos' stamp: 'PhG 11/1/2021 17:57:51' prior: 50869814!
test04AddingABookNotInCatalogueToAcartShouldThrowError

	|cart book catalogue |
	
	book _'1234'.
	catalogue _ OrderedCollection new.
	cart _ Cart withCatalogue: catalogue.
	
	self 
		should: [ cart addProduct: book.]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: Cart canNotAddBookNotInCatalogue equals: anError messageText.
			self assert: cart isEmpty .]! !

!classRemoval: #Cart stamp: 'PhG 11/1/2021 19:19:31'!
Object subclass: #Cart
	instanceVariableNames: 'products catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #TestsCart stamp: 'PhG 11/1/2021 19:19:31'!
TestCase subclass: #TestsCart
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/iteracion2/TusLibros.st----!

TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'PhG 11/1/2021 19:21:06'!
TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CashierTest methodsFor: 'no messages' stamp: 'PhG 11/1/2021 19:22:24'!
test01checkoutOnEmptyCartThrowsError! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 19:22:40' prior: 50870067!
test01checkoutOnEmptyCartThrowsError

	| cart |
	
	cart := Cart new.! !
!CashierTest methodsFor: 'nil' stamp: 'PhG 11/1/2021 19:23:40'!
createCart! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:24:03' prior: 50870077!
createCart
	
	^Cart acceptingItemsOf: self defaultCatalog! !

!classDefinition: #Cashier category: 'TusLibros' stamp: 'PhG 11/1/2021 19:25:40'!
Object subclass: #Cashier
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 19:25:33' prior: 50870072!
test01checkoutOnEmptyCartThrowsError

	| cart cashier |
	
	cart := Cart new.
	
	cashier := Cashier new.
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 19:25:56' prior: 50870093!
test01checkoutOnEmptyCartThrowsError

	| cart cashier |
	
	cart := self createCart.
	
	cashier := Cashier new.
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 19:26:55' prior: 50870100!
test01checkoutOnEmptyCartThrowsError

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier new.
	
	self 
		should: [cashier checkout: cart ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = cashier cartCanNotBeEmpty. ]! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:26:58'!
ERROR!
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:27:13'!
defaultCatalog
	self shouldBeImplemented.! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:27:23' prior: 50870121!
defaultCatalog
	
	^ Array with: self itemSellByTheStore! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:27:31'!
itemSellByTheStore
	
	^ 'validBook'! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:27:35'!
ERROR!
!Cashier methodsFor: 'error descriptions' stamp: 'PhG 11/1/2021 19:27:53'!
cartCanNotBeEmpty
	self shouldBeImplemented.! !
!Cashier methodsFor: 'error messages' stamp: 'PhG 11/1/2021 19:28:29' prior: 50870137!
cartCanNotBeEmpty

	^'Cart can not be empty'! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:28:30'!
FAILURE!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:28:31'!
FAILURE!
!Cashier methodsFor: 'nil' stamp: 'PhG 11/1/2021 19:28:46'!
checkout: aCart! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:29:12' prior: 50870152!
checkout: aCart
	self error! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:29:36' prior: 50870156!
checkout: aCart
	self error: self cartCanNotBeEmpty.! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:29:38'!
PASSED!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 19:30:23'!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier new.
	
	self 
		should: [cashier checkout: cart ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = cashier cartCanNotBeEmpty. ]! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 19:30:56' prior: 50870168!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier new.
	
	cart add: self itemSellByTheStore.
	
	self 
		should: [cashier checkout: cart ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = cashier cartCanNotBeEmpty. ]! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 19:31:29' prior: 50870180!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier new.
	
	cart add: self itemSellByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:32:09'!
defaultPriceList
	
	^ Array with: self itemSellByTheStore! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:32:22' prior: 50870204!
defaultPriceList
	
	^ Dictionary with: self itemSellByTheStore! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:33:23' prior: 50870209!
defaultPriceList
	
	^ Dictionary at: self itemSellByTheStore put: 100! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:33:32' prior: 50870081!
createCart
	
	^Cart acceptingItemsOf: self defaultPriceList! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:33:50'!
ERROR!
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:34:42' prior: 50870214!
defaultPriceList
	
	^ Dictionary add: (self itemSellByTheStore)-> 100! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:34:44'!
ERROR!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:34:44'!
ERROR!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:34:49'!
ERROR!
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 19:35:27' prior: 50870227!
defaultPriceList

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSellByTheStore)-> 100.
	^priceList.! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:35:31'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:35:31'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:35:31'!
ERROR!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:35:31'!
ERROR!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:35:42'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:35:42'!
ERROR!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:35:42'!
ERROR!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:35:45'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:35:45'!
ERROR!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:35:45'!
ERROR!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:35:50'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:35:50'!
ERROR!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:35:50'!
ERROR!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:36:01'!
ERROR!
!Cart methodsFor: 'assertions' stamp: 'PhG 11/1/2021 19:37:21' prior: 50869892!
assertIsValidItem: anItem

	(catalog includesKey: anItem) ifFalse: [ self error: self invalidItemErrorMessage ]! !

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:37:23'!
ERROR!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:37:52' prior: 50870160!
checkout: aCart
	
	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty]! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:38:13' prior: 50870309!
checkout: aCart
	
	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty]
	! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:40:17' prior: 50870315!
checkout: aCart
	
	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty]
	
	aCart items do: []! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:40:23' prior: 50870321!
checkout: aCart
	
	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	aCart items do: []! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:41:16' prior: 50870327!
checkout: aCart
	
	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	aCart items do: [].! !

!classDefinition: #Cashier category: 'TusLibros' stamp: 'PhG 11/1/2021 19:43:28'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:43:25' prior: 50870333!
checkout: aCart

	| total |
	
	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	aCart items do: [:anItem | priceList get: anItem].
	
	^total! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:43:42' prior: 50870346!
checkout: aCart

	| total |
	
	total := 0.
	
	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	aCart items do: [:anItem | priceList get: anItem].
	
	^total! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:44:08' prior: 50870354!
checkout: aCart

	| total |
	
	total := 0.
	
	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	total := aCart items sum: [:anItem | priceList get: anItem].
	
	^total! !

!classDefinition: #Cart category: 'TusLibros' stamp: 'PhG 11/1/2021 19:47:11'!
Object subclass: #Cart
	instanceVariableNames: 'priceList items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 19:47:11' prior: 50869905!
initializeAcceptingItemsOf: aCatalog

	priceList := aCatalog.
	items := OrderedCollection new.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 19:47:11' prior: 50870299!
assertIsValidItem: anItem

	(priceList includesKey: anItem) ifFalse: [ self error: self invalidItemErrorMessage ]! !
!Cart methodsFor: 'initialization' stamp: 'PhG 11/1/2021 19:47:17' prior: 50870378!
initializeAcceptingItemsOf: aPriceList

	priceList := aPriceList.
	items := OrderedCollection new.! !
!Cashier methodsFor: 'nil' stamp: 'PhG 11/1/2021 19:47:28'!
initializeAcceptingItemsOf: aPriceList

	priceList := aPriceList.! !
!Cashier class methodsFor: 'nil' stamp: 'PhG 11/1/2021 19:47:45'!
acceptingItemsOf: aCatalog

	^self new initializeAcceptingItemsOf: aCatalog ! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/1/2021 19:48:04' prior: 50870402!
acceptingItemsOf: aPriceList

	^self new initializeAcceptingItemsOf: aPriceList ! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/1/2021 19:48:20' prior: 50870408!
acceptingItemsOf: aPriceList

	"testear que ningun precio sea negativo o 0"

	^self new initializeAcceptingItemsOf: aPriceList ! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/1/2021 19:48:26' prior: 50870414!
acceptingItemsOf: aPriceList

	"testear que todo precio sea positivo"

	^self new initializeAcceptingItemsOf: aPriceList ! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 19:48:52' prior: 50870194!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier acceptingItemsOf: self defaultPriceList .
	
	cart add: self itemSellByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 19:48:53' prior: 50870429!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier acceptingItemsOf: self defaultPriceList.
	
	cart add: self itemSellByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:48:54'!
ERROR!
!Cart methodsFor: 'queries' stamp: 'PhG 11/1/2021 19:49:07'!
items
	^items .! !
!Cart methodsFor: 'queries' stamp: 'PhG 11/1/2021 19:49:08' prior: 50870454!
items
	^items.! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:49:11'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:49:11'!
ERROR!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:49:11'!
ERROR!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/1/2021 19:50:15' prior: 50870362!
checkout: aCart

	| total |
	
	total := 0.
	
	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	total := aCart items sum: [:anItem | priceList at: anItem].
	
	^total! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 19:50:17'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 19:50:17'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 20:06:24'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 20:06:24'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 20:06:24'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/1/2021 20:06:29'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/1/2021 20:06:29'!
ERROR!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/1/2021 20:06:29'!
ERROR!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/1/2021 20:06:29'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/1/2021 20:06:29'!
ERROR!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/1/2021 20:06:29'!
ERROR!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/1/2021 20:06:29'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/1/2021 20:06:29'!
ERROR!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/1/2021 20:06:37'!
ERROR!
!CartTest methodsFor: 'support' stamp: 'PhG 11/1/2021 20:06:51'!
defaultPriceList

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSellByTheStore)-> 100.
	^priceList.! !
!CartTest methodsFor: 'support' stamp: 'PhG 11/1/2021 20:06:57' prior: 50870039!
createCart
	
	^Cart acceptingItemsOf: self defaultPriceList! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/1/2021 20:06:58'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/1/2021 20:06:58'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/1/2021 20:06:58'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/1/2021 20:06:58'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/1/2021 20:06:58'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/1/2021 20:06:58'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/1/2021 20:06:58'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/1/2021 20:06:58'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 20:07:00'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 20:07:00'!
PASSED!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:08:23'!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier acceptingItemsOf: self defaultPriceList.
	
	cart add: self itemSellByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !

!methodRemoval: CashierTest #defaultCatalog stamp: 'PhG 11/1/2021 20:08:31'!
defaultCatalog
	
	^ Array with: self itemSellByTheStore!
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 20:08:43'!
priceListwithTwoItems

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSellByTheStore)-> 100.
	^priceList.! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 20:09:00' prior: 50870585!
priceListwithTwoItems

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSellByTheStore)-> 100.
	priceList add: (self otherItemSoldByTheStore)-> 100.
	^priceList.! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 20:09:09'!
itemSoldByTheStore
	
	^ 'validBook'! !
!CartTest methodsFor: 'support' stamp: 'PhG 11/1/2021 20:09:09'!
itemSoldByTheStore
	
	^ 'validBook'! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50869985!
test08CartRemembersTheNumberOfAddedItems

	| cart |
	
	cart := self createCart.
	
	cart add: 2 of: self itemSoldByTheStore.
	self assert: (cart occurrencesOf: self itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50870027!
test06CartRemembersAddedItems

	| cart |
	
	cart := self createCart.
	
	cart add: self itemSoldByTheStore.
	self assert: (cart includes: self itemSoldByTheStore)! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50870044!
defaultCatalog
	
	^ Array with: self itemSoldByTheStore! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50869959!
test04CanNotAddNonPositiveNumberOfItems

	| cart |
	
	cart := self createCart.
	
	self 
		should: [cart add: 0 of: self itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50870526!
defaultPriceList

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSoldByTheStore)-> 100.
	^priceList.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50870242!
defaultPriceList

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSoldByTheStore)-> 100.
	^priceList.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50870592!
priceListwithTwoItems

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSoldByTheStore)-> 100.
	priceList add: (self otherItemSoldByTheStore)-> 100.
	^priceList.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50870440!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier acceptingItemsOf: self defaultPriceList.
	
	cart add: self itemSoldByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50870570!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier acceptingItemsOf: self defaultPriceList.
	
	cart add: self itemSoldByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50870007!
test07CartDoesNotHoldNotAddedItems

	| cart |
	
	cart := self createCart.
	
	self deny: (cart includes: self itemSoldByTheStore)! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/1/2021 20:09:09' prior: 50869999!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |
	
	cart := self createCart.
	
	cart add: self itemSoldByTheStore.
	self deny: cart isEmpty ! !

!methodRemoval: CashierTest #itemSellByTheStore stamp: 'PhG 11/1/2021 20:09:09'!
itemSellByTheStore
	
	^ 'validBook'!

!methodRemoval: CartTest #itemSellByTheStore stamp: 'PhG 11/1/2021 20:09:09'!
itemSellByTheStore
	
	^ 'validBook'!
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 20:09:20'!
otherItemSoldByTheStore
	
	^ 'otherValidBook'! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 20:09:25' prior: 50870662!
priceListwithTwoItems

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSoldByTheStore)-> 100.
	priceList add: (self otherItemSoldByTheStore)-> 60.
	^priceList.! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:09:33' prior: 50870683!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems .
	
	cart add: self itemSoldByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:09:35' prior: 50870732!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems.
	
	cart add: self itemSoldByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:09:45' prior: 50870744!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier |
	
	cart := self createCart with: self priceListwithTwoItems.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems.
	
	cart add: self itemSoldByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/1/2021 20:10:07'!
createCartWith: aPriceList
	
	^Cart acceptingItemsOf: aPriceList! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:10:20' prior: 50870756!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems.
	
	cart add: self itemSoldByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:10:35' prior: 50870773!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:10:38' prior: 50870786!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	self assert: 160 equals: (cashier checkout: cart)
	! !

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/1/2021 20:10:39'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/1/2021 20:10:39'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/1/2021 20:10:39'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/1/2021 20:10:39'!
PASSED!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:11:21'!
test04checkoutWithExpiredCreditCardIsRejected

	| cart cashier |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	self assert: 160 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:16:26' prior: 50870828!
test04checkoutWithExpiredCreditCardIsRejected

	| cart cashier today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	today := Date today.
	
	self assert: 160 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:17:03' prior: 50870842!
test04checkoutWithExpiredCreditCardIsRejected

	| cart cashier today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	today := Date today.
	
	self assert: 160 equals: (cashier checkout: cart withCardExpirationDate: (today))
	! !

Date today!

(Date today) - 2!

(Date today) - GregorianMonth new!

Date today!

FixedGregorianDate !

(FixedGregorianDate today ) - (FixedGregorianDate yesterday )!

dateToday := FixedGregorianDate today.!

dateToday previous: dateToday twoMonths.!

(FixedGregorianDate yearNumber: 2004 monthNumber: 1 dayNumber: 1) previous: (TimeUnits week with: 1)!

(FixedGregorianDate today) previous: (TimeUnits week with: 1)!

(FixedGregorianDate today) previous: (TimeUnits month with: 1) !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/1/2021 20:31:41' prior: 50870857!
test04checkoutWithExpiredCreditCardIsRejected

	| cart cashier today expiredDate |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier acceptingItemsOf: self priceListwithTwoItems.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	today := FixedGregorianDate today.
	
	expiredDate := today previous: (TimeUnits month with: 1).
	
	self assert: 160 equals: (cashier checkout: cart withCardExpirationDate: expiredDate)
	! !

----QUIT----(2 November 2021 07:56:59) CuisUniversity-4532.image priorSource: 17208191!

----STARTUP---- (2 November 2021 17:05:34) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'PhG 11/2/2021 17:06:37'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCardTest methodsFor: 'nil' stamp: 'PhG 11/2/2021 17:08:52'!
test01CreditCardWithLessThan16DigitsCanNotBeInstantiated

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/2/2021 17:09:26' prior: 50870924!
test01CreditCardWithLessThan16DigitsCanNotBeInstantiated

	| cardNumber |
	
	cardNumber := '0123456789'
	
	

	! !

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'PhG 11/2/2021 17:10:46'!
Object subclass: #CreditCard
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/2/2021 17:10:39' prior: 50870930!
test01CreditCardWithLessThan16DigitsCanNotBeInstantiated

	| cardNumber |
	
	cardNumber := '0123456789'	

	self 
		should: [CreditCard withNumber: cardNumber ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/2/2021 17:10:57' prior: 50870944!
test01CreditCardWithLessThan16DigitsCanNotBeInstantiated

	| cardNumber |
	
	cardNumber := '0123456789'	.

	self 
		should: [CreditCard withNumber: cardNumber ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:10:59'!
ERROR!
!CreditCard class methodsFor: '*DenotativeObject' stamp: 'PhG 11/2/2021 17:11:08'!
creditCardMustContain16Digits
	self shouldBeImplemented.! !
!CreditCard class methodsFor: '*DenotativeObject' stamp: 'PhG 11/2/2021 17:11:20' prior: 50870973!
creditCardMustContain16Digits
	^'A credit card must contain 16 digits'! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:11:22'!
FAILURE!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:11:48'!
FAILURE!
!CreditCard class methodsFor: 'nil' stamp: 'PhG 11/2/2021 17:12:48'!
withNumber: aCardNumber

	aCardNumber size < 16 ifTrue: [self error: CreditCard creditCardMustContain16Digits].! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:13:12'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:13:12'!
PASSED!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:13:20'!
test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated

	| cardNumber |
	
	cardNumber := '0123456789'	.

	self 
		should: [CreditCard withNumber: cardNumber ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:13:31' prior: 50871005!
test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated

	| cardNumber |
	
	cardNumber := '01234567890123456789'	.

	self 
		should: [CreditCard withNumber: cardNumber ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:13:33'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/2/2021 17:13:45' prior: 50870991!
withNumber: aCardNumber

	aCardNumber size ~= 16 ifTrue: [self error: CreditCard creditCardMustContain16Digits].! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:13:47'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:13:47'!
PASSED!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:14:30'!
test02CreditCardWithExpirationDateInTheFutureIsNotExpired

	| cardNumber |
	
	cardNumber := '01234567890123456789'	.

	self 
		should: [CreditCard withNumber: cardNumber ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:16:01' prior: 50871048!
test02CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard today |
	
	creditCard := CreditCard withNumber: '0123456789123456'	.
	
	today := FixedGregorianDate today.
	
	self deny: (creditCard isExpiredOn: today).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:16:36' prior: 50871061!
test02CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard today |
	
	today := FixedGregorianDate today.
	
	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: today.
	
	self deny: (creditCard isExpiredOn: today).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:16:58'!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard today |
	
	today := FixedGregorianDate today.
	
	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: today.
	
	self deny: (creditCard isExpiredOn: today).! !

!methodRemoval: CreditCardTest #test02CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:16:58'!
test02CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard today |
	
	today := FixedGregorianDate today.
	
	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: today.
	
	self deny: (creditCard isExpiredOn: today).!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:17:17' prior: 50871082!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard today |
	
	today := GregorianMonthOfYear today.
	
	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: today.
	
	self deny: (creditCard isExpiredOn: today).! !

GregorianMonthOfYear!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:18:25' prior: 50871105!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard today |
	
	today := GregorianMonthOfYear current.
	
	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: (today nex).
	
	self deny: (creditCard isExpiredOn: today).! !

today := GregorianMonthOfYear current.!

today := GregorianMonthOfYear current.

jan := today next: 2!

today := GregorianMonthOfYear current.

jan := today next: (today twoMonths)!

today := GregorianMonthOfYear current.

today twoMonths!

today := GregorianMonthOfYear current.

today next: (TimeUnits month with: 2)!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:22:49' prior: 50871117!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard today |
	
	today := GregorianMonthOfYear current.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: (today next: (TimeUnits month with: 2)).
	
	self deny: (creditCard isExpiredOn: today).! !

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:22:51'!
ERROR!
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/2/2021 17:23:02'!
withNumber: aString withExpirationDate: aGregorianMonthOfYear 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithNumber: aString withExpirationDate: aGregorianMonthOfYear ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/2/2021 17:23:46' prior: 50871154!
withNumber: aCardNumber withExpirationDate: anExpirationDate 

	aCardNumber size ~= 16 ifTrue: [self error: CreditCard creditCardMustContain16Digits].! !
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/2/2021 17:24:45' prior: 50871165!
withNumber: aCardNumber withExpirationDate: anExpirationDate 

	aCardNumber size ~= 16 ifTrue: [self error: CreditCard creditCardMustContain16Digits].
	
	(anExpirationDate isKindOf: GregorianMonthOfYear) ifFalse: [self error: CreditCard creditCardMustContain16Digits].! !
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/2/2021 17:25:43' prior: 50871173!
withNumber: aCardNumber withExpirationDate: anExpirationDate 

	aCardNumber size ~= 16 ifTrue: [self error: CreditCard creditCardMustContain16Digits].
	
	^self basicNew initializeWith: aCardNumber withExpirationDate: anExpirationDate.! !
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/2/2021 17:26:09'!
assertCardNumberIs16DigitsLong: aCardNumber

	^ aCardNumber size ~= 16 ifTrue: [self error: CreditCard creditCardMustContain16Digits]! !
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/2/2021 17:26:09' prior: 50871185!
withNumber: aCardNumber withExpirationDate: anExpirationDate 

	self assertCardNumberIs16DigitsLong: aCardNumber.
	
	^self basicNew initializeWith: aCardNumber withExpirationDate: anExpirationDate.! !

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:26:27'!
ERROR!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'PhG 11/2/2021 17:26:52'!
Object subclass: #CreditCard
	instanceVariableNames: 'cardNumber'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'PhG 11/2/2021 17:26:53'!
Object subclass: #CreditCard
	instanceVariableNames: 'cardNumber expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'initialization' stamp: 'PhG 11/2/2021 17:26:53'!
initializeWith: aCardNumber withExpirationDate: anExpirationDate 
	self shouldBeImplemented.
	cardNumber := aCardNumber.
	expirationDate := anExpirationDate.! !
!CreditCard methodsFor: 'initialization' stamp: 'PhG 11/2/2021 17:26:57' prior: 50871231!
initializeWith: aCardNumber withExpirationDate: anExpirationDate 
	
	cardNumber := aCardNumber.
	expirationDate := anExpirationDate.! !

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:27:00'!
ERROR!
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:27:11'!
isExpiredOn: aGregorianMonthOfYear 
	self shouldBeImplemented.! !
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:27:14' prior: 50871250!
isExpiredOn: aGregorianMonthOfYear 
	^false! !
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:27:14' prior: 50871255!
isExpiredOn: aGregorianMonthOfYear 
	^false.! !

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:27:16'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:27:16'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:27:16'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:27:16'!
PASSED!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:27:44'!
test04CreditCardWithExpirationDateInThePastIsExpired

	| creditCard today |
	
	today := GregorianMonthOfYear current.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: (today next: (TimeUnits month with: 2)).
	
	self deny: (creditCard isExpiredOn: today).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:27:56' prior: 50871138!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard currentMonthOfYear |
	
	currentMonthOfYear := GregorianMonthOfYear current.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: (currentMonthOfYear next: (TimeUnits month with: 2)).
	
	self deny: (creditCard isExpiredOn: currentMonthOfYear).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:28:42' prior: 50871292!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard currentMonthOfYear twoMonthsToTheFuture |
	
	currentMonthOfYear := GregorianMonthOfYear current.
	twoMonthsToTheFuture := (currentMonthOfYear next: (TimeUnits month with: 2)).

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToTheFuture .
	
	self deny: (creditCard isExpiredOn: currentMonthOfYear).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:28:43' prior: 50871306!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard currentMonthOfYear twoMonthsToTheFuture |
	
	currentMonthOfYear := GregorianMonthOfYear current.
	twoMonthsToTheFuture := (currentMonthOfYear next: (TimeUnits month with: 2)).

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToTheFuture.
	
	self deny: (creditCard isExpiredOn: currentMonthOfYear).! !

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:28:44'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:28:44'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:28:44'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:28:44'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:28:44'!
PASSED!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:28:54' prior: 50871280!
test04CreditCardWithExpirationDateInThePastIsExpired

	| creditCard today |
	
	today := GregorianMonthOfYear current.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: (today next: (TimeUnits month with: 2)).
	
	self assert: (creditCard isExpiredOn: today).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:29:34' prior: 50871358!
test04CreditCardWithExpirationDateInThePastIsExpired

	| creditCard currentMonthOfYear twoMonthsToThePast |
	
	currentMonthOfYear := GregorianMonthOfYear current.
	twoMonthsToThePast := (currentMonthOfYear previous: (TimeUnits month with: 2)).

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToThePast.
	
	self assert: (creditCard isExpiredOn: currentMonthOfYear).! !

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:29:34'!
FAILURE!
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:29:52' prior: 50871260!
isExpiredOn: aDate 
	^false.! !
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:30:05' prior: 50871390!
isExpiredOn: aDate 
	^expirationDate < aDate.! !

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:30:10'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:30:10'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:30:10'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:30:10'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:30:10'!
PASSED!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:30:30'!
test05CreditCardWithExpirationDateInThePresentIsNotExpired

	| creditCard currentMonthOfYear |
	
	currentMonthOfYear := GregorianMonthOfYear current.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: currentMonthOfYear.
	
	self assert: (creditCard isExpiredOn: currentMonthOfYear).! !

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:30:34'!
FAILURE!
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:33:25' prior: 50871394!
isExpiredOn: aDate 
	^(expirationDate < aDate) and: [expirationDate ~= aDate].! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:33:29'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:33:29'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:33:29'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:33:29'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:33:29'!
FAILURE!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:33:29'!
FAILURE!

(expirationDate < aDate) or: [expirationDate ~= aDate].!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:34:05'!
FAILURE!
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:34:17' prior: 50871435!
isExpiredOn: aDate 
	^(expirationDate < aDate) or: [expirationDate ~= aDate].! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:34:18'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:34:18'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:34:18'!
FAILURE!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:34:18'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:34:18'!
FAILURE!
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:34:28' prior: 50871470!
isExpiredOn: aDate 
	^(expirationDate < aDate) and: [expirationDate ~= aDate].! !
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:34:33' prior: 50871495!
isExpiredOn: aDate 
	^(expirationDate < aDate) and: [expirationDate = aDate].! !
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:34:38' prior: 50871501!
isExpiredOn: aDate 
	^(expirationDate < aDate) and: [expirationDate ~= aDate].! !
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:34:56' prior: 50871507!
isExpiredOn: aDate 
	^(expirationDate < aDate) or: [(expirationDate = aDate) not].! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:34:58'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:34:58'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:34:58'!
FAILURE!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:34:58'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:34:58'!
FAILURE!
!CreditCard methodsFor: 'testing' stamp: 'PhG 11/2/2021 17:43:27' prior: 50871513!
isExpiredOn: aDate 
	^((aDate < expirationDate) and: (expirationDate ~= aDate)) not.! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:43:30'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:43:30'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:43:30'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:43:30'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:43:30'!
PASSED!
!CreditCardTest methodsFor: 'nil' stamp: 'PhG 11/2/2021 17:44:19'!
currentMonthOfYear

	^GregorianMonthOfYear current.! !
!CreditCardTest methodsFor: 'dates' stamp: 'PhG 11/2/2021 17:44:55'!
twoMonthsFrom: aMonthOfYear

	^GregorianMonthOfYear current.! !
!CreditCardTest methodsFor: 'dates' stamp: 'PhG 11/2/2021 17:44:57'!
twoMonthsSince: aMonthOfYear

	^GregorianMonthOfYear current.! !
!CreditCardTest methodsFor: 'dates' stamp: 'PhG 11/2/2021 17:45:22' prior: 50871572!
twoMonthsSince: aMonthOfYear

	^aMonthOfYear previous: (TimeUnits month with: 2).! !
!CreditCardTest methodsFor: 'dates' stamp: 'PhG 11/2/2021 17:45:33' prior: 50871567!
twoMonthsFrom: aMonthOfYear

	^aMonthOfYear next: (TimeUnits month with: 2).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:45:48' prior: 50871418!
test05CreditCardWithExpirationDateInThePresentIsNotExpired

	| creditCard currentMonthOfYear |
	
	currentMonthOfYear := self currentMonthOfYear.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: currentMonthOfYear.
	
	self assert: (creditCard isExpiredOn: currentMonthOfYear).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:46:08' prior: 50871370!
test04CreditCardWithExpirationDateInThePastIsExpired

	| creditCard currentMonthOfYear twoMonthsToThePast |
	
	currentMonthOfYear := self currentMonthOfYear.
	twoMonthsToThePast := self twoMonthsSince: currentMonthOfYear.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToThePast.
	
	self assert: (creditCard isExpiredOn: currentMonthOfYear).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:46:21' prior: 50871322!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard currentMonthOfYear twoMonthsToTheFuture |
	
	currentMonthOfYear := self currentMonthOfYear.
	twoMonthsToTheFuture := self twoMonthsSince: currentMonthOfYear.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToTheFuture.
	
	self deny: (creditCard isExpiredOn: currentMonthOfYear).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:46:47' prior: 50871017!
test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated

	| cardNumber currentMonthOfYear twoMonthsToTheFuture |
	
	cardNumber := '01234567890123456789'	.
	currentMonthOfYear := self currentMonthOfYear.
	twoMonthsToTheFuture := self twoMonthsSince: currentMonthOfYear.

	self 
		should: [CreditCard withNumber: cardNumber ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:47:21' prior: 50871632!
test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated

	| cardNumber currentMonthOfYear twoMonthsToTheFuture |
	
	cardNumber := '01234567890123456789'	.
	twoMonthsToTheFuture := self twoMonthsSince: self currentMonthOfYear.

	self 
		should: [CreditCard withNumber: cardNumber withExpirationDate: twoMonthsToTheFuture ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:47:25' prior: 50871649!
test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated

	| cardNumber twoMonthsToTheFuture |
	
	cardNumber := '01234567890123456789'	.
	twoMonthsToTheFuture := self twoMonthsSince: self currentMonthOfYear.

	self 
		should: [CreditCard withNumber: cardNumber withExpirationDate: twoMonthsToTheFuture ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:47:36' prior: 50870957!
test01CreditCardWithLessThan16DigitsCanNotBeInstantiated

	| cardNumber twoMonthsToTheFuture |
	
	cardNumber := '0123456789'	.
	twoMonthsToTheFuture := self twoMonthsSince: self currentMonthOfYear.

	self 
		should: [CreditCard withNumber: cardNumber ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:47:44' prior: 50871683!
test01CreditCardWithLessThan16DigitsCanNotBeInstantiated

	| cardNumber twoMonthsToTheFuture |
	
	cardNumber := '0123456789'	.
	twoMonthsToTheFuture := self twoMonthsSince: self currentMonthOfYear.

	self 
		should: [CreditCard withNumber: cardNumber withExpirationDate: twoMonthsToTheFuture ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'nil' stamp: 'PhG 11/2/2021 17:49:11'!
assertCreditCardMustContain16DigitsForCardNumber: aCardNumber! !
!CreditCardTest methodsFor: 'assertions' stamp: 'PhG 11/2/2021 17:49:56' prior: 50871714!
assertCreditCardMustContain16DigitsForCardNumber: aCardNumber

	| twoMonthsToTheFuture |
	twoMonthsToTheFuture := self twoMonthsSince: self currentMonthOfYear.! !
!CreditCardTest methodsFor: 'assertions' stamp: 'PhG 11/2/2021 17:50:14' prior: 50871719!
assertCreditCardMustContain16DigitsForCardNumber: aCardNumber

	| twoMonthsToTheFuture |
	twoMonthsToTheFuture := self twoMonthsSince: self currentMonthOfYear.
	
	self 
		should: [CreditCard withNumber: aCardNumber withExpirationDate: twoMonthsToTheFuture ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'assertions' stamp: 'PhG 11/2/2021 17:50:20' prior: 50871727!
assertCreditCardMustContain16DigitsForCardNumber: aCardNumber

	| twoMonthsToTheFuture |

	twoMonthsToTheFuture := self twoMonthsSince: self currentMonthOfYear.
	
	self 
		should: [CreditCard withNumber: aCardNumber withExpirationDate: twoMonthsToTheFuture ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:50:42' prior: 50871698!
test01CreditCardWithLessThan16DigitsCanNotBeInstantiated

	| cardNumber |
	
	cardNumber := '0123456789'	.

	self assertCreditCardMustContain16DigitsForCardNumber: cardNumber.! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:50:50'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:50:50'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:50:50'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:50:50'!
FAILURE!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:50:50'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:50:50'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:50:50'!
FAILURE!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:51:07' prior: 50871666!
test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated
| cardNumber |
	
	cardNumber := '01234567890123456789'	.

	self assertCreditCardMustContain16DigitsForCardNumber: cardNumber.! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:51:11' prior: 50871793!
test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated
	
	| cardNumber |
	
	cardNumber := '01234567890123456789'	.

	self assertCreditCardMustContain16DigitsForCardNumber: cardNumber.! !

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:51:12'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:51:12'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:51:12'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:51:12'!
FAILURE!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:51:12'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:51:12'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:51:12'!
FAILURE!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:51:34'!
FAILURE!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:51:54'!
FAILURE!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:52:16' prior: 50871617!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard currentMonthOfYear twoMonthsToTheFuture |
	
	currentMonthOfYear := self currentMonthOfYear.
	twoMonthsToTheFuture := self twoMonthsFrom: currentMonthOfYear.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToTheFuture.
	
	self deny: (creditCard isExpiredOn: currentMonthOfYear).! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:52:23'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 17:52:23'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 17:52:23'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 17:52:23'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 17:52:23'!
PASSED!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/2/2021 17:53:32' prior: 50870671!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier |
	
	cart := self createCart.
	cashier := Cashier new.
	
	cart add: self itemSoldByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/2/2021 17:53:38' prior: 50870800!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier new.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	self assert: 160 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/2/2021 17:53:44' prior: 50870888!
test04checkoutWithExpiredCreditCardIsRejected

	| cart cashier today expiredDate |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier new.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	today := FixedGregorianDate today.
	
	expiredDate := today previous: (TimeUnits month with: 1).
	
	self assert: 160 equals: (cashier checkout: cart withCardExpirationDate: expiredDate)
	! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/2/2021 17:53:49'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/2/2021 17:53:49'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/2/2021 17:53:49'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/2/2021 17:53:49'!
ERROR!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/2/2021 17:53:53'!
ERROR!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/2/2021 17:54:04'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/2/2021 17:54:04'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/2/2021 17:54:04'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/2/2021 17:54:04'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/2/2021 17:54:04'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/2/2021 17:54:04'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/2/2021 17:54:04'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/2/2021 17:54:04'!
PASSED!

!methodRemoval: Cashier class #acceptingItemsOf: stamp: 'PhG 11/2/2021 17:54:40'!
acceptingItemsOf: aPriceList

	"testear que todo precio sea positivo"

	^self new initializeAcceptingItemsOf: aPriceList !

!methodRemoval: Cashier #initializeAcceptingItemsOf: stamp: 'PhG 11/2/2021 17:55:00'!
initializeAcceptingItemsOf: aPriceList

	priceList := aPriceList.!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/2/2021 17:55:28' prior: 50870471!
checkout: aCart

	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	^aCart total.! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/2/2021 17:55:43' prior: 50871977!
checkout: aCart

	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	^aCart totalPrice.! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/2/2021 17:55:48'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/2/2021 17:55:48'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/2/2021 17:55:48'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/2/2021 17:55:48'!
ERROR!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/2/2021 17:55:50'!
ERROR!
!Cart methodsFor: 'total price' stamp: 'PhG 11/2/2021 17:56:30'!
totalPrice
	self shouldBeImplemented.! !
!Cart methodsFor: 'total price' stamp: 'PhG 11/2/2021 17:56:35' prior: 50872007!
totalPrice
	^0! !

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/2/2021 17:56:37'!
FAILURE!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:57:14'!
test09TotalPriceOfEmptyCartIsZero

	| cart |
	
	cart := self createCart.
	
	cart add: 2 of: self itemSoldByTheStore.
	self assert: (cart occurrencesOf: self itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:57:28' prior: 50872018!
test09TotalPriceOfEmptyCartIsZero

	| cart |
	
	cart := self createCart.
	
	self assert: (cart totalPrice ) = 0.! !

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/2/2021 17:57:29'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:57:55'!
test10TotalPriceOfCartWithItemIsItemPrice

	| cart |
	
	cart := self createCart.
	
	self assert: (cart totalPrice ) = 0.! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:58:09' prior: 50872065!
test10TotalPriceOfCartWithItemIsItemPrice

	| cart |
	
	cart := self createCart.
	
	cart add: 1 of: self itemSoldByTheStore.
	self assert: (cart totalPrice ) = 0.! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:58:20' prior: 50872072!
test10TotalPriceOfCartWithItemIsItemPrice

	| cart |
	
	cart := self createCart.
	
	cart add: 1 of: self itemSoldByTheStore.
	self assert: (cart totalPrice ) = 1000.! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 17:58:21' prior: 50872080!
test10TotalPriceOfCartWithItemIsItemPrice

	| cart |
	
	cart := self createCart.
	
	cart add: 1 of: self itemSoldByTheStore.
	self assert: (cart totalPrice ) = 100.! !

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/2/2021 17:58:21'!
FAILURE!
!Cart methodsFor: 'total price' stamp: 'PhG 11/2/2021 17:59:26' prior: 50872011!
totalPrice

	| total |
	
	total := 0.
	
	items size = 1 ifTrue: [total := priceList at: (items at: 1)]
	
	^total.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/2/2021 17:59:33'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/2/2021 17:59:33'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/2/2021 17:59:33'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/2/2021 17:59:33'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/2/2021 17:59:33'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/2/2021 17:59:33'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/2/2021 17:59:33'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/2/2021 17:59:33'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/2/2021 17:59:33'!
ERROR!

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/2/2021 17:59:33'!
ERROR!
!Cart methodsFor: 'total price' stamp: 'PhG 11/2/2021 17:59:52' prior: 50872100!
totalPrice

	| total |
	
	total := 0.
	
	items size = 1 ifTrue: [total := total + priceList at: (items at: 1)].
	
	^total.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/2/2021 17:59:54'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 18:00:10'!
test10TotalPriceOfCartWithItemsIsAddedItemsPrice

	| cart |
	
	cart := self createCart.
	
	cart add: 2 of: self itemSoldByTheStore.
	self assert: (cart totalPrice ) = 200.! !

!testRun: #CartTest #test10TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/2/2021 18:00:10'!
FAILURE!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/2/2021 18:00:17'!
test11TotalPriceOfCartWithItemsIsAddedItemsPrice

	| cart |
	
	cart := self createCart.
	
	cart add: 2 of: self itemSoldByTheStore.
	self assert: (cart totalPrice ) = 200.! !

!methodRemoval: CartTest #test10TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/2/2021 18:00:17'!
test10TotalPriceOfCartWithItemsIsAddedItemsPrice

	| cart |
	
	cart := self createCart.
	
	cart add: 2 of: self itemSoldByTheStore.
	self assert: (cart totalPrice ) = 200.!
!Cart methodsFor: 'total price' stamp: 'PhG 11/2/2021 18:01:16' prior: 50872139!
totalPrice

	| total |
	
	total := 0.
	
	items sum: [:anItem | total := total + (priceList at: anItem)] ifEmpty: [^0].
	
	^total.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!

!testRun: #CartTest #test11TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/2/2021 18:01:20'!
PASSED!
!Cart methodsFor: 'total price' stamp: 'PhG 11/2/2021 18:02:32' prior: 50872205!
totalPrice

	
	
	^items sum: [:anItem | priceList at: anItem] ifEmpty: [0].! !
!Cart methodsFor: 'total price' stamp: 'PhG 11/2/2021 18:02:36' prior: 50872248!
totalPrice

	^items sum: [:anItem | priceList at: anItem] ifEmpty: [0].! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CartTest #test11TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/2/2021 18:02:38'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/2/2021 18:03:05'!
ERROR!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/2/2021 18:03:32'!
checkout: aCart withExpirationDate: anExpirationDate

	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	^aCart totalPrice.! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/2/2021 18:03:34'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/2/2021 18:03:34'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/2/2021 18:03:34'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/2/2021 18:03:34'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/2/2021 18:03:34'!
ERROR!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/2/2021 18:03:45'!
checkout: aCart withCardExpirationDate: anExpirationDate

	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	^aCart totalPrice.! !

!methodRemoval: Cashier #checkout:withExpirationDate: stamp: 'PhG 11/2/2021 18:03:45'!
checkout: aCart withExpirationDate: anExpirationDate

	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmpty].
	
	^aCart totalPrice.!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/2/2021 18:03:46'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/2/2021 18:03:46'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/2/2021 18:03:46'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/2/2021 18:03:46'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CartTest #test11TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/2/2021 18:04:28'!
PASSED!

----QUIT----(2 November 2021 18:04:33) CuisUniversity-4532.image priorSource: 17256160!

----STARTUP---- (3 November 2021 07:51:02) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!

!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 07:53:59' prior: 50870107!
test01checkoutOnEmptyCartThrowsError

	| cart cashier creditCard today |
	
	cart := self createCart.
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self 
		should: [cashier checkout: cart ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = cashier cartCanNotBeEmpty. ]! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 07:54:11'!
ERROR!
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 07:54:21'!
prepareCheckoutFor: aCart payingWith: anUndefinedObject on: anUndefinedObject3 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializePrepareCheckoutFor: aCart payingWith: anUndefinedObject on: anUndefinedObject3 ! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 07:54:58' prior: 50872445!
prepareCheckoutFor: aCart payingWith: aCreditCard on: aDate 

	^self new initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate ! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 07:55:06' prior: 50872457!
prepareCheckoutFor: aCart payingWith: aCreditCard on: aDate 

	^self basicNew initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate ! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 07:55:15' prior: 50872465!
prepareCheckoutFor: aCart payingWith: aCreditCard on: aDate 

	

	^self basicNew initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate ! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 07:55:17'!
ERROR!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'PhG 11/3/2021 07:55:43'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'PhG 11/3/2021 07:55:43'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList cart creditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'PhG 11/3/2021 07:55:44'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList cart creditCard date'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'initialization' stamp: 'PhG 11/3/2021 07:55:44'!
initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate 
	self shouldBeImplemented.
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.! !
!Cashier methodsFor: 'initialization' stamp: 'PhG 11/3/2021 07:55:51' prior: 50872505!
initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate 
	
	cart := aCart.
	creditCard := aCreditCard.
	date := aDate.! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 07:55:53'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 07:55:53'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 07:55:53'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 07:55:53'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 07:55:53'!
PASSED!
!Cashier methodsFor: 'error messages' stamp: 'PhG 11/3/2021 07:56:14'!
cartCanNotBeEmptyDescription

	^'Cart can not be empty'! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 07:56:14' prior: 50871983!
checkout: aCart

	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmptyDescription].
	
	^aCart totalPrice.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 07:56:14' prior: 50872322!
checkout: aCart withCardExpirationDate: anExpirationDate

	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmptyDescription].
	
	^aCart totalPrice.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 07:56:14' prior: 50872428!
test01checkoutOnEmptyCartThrowsError

	| cart cashier creditCard today |
	
	cart := self createCart.
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self 
		should: [cashier checkout: cart ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = cashier cartCanNotBeEmptyDescription. ]! !

!methodRemoval: Cashier #cartCanNotBeEmpty stamp: 'PhG 11/3/2021 07:56:14'!
cartCanNotBeEmpty

	^'Cart can not be empty'!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/3/2021 07:56:25' prior: 50872542!
checkout: aCart

	
	
	^aCart totalPrice.! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 07:56:36' prior: 50872473!
prepareCheckoutFor: aCart payingWith: aCreditCard on: aDate 

"	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmptyDescription]."

	^self basicNew initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate ! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 07:56:57' prior: 50872557!
test01checkoutOnEmptyCartThrowsError

	| cart cashier creditCard today |
	
	cart := self createCart.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = cashier cartCanNotBeEmptyDescription. ]! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 07:57:12' prior: 50872590!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := self createCart.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyDescription. ]! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 07:57:15'!
FAILURE!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 07:57:34' prior: 50872603!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := self createCart.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier canNotCreateTimeOfDayUsingSemiColonErrorDescription. ]! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 07:57:39' prior: 50872619!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := self createCart.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorDescription. ]! !
!Cashier methodsFor: 'error messages' stamp: 'PhG 11/3/2021 07:57:51'!
cartCanNotBeEmptyErrorDescription

	^'Cart can not be empty'! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 07:57:51' prior: 50872549!
checkout: aCart withCardExpirationDate: anExpirationDate

	(aCart isEmpty) ifTrue: [self error: self cartCanNotBeEmptyErrorDescription].
	
	^aCart totalPrice.! !

!methodRemoval: Cashier #cartCanNotBeEmptyDescription stamp: 'PhG 11/3/2021 07:57:51'!
cartCanNotBeEmptyDescription

	^'Cart can not be empty'!
!Cashier class methodsFor: 'nil' stamp: 'PhG 11/3/2021 07:58:07'!
cartCanNotBeEmptyErrorDescription! !
!Cashier class methodsFor: 'error descriptions' stamp: 'PhG 11/3/2021 07:58:35' prior: 50872663!
cartCanNotBeEmptyErrorDescription

	^'Cart can not be empty'! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 07:59:01' prior: 50872580!
prepareCheckoutFor: aCart payingWith: aCreditCard on: aDate 

	(aCart isEmpty) ifTrue: [self error: Cashier cartCanNotBeEmptyDescription].

	^self basicNew initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate ! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 07:59:21'!
assertCartCanNotBeEmpty: aCart

	^ (aCart isEmpty) ifTrue: [self error: Cashier cartCanNotBeEmptyDescription]! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 07:59:21' prior: 50872673!
prepareCheckoutFor: aCart payingWith: aCreditCard on: aDate 

	self assertCartCanNotBeEmpty: aCart.

	^self basicNew initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate ! !

!methodRemoval: Cashier #cartCanNotBeEmptyErrorDescription stamp: 'PhG 11/3/2021 08:00:03'!
cartCanNotBeEmptyErrorDescription

	^'Cart can not be empty'!

!methodRemoval: Cashier #checkout: stamp: 'PhG 11/3/2021 08:00:18'!
checkout: aCart

	
	
	^aCart totalPrice.!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/3/2021 08:00:26' prior: 50872651!
checkout: aCart withCardExpirationDate: anExpirationDate

	^aCart totalPrice.! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:00:55'!
FAILURE!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:00:55'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:00:55'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:00:55'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:01:03'!
FAILURE!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:01:37'!
FAILURE!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:02:51'!
FAILURE!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:03:02'!
PASSED!
!Cashier class methodsFor: 'assertions' stamp: 'PhG 11/3/2021 08:04:06' prior: 50872683!
assertCartCanNotBeEmpty: aCart

	^ (aCart isEmpty) ifTrue: [self error: Cashier cartCanNotBeEmptyErrorDescription]! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:04:10'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:04:10'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:04:10'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:04:10'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:04:11'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:04:11'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:04:11'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:04:11'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:04:13'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:04:13'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:04:13'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:04:13'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:04:14'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:04:14'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:04:14'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:04:14'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:04:28'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:04:28'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:04:28'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:04:28'!
PASSED!
!CashierTest methodsFor: 'support' stamp: 'PhG 11/3/2021 08:05:42'!
createCreditCardExpiring: anExpirationDate! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/3/2021 08:06:03' prior: 50872818!
createCreditCardExpiring: anExpirationDate

	CreditCard withNumber: '0123456789123456'	 withExpirationDate: anExpirationDate.! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/3/2021 08:06:46'!
currentMonthOfYear

	^GregorianMonthOfYear current.! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/3/2021 08:06:58'!
twoMonthsSince: aMonthOfYear

	^aMonthOfYear previous: (TimeUnits month with: 2).! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/3/2021 08:07:11' prior: 50872834!
twoMonthsSince: aMonthOfYear

	^aMonthOfYear previous: (TimeUnits month with: 2).! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:07:51' prior: 50872633!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := self createCart.
	creditCard := self createCreditCardExpiring: (self ).
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorDescription. ]! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/3/2021 08:08:05'!
twoMonthsFrom: aMonthOfYear

	^aMonthOfYear next: (TimeUnits month with: 2).! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:08:47' prior: 50872846!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := self createCart.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsFrom: today).
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorDescription. ]! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:08:51'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:08:51'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:08:51'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:08:52'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:08:52'!
PASSED!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:09:11' prior: 50871882!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today |
	
	cart := self createCart.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsFrom: today).
	cashier := Cashier new.
	
	cart add: self itemSoldByTheStore.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:09:48' prior: 50872900!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today |
	
	cart := self createCart.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsFrom: today).
	
	cart add: self itemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout: cart)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:10:26' prior: 50872914!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today |
	
	cart := self createCart.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsFrom: today).
	
	cart add: self itemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout: cart).
	! !

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:10:26'!
ERROR!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/3/2021 08:10:38'!
checkout: aCart 
	self shouldBeImplemented.! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/3/2021 08:10:47' prior: 50872949!
checkout: aCart 
	^aCart totalPrice.! !

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:10:48'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:10:48'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:10:48'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:10:48'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:10:48'!
PASSED!

!methodRemoval: Cashier #checkout:withCardExpirationDate: stamp: 'PhG 11/3/2021 08:11:07'!
checkout: aCart withCardExpirationDate: anExpirationDate

	^aCart totalPrice.!
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/3/2021 08:11:33'!
checkout
	^cart totalPrice.! !

!methodRemoval: Cashier #checkout: stamp: 'PhG 11/3/2021 08:11:36'!
checkout: aCart 
	^aCart totalPrice.!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:11:44' prior: 50872930!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today |
	
	cart := self createCart.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsFrom: today).
	
	cart add: self itemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout).
	! !

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:11:45'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:11:45'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:11:45'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:11:45'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:11:45'!
ERROR!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:12:14' prior: 50871892!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

		| cart cashier creditCard today |
	
	cart := self createCart.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsFrom: today).
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 160 equals: (cashier checkout)
	! !

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:12:16'!
ERROR!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:12:49' prior: 50873022!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

		| cart cashier creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsFrom: today).
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 160 equals: (cashier checkout)
	! !

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:12:51'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:12:51'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:12:51'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:12:51'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:12:51'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:12:51'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:13:05'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:13:05'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:13:05'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:13:05'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:13:05'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:13:05'!
ERROR!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:13:29' prior: 50871905!
test04checkoutWithExpiredCreditCardIsRejected

	| cart cashier today expiredDate |
	
	cart := self createCartWith: self priceListwithTwoItems.
	cashier := Cashier new.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	today := FixedGregorianDate today.
	
	expiredDate := today previous: (TimeUnits month with: 1).
	
	self assert: 160 equals: (cashier checkout: cart withCardExpirationDate: expiredDate)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:13:40' prior: 50873043!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsFrom: today).
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 160 equals: (cashier checkout)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:13:56' prior: 50873105!
test04checkoutWithExpiredCreditCardIsRejected

	| cart cashier creditCard today expiredDate |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsSince: today).
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 160 equals: (cashier checkout: cart withCardExpirationDate: expiredDate)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:14:19' prior: 50873140!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsSince: today).
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorDescription. ]
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:14:34' prior: 50873160!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := self currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (self twoMonthsSince: today).
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardCanNotBeExpiredErrorDescription. ]
	! !

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:14:36'!
FAILURE!
!Cashier class methodsFor: 'error descriptions' stamp: 'PhG 11/3/2021 08:15:08'!
creditCardCanNotBeExpiredErrorDescription

	^'Credit card can not be expired'! !

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:15:14'!
FAILURE!
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 08:15:54' prior: 50872690!
prepareCheckoutFor: aCart payingWith: aCreditCard on: aDate 

	self assertCartCanNotBeEmpty: aCart.
	(aCreditCard isExpiredOn: aDate) ifTrue: [self error: Cashier creditCardCanNotBeExpiredErrorDescription ].

	^self basicNew initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate ! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 08:16:45'!
assertCreditCard: aDate isNotExpiredOn: aCreditCard

	^ (aCreditCard isExpiredOn: aDate) ifTrue: [self error: Cashier creditCardCanNotBeExpiredErrorDescription ]! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 08:16:45' prior: 50873214!
prepareCheckoutFor: aCart payingWith: aCreditCard on: aDate 

	self assertCartCanNotBeEmpty: aCart.
	self assertCreditCard: aDate isNotExpiredOn: aCreditCard.

	^self basicNew initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate ! !
!Cashier class methodsFor: 'instance creation' stamp: 'PhG 11/3/2021 08:17:04' prior: 50873235!
prepareCheckoutFor: aCart payingWith: aCreditCard on: aDate 

	self assertCartCanNotBeEmpty: aCart.
	self assertCreditCard: aCreditCard isNotExpiredOn: aDate.

	^self basicNew initializeCheckingOutFor: aCart payingWith: aCreditCard on: aDate ! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:17:12'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:17:12'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:17:12'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:17:12'!
FAILURE!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:17:21'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:17:21'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:17:21'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:17:21'!
FAILURE!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:17:24'!
ERROR!
!Cashier class methodsFor: 'assertions' stamp: 'PhG 11/3/2021 08:17:42' prior: 50873226!
assertCreditCard: aCreditCard isNotExpiredOn: aDate

	^ (aCreditCard isExpiredOn: aDate) ifTrue: [self error: Cashier creditCardCanNotBeExpiredErrorDescription ]! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:17:46'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:17:46'!
ERROR!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:17:46'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:17:46'!
FAILURE!
!CashierTest methodsFor: 'support' stamp: 'PhG 11/3/2021 08:19:16' prior: 50872823!
createCreditCardExpiring: anExpirationDate

	^CreditCard withNumber: '0123456789123456'	 withExpirationDate: anExpirationDate.! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:19:20'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:19:20'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:19:20'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:19:20'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CartTest #test11TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/3/2021 08:19:27'!
PASSED!

Object subclass: #TestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TestObjectsFactory category: 'TusLibros' stamp: 'PhG 11/3/2021 08:21:37'!
Object subclass: #TestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TestObjectsFactory methodsFor: 'nil' stamp: 'PhG 11/3/2021 08:21:50'!
currentMonthOfYear

	^GregorianMonthOfYear current.! !

TestCase subclass: #CreditCardTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'PhG 11/3/2021 08:23:52'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCardTest methodsFor: 'nil' stamp: 'PhG 11/3/2021 08:24:29' overrides: 16896425!
initialize
	factory := TestObjectsFactory new.! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:24:55' prior: 50871847!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard currentMonthOfYear twoMonthsToTheFuture |
	
	currentMonthOfYear := factory currentMonthOfYear .
	twoMonthsToTheFuture := self twoMonthsFrom: currentMonthOfYear.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToTheFuture.
	
	self deny: (creditCard isExpiredOn: currentMonthOfYear).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:24:56' prior: 50873435!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard currentMonthOfYear twoMonthsToTheFuture |
	
	currentMonthOfYear := factory currentMonthOfYear.
	twoMonthsToTheFuture := self twoMonthsFrom: currentMonthOfYear.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToTheFuture.
	
	self deny: (creditCard isExpiredOn: currentMonthOfYear).! !

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:24:57'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:24:57'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:24:57'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:24:57'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/3/2021 08:24:57'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/3/2021 08:24:57'!
PASSED!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:25:07' prior: 50873451!
test03CreditCardWithExpirationDateInTheFutureIsNotExpired

	| creditCard currentMonthOfYear twoMonthsToTheFuture |
	
	currentMonthOfYear := factory currentMonthOfYear.
	twoMonthsToTheFuture := factory twoMonthsFrom: currentMonthOfYear.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToTheFuture.
	
	self deny: (creditCard isExpiredOn: currentMonthOfYear).! !

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:25:09'!
ERROR!
!TestObjectsFactory methodsFor: 'date' stamp: 'PhG 11/3/2021 08:25:21'!
twoMonthsFrom: aMonthOfYear

	^aMonthOfYear next: (TimeUnits month with: 2).! !
!TestObjectsFactory methodsFor: 'date' stamp: 'PhG 11/3/2021 08:25:32'!
twoMonthsSince: aMonthOfYear

	^aMonthOfYear previous: (TimeUnits month with: 2).! !
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:25:51' prior: 50871602!
test04CreditCardWithExpirationDateInThePastIsExpired

	| creditCard currentMonthOfYear twoMonthsToThePast |
	
	currentMonthOfYear := factory currentMonthOfYear.
	twoMonthsToThePast := factory twoMonthsSince: currentMonthOfYear.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: twoMonthsToThePast.
	
	self assert: (creditCard isExpiredOn: currentMonthOfYear).! !

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/3/2021 08:25:53'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:25:53'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:25:53'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:25:53'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/3/2021 08:25:53'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/3/2021 08:25:53'!
PASSED!
!CreditCardTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:25:57' prior: 50871589!
test05CreditCardWithExpirationDateInThePresentIsNotExpired

	| creditCard currentMonthOfYear |
	
	currentMonthOfYear := factory currentMonthOfYear.

	creditCard := CreditCard withNumber: '0123456789123456'	 withExpirationDate: currentMonthOfYear.
	
	self assert: (creditCard isExpiredOn: currentMonthOfYear).! !

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/3/2021 08:25:58'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:25:58'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:25:58'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:25:58'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/3/2021 08:25:58'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/3/2021 08:25:58'!
PASSED!

!methodRemoval: CreditCardTest #currentMonthOfYear stamp: 'PhG 11/3/2021 08:26:08'!
currentMonthOfYear

	^GregorianMonthOfYear current.!

!methodRemoval: CreditCardTest #twoMonthsFrom: stamp: 'PhG 11/3/2021 08:26:08'!
twoMonthsFrom: aMonthOfYear

	^aMonthOfYear next: (TimeUnits month with: 2).!

!methodRemoval: CreditCardTest #twoMonthsSince: stamp: 'PhG 11/3/2021 08:26:08'!
twoMonthsSince: aMonthOfYear

	^aMonthOfYear previous: (TimeUnits month with: 2).!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:26:14'!
ERROR!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:26:14'!
ERROR!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:26:14'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/3/2021 08:26:14'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/3/2021 08:26:14'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:26:26'!
ERROR!
!CreditCardTest methodsFor: 'assertions' stamp: 'PhG 11/3/2021 08:26:45' prior: 50871742!
assertCreditCardMustContain16DigitsForCardNumber: aCardNumber

	| twoMonthsToTheFuture |

	twoMonthsToTheFuture := factory twoMonthsFrom: factory currentMonthOfYear.
	
	self 
		should: [CreditCard withNumber: aCardNumber withExpirationDate: twoMonthsToTheFuture ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = CreditCard creditCardMustContain16Digits. ]! !

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:26:46'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:26:46'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:26:46'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/3/2021 08:26:46'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/3/2021 08:26:46'!
PASSED!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'PhG 11/3/2021 08:27:37'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CashierTest methodsFor: 'nil' stamp: 'PhG 11/3/2021 08:27:35' overrides: 16896425!
initialize

	factory := TestObjectsFactory new.! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:27:57' prior: 50872866!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := self createCart.
	today := factory currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (factory twoMonthsFrom: today).
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorDescription. ]! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:28:10' prior: 50872988!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today |
	
	cart := self createCart.
	today := factory currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (factory twoMonthsFrom: today).
	
	cart add: self itemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout).
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:28:15' prior: 50873122!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (factory twoMonthsFrom: today).
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 160 equals: (cashier checkout)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:28:19' prior: 50873180!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := self createCreditCardExpiring: (factory twoMonthsSince: today).
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardCanNotBeExpiredErrorDescription. ]
	! !

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:28:20'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:28:20'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:28:20'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:28:20'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:28:20'!
PASSED!
!TestObjectsFactory methodsFor: 'nil' stamp: 'PhG 11/3/2021 08:29:55'!
createCreditCardExpiringTwoMonthsFrom: anExpirationDate

	^self createCreditCardExpiring: (self twoMonthsSince: anExpirationDate).! !
!TestObjectsFactory methodsFor: 'credit card' stamp: 'PhG 11/3/2021 08:30:16'!
createCreditCardExpiring: anExpirationDate

	^CreditCard withNumber: '0123456789123456'	 withExpirationDate: anExpirationDate.! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:30:40' prior: 50873681!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := self createCart.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorDescription. ]! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:30:53' prior: 50873698!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today |
	
	cart := self createCart.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	cart add: self itemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout).
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:30:58' prior: 50873714!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 160 equals: (cashier checkout)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:31:06' prior: 50873732!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsSince: today.
	
	cart add: self itemSoldByTheStore.
	cart add: self otherItemSoldByTheStore.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardCanNotBeExpiredErrorDescription. ]
	! !
!TestObjectsFactory methodsFor: 'credit card' stamp: 'PhG 11/3/2021 08:31:17'!
createCreditCardExpiringTwoMonthsSince: anExpirationDate

	^self createCreditCardExpiring: (self twoMonthsSince: anExpirationDate).! !
!TestObjectsFactory methodsFor: 'credit card' stamp: 'PhG 11/3/2021 08:31:22' prior: 50873770!
createCreditCardExpiringTwoMonthsFrom: anExpirationDate

	^self createCreditCardExpiring: (self twoMonthsFrom: anExpirationDate).! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:31:41'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:31:41'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:31:41'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:31:41'!
PASSED!

!methodRemoval: CashierTest #createCreditCardExpiring: stamp: 'PhG 11/3/2021 08:31:58'!
createCreditCardExpiring: anExpirationDate

	^CreditCard withNumber: '0123456789123456'	 withExpirationDate: anExpirationDate.!

!methodRemoval: CashierTest #currentMonthOfYear stamp: 'PhG 11/3/2021 08:32:00'!
currentMonthOfYear

	^GregorianMonthOfYear current.!

!methodRemoval: CashierTest #twoMonthsFrom: stamp: 'PhG 11/3/2021 08:32:05'!
twoMonthsFrom: aMonthOfYear

	^aMonthOfYear next: (TimeUnits month with: 2).!

!methodRemoval: CashierTest #twoMonthsSince: stamp: 'PhG 11/3/2021 08:32:07'!
twoMonthsSince: aMonthOfYear

	^aMonthOfYear previous: (TimeUnits month with: 2).!
!TestObjectsFactory methodsFor: 'nil' stamp: 'PhG 11/3/2021 08:32:23'!
priceListwithTwoItems

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSoldByTheStore)-> 100.
	priceList add: (self otherItemSoldByTheStore)-> 60.
	^priceList.! !
!TestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/3/2021 08:32:50'!
defaultPriceList

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSoldByTheStore)-> 100.
	^priceList.! !
!TestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/3/2021 08:33:01'!
itemSoldByTheStore
	
	^ 'validBook'! !
!TestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/3/2021 08:33:11'!
otherItemSoldByTheStore
	
	^ 'otherValidBook'! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:33:24' prior: 50873801!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today |
	
	cart := self createCart.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	cart add: factory itemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout).
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:33:32' prior: 50873817!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	cart add: factory itemSoldByTheStore.
	cart add: factory otherItemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 160 equals: (cashier checkout)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:33:39' prior: 50873835!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsSince: today.
	
	cart add: factory itemSoldByTheStore.
	cart add: factory otherItemSoldByTheStore.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardCanNotBeExpiredErrorDescription. ]
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:34:27' prior: 50873964!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := self createCartWith: self priceListwithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsSince: today.
	
	cart add: factory itemSoldByTheStore.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardCanNotBeExpiredErrorDescription. ]
	! !
!TestObjectsFactory methodsFor: 'nil' stamp: 'PhG 11/3/2021 08:35:12'!
createCart
	
	^Cart acceptingItemsOf: self defaultPriceList! !
!CartTest methodsFor: 'support' stamp: 'PhG 11/3/2021 08:35:38'!
createCartWithDefaultPriceList
	
	^Cart acceptingItemsOf: self defaultPriceList! !
!TestObjectsFactory methodsFor: 'cart' stamp: 'PhG 11/3/2021 08:35:38'!
createCartWithDefaultPriceList
	
	^Cart acceptingItemsOf: self defaultPriceList! !
!CashierTest methodsFor: 'support' stamp: 'PhG 11/3/2021 08:35:38'!
createCartWithDefaultPriceList
	
	^Cart acceptingItemsOf: self defaultPriceList! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:38' prior: 50870619!
test06CartRemembersAddedItems

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	cart add: self itemSoldByTheStore.
	self assert: (cart includes: self itemSoldByTheStore)! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50870014!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	self 
		should: [cart add: 2 of: self itemNotSellByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50870703!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	cart add: self itemSoldByTheStore.
	self deny: cart isEmpty ! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50873930!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today |
	
	cart := self createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	cart add: factory itemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout).
	! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50869994!
test01NewCartsAreCreatedEmpty

	self assert: self createCartWithDefaultPriceList isEmpty! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50873784!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := self createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorDescription. ]! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50870610!
test08CartRemembersTheNumberOfAddedItems

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	cart add: 2 of: self itemSoldByTheStore.
	self assert: (cart occurrencesOf: self itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50872188!
test11TotalPriceOfCartWithItemsIsAddedItemsPrice

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	cart add: 2 of: self itemSoldByTheStore.
	self assert: (cart totalPrice ) = 200.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50872027!
test09TotalPriceOfEmptyCartIsZero

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	self assert: (cart totalPrice ) = 0.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50870695!
test07CartDoesNotHoldNotAddedItems

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	self deny: (cart includes: self itemSoldByTheStore)! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50872088!
test10TotalPriceOfCartWithItemIsItemPrice

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	cart add: 1 of: self itemSoldByTheStore.
	self assert: (cart totalPrice ) = 100.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50870633!
test04CanNotAddNonPositiveNumberOfItems

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	self 
		should: [cart add: 0 of: self itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:35:39' prior: 50869972!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	self 
		should: [ cart add: self itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !

!methodRemoval: CartTest #createCart stamp: 'PhG 11/3/2021 08:35:39'!
createCart
	
	^Cart acceptingItemsOf: self defaultPriceList!

!methodRemoval: TestObjectsFactory #createCart stamp: 'PhG 11/3/2021 08:35:39'!
createCart
	
	^Cart acceptingItemsOf: self defaultPriceList!

!methodRemoval: CashierTest #createCart stamp: 'PhG 11/3/2021 08:35:39'!
createCart
	
	^Cart acceptingItemsOf: self defaultPriceList!
!TestObjectsFactory methodsFor: 'cart' stamp: 'PhG 11/3/2021 08:35:53'!
createCartWith: aPriceList
	
	^Cart acceptingItemsOf: aPriceList! !
!TestObjectsFactory methodsFor: 'cart' stamp: 'PhG 11/3/2021 08:36:13' prior: 50874013!
createCartWithDefaultPriceList
	
	^self createCartWith: self defaultPriceList! !

!methodRemoval: CashierTest #createCartWithDefaultPriceList stamp: 'PhG 11/3/2021 08:36:26'!
createCartWithDefaultPriceList
	
	^Cart acceptingItemsOf: self defaultPriceList!

!methodRemoval: CashierTest #defaultPriceList stamp: 'PhG 11/3/2021 08:36:59'!
defaultPriceList

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSoldByTheStore)-> 100.
	^priceList.!

!methodRemoval: CashierTest #itemSoldByTheStore stamp: 'PhG 11/3/2021 08:37:02'!
itemSoldByTheStore
	
	^ 'validBook'!

!methodRemoval: CashierTest #otherItemSoldByTheStore stamp: 'PhG 11/3/2021 08:37:04'!
otherItemSoldByTheStore
	
	^ 'otherValidBook'!

!methodRemoval: CashierTest #priceListwithTwoItems stamp: 'PhG 11/3/2021 08:37:15'!
priceListwithTwoItems

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSoldByTheStore)-> 100.
	priceList add: (self otherItemSoldByTheStore)-> 60.
	^priceList.!

!methodRemoval: CashierTest #createCartWith: stamp: 'PhG 11/3/2021 08:37:21'!
createCartWith: aPriceList
	
	^Cart acceptingItemsOf: aPriceList!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:37:31' prior: 50874079!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorDescription. ]! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:37:34' prior: 50874056!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	cart add: factory itemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout).
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:37:49' prior: 50873946!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier creditCard today |
	
	cart := factory createCartWithPriceListWithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	cart add: factory itemSoldByTheStore.
	cart add: factory otherItemSoldByTheStore.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 160 equals: (cashier checkout)
	! !
!TestObjectsFactory methodsFor: 'cart' stamp: 'PhG 11/3/2021 08:38:01'!
createCartWithPriceListWithTwoItems
	
	^self createCartWith: self priceListwithTwoItems ! !
!TestObjectsFactory methodsFor: 'cart' stamp: 'PhG 11/3/2021 08:38:04' prior: 50874276!
createCartWithPriceListWithTwoItems
	
	^self createCartWith: self priceListwithTwoItems.! !

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:38:07'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:38:07'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:38:07'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:38:07'!
ERROR!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:38:07'!
ERROR!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:38:19' prior: 50873985!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := self createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsSince: today.
	
	cart add: factory itemSoldByTheStore.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardCanNotBeExpiredErrorDescription. ]
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:38:22' prior: 50874306!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsSince: today.
	
	cart add: factory itemSoldByTheStore.
	
	self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardCanNotBeExpiredErrorDescription. ]
	! !

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:38:24'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:38:31'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:38:31'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:38:31'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:38:31'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:38:33'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:38:33'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:38:33'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/3/2021 08:38:33'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/3/2021 08:38:33'!
PASSED!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:39:06' prior: 50874241!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today product |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	product := factory itemSoldByTheStore.
	
	cart add: product.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout).
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:39:09' prior: 50874382!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today item |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	item := factory itemSoldByTheStore.
	
	cart add: item.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: 100 equals: (cashier checkout).
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:39:18' prior: 50874399!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier creditCard today item |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	item := factory itemSoldByTheStore.
	
	cart add: item.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: (factory priceOf: item) equals: (cashier checkout).
	! !

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:39:20'!
ERROR!
!TestObjectsFactory methodsFor: 'price list' stamp: 'PhG 11/3/2021 08:39:39'!
priceOf: aString 
	self shouldBeImplemented.! !
!TestObjectsFactory methodsFor: 'price list' stamp: 'PhG 11/3/2021 08:40:23' prior: 50874437!
priceOf: anItem 
	^self priceListwithTwoItems at: anItem.! !

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:40:24'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:40:24'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:40:24'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:40:24'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:40:24'!
PASSED!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:41:11' prior: 50874258!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier creditCard today item otherItem |
	
	cart := factory createCartWithPriceListWithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	item := factory itemSoldByTheStore.
	otherItem := factory otherItemSoldByTheStore.

	cart add: item.
	cart add: otherItem.
	
	cashier := Cashier prepareCheckoutFor: cart payingWith: creditCard on: today.
	
	self assert: (factory priceOf: item) + (factory priceOf: otherItem) equals: (cashier checkout)
	! !
!CashierTest methodsFor: 'nil' stamp: 'PhG 11/3/2021 08:42:20'!
cashierCheckingOutFor: aCart! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:43:04'!
cashierCheckingOutWithValidCardFor: aCart! !

!methodRemoval: CashierTest #cashierCheckingOutFor: stamp: 'PhG 11/3/2021 08:43:07'!
cashierCheckingOutFor: aCart!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:43:23' prior: 50874490!
cashierCheckingOutWithValidCardFor: aCart

	| creditCard today |
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:43:28' prior: 50874499!
cashierCheckingOutWithValidCardFor: aCart

	| creditCard today |
	
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/3/2021 08:43:48' prior: 50874508!
cashierCheckingOutWithValidCardFor: aCart

	| creditCard today |
	
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	^Cashier prepareCheckoutFor: aCart payingWith: creditCard on: today.! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:44:23' prior: 50874416!
test02checkoutTotalOnCartWithOneProductIsProductPrice

	| cart cashier item |
	
	cart := factory createCartWithDefaultPriceList.
	item := factory itemSoldByTheStore.
	
	cart add: item.
	
	cashier := self cashierCheckingOutWithValidCardFor: cart.
	
	self assert: (factory priceOf: item) equals: (cashier checkout).
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:44:45' prior: 50874465!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier creditCard today item otherItem |
	
	cart := factory createCartWithPriceListWithTwoItems.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	item := factory itemSoldByTheStore.
	otherItem := factory otherItemSoldByTheStore.

	cart add: item.
	cart add: otherItem.
	
	cashier := self cashierCheckingOutWithValidCardFor: cart.
	
	self assert: (factory priceOf: item) + (factory priceOf: otherItem) equals: (cashier checkout)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:44:53' prior: 50874541!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier item otherItem |
	
	cart := factory createCartWithPriceListWithTwoItems.
	
	item := factory itemSoldByTheStore.
	otherItem := factory otherItemSoldByTheStore.

	cart add: item.
	cart add: otherItem.
	
	cashier := self cashierCheckingOutWithValidCardFor: cart.
	
	self assert: (factory priceOf: item) + (factory priceOf: otherItem) equals: (cashier checkout)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:45:01' prior: 50874562!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier item otherItem |
	
	cart := factory createCartWithPriceListWithTwoItems.
	item := factory itemSoldByTheStore.
	otherItem := factory otherItemSoldByTheStore.

	cart add: item.
	cart add: otherItem.
	
	cashier := self cashierCheckingOutWithValidCardFor: cart.
	
	self assert: (factory priceOf: item) + (factory priceOf: otherItem) equals: (cashier checkout)
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:45:06' prior: 50874579!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier item otherItem |
	
	cart := factory createCartWithPriceListWithTwoItems.
	item := factory itemSoldByTheStore.
	otherItem := factory otherItemSoldByTheStore.

	cart add: item.
	cart add: otherItem.
	
	cashier := self cashierCheckingOutWithValidCardFor: cart.
	
	self assert: (factory priceOf: item) + (factory priceOf: otherItem) equals: (cashier checkout)! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:45:07' prior: 50874596!
test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum

	| cart cashier item otherItem |
	
	cart := factory createCartWithPriceListWithTwoItems.
	item := factory itemSoldByTheStore.
	otherItem := factory otherItemSoldByTheStore.

	cart add: item.
	cart add: otherItem.
	
	cashier := self cashierCheckingOutWithValidCardFor: cart.
	
	self assert: (factory priceOf: item) + (factory priceOf: otherItem) equals: (cashier checkout).! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:46:43'!
assertCheckingOut: creditCard payingWith: today onDate: cart

	^ self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardCanNotBeExpiredErrorDescription. ]! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:46:43' prior: 50874325!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsSince: today.
	
	cart add: factory itemSoldByTheStore.
	
	self assertCheckingOut: creditCard payingWith: today onDate: cart
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:47:07'!
assertCheckingOut: creditCard payingWith: today onDate: cart willFailWith: anErrorDescription

	^ self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = anErrorDescription. ]! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:47:17' prior: 50874641!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsSince: today.
	
	cart add: factory itemSoldByTheStore.
	
	self assertCheckingOut: creditCard payingWith: today onDate: cart willFailWith: Cashier creditCardCanNotBeExpiredErrorDescription.
	! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:47:21' prior: 50874668!
test04checkoutWithExpiredCreditCardIsRejected

	| cart creditCard today |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsSince: today.
	
	cart add: factory itemSoldByTheStore.
	
	self assertCheckingOut: creditCard payingWith: today onDate: cart willFailWith: (Cashier creditCardCanNotBeExpiredErrorDescription).
	! !

!methodRemoval: CashierTest #assertCheckingOut:payingWith:onDate: stamp: 'PhG 11/3/2021 08:47:24'!
assertCheckingOut: creditCard payingWith: today onDate: cart

	^ self 
		should: [ Cashier prepareCheckoutFor: cart payingWith: creditCard on: today ]
		raise: Error
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardCanNotBeExpiredErrorDescription. ]!
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:47:55' prior: 50874224!
test01checkoutOnEmptyCartThrowsError

	| cart creditCard today |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	creditCard := factory createCreditCardExpiringTwoMonthsFrom: today.
	
	self assertCheckingOut: creditCard payingWith: today onDate: cart willFailWith: (Cashier cartCanNotBeEmptyErrorDescription).! !
!CashierTest methodsFor: 'checkout tests' stamp: 'PhG 11/3/2021 08:48:07' prior: 50874684!
test04checkoutWithExpiredCreditCardIsRejected

	| cart expiredCreditCard today |
	
	cart := factory createCartWithDefaultPriceList.
	today := factory currentMonthOfYear.
	expiredCreditCard := factory createCreditCardExpiringTwoMonthsSince: today.
	
	cart add: factory itemSoldByTheStore.
	
	self assertCheckingOut: expiredCreditCard payingWith: today onDate: cart willFailWith: (Cashier creditCardCanNotBeExpiredErrorDescription).
	! !

!methodRemoval: CartTest #defaultCatalog stamp: 'PhG 11/3/2021 08:50:06'!
defaultCatalog
	
	^ Array with: self itemSoldByTheStore!

!classDefinition: #CartTest category: 'TusLibros' stamp: 'PhG 11/3/2021 08:50:22'!
TestCase subclass: #CartTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:50:20' prior: 50874073!
test01NewCartsAreCreatedEmpty

	self assert: factory createCartWithDefaultPriceList isEmpty! !
!CartTest methodsFor: 'nil' stamp: 'PhG 11/3/2021 08:50:34' overrides: 16896425!
initialize
	
	factory := TestObjectsFactory new.! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:50:49' prior: 50874154!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	self 
		should: [ cart add: self itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:50:57' prior: 50874764!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	self 
		should: [ cart add: factory itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!TestObjectsFactory methodsFor: 'item' stamp: 'PhG 11/3/2021 08:51:19'!
itemNotSoldByTheStore
	
	^'invalidBook'! !

!methodRemoval: CartTest #itemSoldByTheStore stamp: 'PhG 11/3/2021 08:51:24'!
itemSoldByTheStore
	
	^ 'validBook'!

!methodRemoval: CartTest #itemNotSellByTheStore stamp: 'PhG 11/3/2021 08:51:27'!
itemNotSellByTheStore
	
	^'invalidBook'!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:51:35' prior: 50874777!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	self 
		should: [ cart add: factory itemNotSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:51:42' prior: 50874047!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	cart add: factory itemSoldByTheStore.
	self deny: cart isEmpty ! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:51:46' prior: 50874140!
test04CanNotAddNonPositiveNumberOfItems

	| cart |
	
	cart := self createCartWithDefaultPriceList.
	
	self 
		should: [cart add: 0 of: factory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:51:49' prior: 50874825!
test04CanNotAddNonPositiveNumberOfItems

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	self 
		should: [cart add: 0 of: factory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:51:56' prior: 50874033!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	self 
		should: [cart add: 2 of: factory itemNotSellByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:52:03' prior: 50874024!
test06CartRemembersAddedItems

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	cart add: factory itemSoldByTheStore.
	self assert: (cart includes: factory itemSoldByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:52:08' prior: 50874123!
test07CartDoesNotHoldNotAddedItems

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	self deny: (cart includes: factory itemSoldByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:52:14' prior: 50874096!
test08CartRemembersTheNumberOfAddedItems

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	cart add: 2 of: factory itemSoldByTheStore.
	self assert: (cart occurrencesOf: factory itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:52:17' prior: 50874115!
test09TotalPriceOfEmptyCartIsZero

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	self assert: (cart totalPrice ) = 0.! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:52:22' prior: 50874131!
test10TotalPriceOfCartWithItemIsItemPrice

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	cart add: 1 of: factory itemSoldByTheStore.
	self assert: (cart totalPrice) = 100.! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:52:25' prior: 50874894!
test09TotalPriceOfEmptyCartIsZero

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	self assert: (cart totalPrice) = 0.! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:52:48' prior: 50874901!
test10TotalPriceOfCartWithItemIsItemPrice

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	cart add: 1 of: factory itemSoldByTheStore.
	self assert: (cart totalPrice) = (factory priceOf: factory itemSoldByTheStore).! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:53:15' prior: 50874106!
test11TotalPriceOfCartWithItemsIsAddedItemsPrice

	| cart item |
	
	cart := factory createCartWithDefaultPriceList.
	item := factory itemSoldByTheStore.
	cart add: 2 of: item.
	self assert: (cart totalPrice ) = (factory priceOf: item).! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:53:18' prior: 50874927!
test11TotalPriceOfCartWithItemsIsAddedItemsPrice

	| cart item |
	
	cart := factory createCartWithDefaultPriceList.
	item := factory itemSoldByTheStore.

	cart add: 2 of: item.

	self assert: (cart totalPrice ) = (factory priceOf: item).! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:53:33' prior: 50874917!
test10TotalPriceOfCartWithItemIsItemPrice

	| cart item |
	
	cart := factory createCartWithDefaultPriceList.
	
	cart add: 1 of: factory itemSoldByTheStore.

	self assert: (cart totalPrice ) = (factory priceOf: item).! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:53:44' prior: 50874947!
test10TotalPriceOfCartWithItemIsItemPrice

	| cart item |
	
	cart := factory createCartWithDefaultPriceList.
	item := 	factory itemSoldByTheStore.

	cart add: 1 of: item.

	self assert: (cart totalPrice ) = (factory priceOf: item).! !

!methodRemoval: CartTest #createCartWithDefaultPriceList stamp: 'PhG 11/3/2021 08:53:49'!
createCartWithDefaultPriceList
	
	^Cart acceptingItemsOf: self defaultPriceList!

!methodRemoval: CartTest #defaultPriceList stamp: 'PhG 11/3/2021 08:53:50'!
defaultPriceList

	| priceList |
	
	priceList := Dictionary new.
	priceList add: (self itemSoldByTheStore)-> 100.
	^priceList.!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/3/2021 08:53:53'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/3/2021 08:53:53'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/3/2021 08:53:53'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/3/2021 08:53:53'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/3/2021 08:53:53'!
ERROR!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/3/2021 08:53:53'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/3/2021 08:53:53'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/3/2021 08:53:53'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/3/2021 08:53:53'!
PASSED!

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/3/2021 08:53:53'!
PASSED!

!testRun: #CartTest #test11TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/3/2021 08:53:53'!
FAILURE!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:53:58' prior: 50874853!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |
	
	cart := factory createCartWithDefaultPriceList.
	
	self 
		should: [cart add: 2 of: factory itemNotSoldByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/3/2021 08:54:01'!
PASSED!

!testRun: #CartTest #test11TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/3/2021 08:54:01'!
FAILURE!

!testRun: #CartTest #test11TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/3/2021 08:54:01'!
FAILURE!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/3/2021 08:54:21' prior: 50874937!
test11TotalPriceOfCartWithItemsIsAddedItemsPrice

	| cart item |
	
	cart := factory createCartWithDefaultPriceList.
	item := factory itemSoldByTheStore.

	cart add: 2 of: item.

	self assert: (cart totalPrice ) = ((factory priceOf: item)*2).! !

!testRun: #CartTest #test11TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/3/2021 08:54:23'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test09TotalPriceOfEmptyCartIsZero stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test10TotalPriceOfCartWithItemIsItemPrice stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CartTest #test11TotalPriceOfCartWithItemsIsAddedItemsPrice stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CashierTest #test01checkoutOnEmptyCartThrowsError stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CashierTest #test02checkoutTotalOnCartWithOneProductIsProductPrice stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CashierTest #test03checkoutTotalOnCartWithManyProductsIsProductsPriceSum stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CashierTest #test04checkoutWithExpiredCreditCardIsRejected stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardWithLessThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardWithMoreThan16DigitsCanNotBeInstantiated stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardWithExpirationDateInTheFutureIsNotExpired stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CreditCardTest #test04CreditCardWithExpirationDateInThePastIsExpired stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

!testRun: #CreditCardTest #test05CreditCardWithExpirationDateInThePresentIsNotExpired stamp: 'PhG 11/3/2021 08:54:25'!
PASSED!

----QUIT----(3 November 2021 08:59:54) CuisUniversity-4532.image priorSource: 17304625!

----STARTUP---- (4 November 2021 12:20:40) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!classRemoval: #TestObjectsFactory stamp: 'PhG 11/4/2021 12:20:45'!
Object subclass: #TestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'PhG 11/4/2021 12:20:45'!
Object subclass: #CreditCard
	instanceVariableNames: 'cardNumber expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'PhG 11/4/2021 12:20:45'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList cart creditCard date'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'PhG 11/4/2021 12:20:46'!
Object subclass: #Cart
	instanceVariableNames: 'priceList items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCardTest stamp: 'PhG 11/4/2021 12:20:46'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'PhG 11/4/2021 12:20:46'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'PhG 11/4/2021 12:20:46'!
TestCase subclass: #CartTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/iteracion2/TusLibros.st----!

----QUIT----(4 November 2021 12:21:26) CuisUniversity-4532.image priorSource: 17391987!

----STARTUP---- (4 November 2021 17:04:24) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!classRemoval: #TestObjectsFactory stamp: 'PhG 11/4/2021 17:20:51'!
Object subclass: #TestObjectsFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #MerchantProcessorDouble stamp: 'PhG 11/4/2021 17:20:52'!
Object subclass: #MerchantProcessorDouble
	instanceVariableNames: 'whenBilling'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'PhG 11/4/2021 17:20:52'!
Object subclass: #CreditCard
	instanceVariableNames: 'cardNumber expirationDate'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'PhG 11/4/2021 17:20:52'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList cart creditCard date merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'PhG 11/4/2021 17:20:53'!
Object subclass: #Cart
	instanceVariableNames: 'priceList items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCardTest stamp: 'PhG 11/4/2021 17:20:53'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'PhG 11/4/2021 17:20:53'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'PhG 11/4/2021 17:20:54'!
TestCase subclass: #CartTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/iteracion3/TusLibros.st----!

----QUIT----(4 November 2021 18:45:13) CuisUniversity-4532.image priorSource: 17418159!

----STARTUP---- (4 November 2021 19:21:34) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!classRemoval: #StoreTestObjectsFactory stamp: 'PhG 11/4/2021 19:27:32'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Sale stamp: 'PhG 11/4/2021 19:27:32'!
Object subclass: #Sale
	instanceVariableNames: 'total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'PhG 11/4/2021 19:27:32'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'PhG 11/4/2021 19:27:33'!
Object subclass: #Cashier
	instanceVariableNames: 'cart salesBook merchantProcessor creditCard total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'PhG 11/4/2021 19:27:33'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'PhG 11/4/2021 19:27:33'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'PhG 11/4/2021 19:27:34'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/iteracion3/Iteracion2/TusLibros-33.st----!

TestCase subclass: #StoreServiceTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreServiceTest category: 'TusLibros' stamp: 'PhG 11/4/2021 19:55:14'!
TestCase subclass: #StoreServiceTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/4/2021 19:56:54'!
Object subclass: #StoreService
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreServiceTest methodsFor: 'nil' stamp: 'PhG 11/4/2021 19:56:49'!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService new.
	
	self should: [ storeService createCartFor: testObjectsFactory invalidUser with: testObjectsFactory invalidPassword].! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 19:59:25' prior: 50877208!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService new.
	
	self should: [ storeService createCartFor: testObjectsFactory invalidUser with: testObjectsFactory invalidPassword]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 19:59:32' prior: 50877219!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService new.
	
	self should: [ storeService createCartFor: testObjectsFactory invalidUser with: testObjectsFactory invalidPassword]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 19:59:36' prior: 50877235!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService new.
	
	self should: [ storeService createCartFor: testObjectsFactory invalidUser with: testObjectsFactory invalidPassword]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 19:59:38'!
ERROR!
!StoreService class methodsFor: 'error descriptions' stamp: 'PhG 11/4/2021 20:00:48'!
invalidCredentialsErrorDesciption
	self shouldBeImplemented.! !
!StoreService class methodsFor: 'error descriptions' stamp: 'PhG 11/4/2021 20:02:23' prior: 50877269!
invalidCredentialsErrorDesciption
	^'Username or password invalid'! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:02:28'!
FAILURE!
!StoreService class methodsFor: 'error descriptions' stamp: 'PhG 11/4/2021 20:06:40' prior: 50877275!
invalidCredentialsErrorDesciption
	^'Username or password invalid'! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:07:11'!
FAILURE!
!StoreTestObjectsFactory methodsFor: 'nil' stamp: 'PhG 11/4/2021 20:07:46'!
invalidUser
	^'invalidUser'! !
!StoreTestObjectsFactory methodsFor: 'users' stamp: 'PhG 11/4/2021 20:08:05'!
invalidPassword
	^'invalidPassword'! !
!StoreService methodsFor: 'nil' stamp: 'PhG 11/4/2021 20:09:17'!
createCartFor: aUsername with: aPassword
	self error: StoreService invalidCredentialsErrorDesciption.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:09:18' prior: 50877302!
createCartFor: aUsername with: aPassword

	self error: StoreService invalidCredentialsErrorDesciption.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:09:20'!
FAILURE!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:09:20'!
FAILURE!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:09:57'!
FAILURE!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:10:34' prior: 50877251!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService new.
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:10:39'!
FAILURE!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:10:57' prior: 50877327!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService new.
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: (anError messageText) = (StoreService invalidCredentialsErrorDesciption).]! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:10:59'!
FAILURE!
!StoreServiceTest methodsFor: 'nil' stamp: 'PhG 11/4/2021 20:12:03' overrides: 16927572!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:12:12'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:12:12'!
PASSED!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:12:22' prior: 50877345!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService new.
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:12:22'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:12:22'!
PASSED!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:12:51'!
test02CreateCartWithValidCredentialsReturnsCartId

	| storeService |

	storeService := StoreService new.
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:13:56' prior: 50877399!
test02CreateCartWithValidCredentialsReturnsCartId

	| storeService cartId |

	storeService := StoreService new.
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: OrderedCollection new.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:14:28' prior: 50877414!
test02CreateCartWithValidCredentialsReturnsCartId

	| storeService cartId |

	storeService := StoreService new.
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:15:14'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'user credentials' stamp: 'PhG 11/4/2021 20:19:39'!
validUser
	self shouldBeImplemented.! !
!StoreTestObjectsFactory methodsFor: 'user credentials' stamp: 'PhG 11/4/2021 20:19:50' prior: 50877443!
validUser
	^'validUser'! !

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:19:52'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'user credentials' stamp: 'PhG 11/4/2021 20:19:58'!
validPassword
	self shouldBeImplemented.! !
!StoreTestObjectsFactory methodsFor: 'user credentials' stamp: 'PhG 11/4/2021 20:20:06' prior: 50877456!
validPassword
	^'validPassword'! !

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:20:07'!
ERROR!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:20:16'!
ERROR!
!StoreService methodsFor: 'accessing' stamp: 'PhG 11/4/2021 20:20:27'!
listCart: aStoreService 
	self shouldBeImplemented.! !
!StoreService methodsFor: 'accessing' stamp: 'PhG 11/4/2021 20:20:36' prior: 50877472!
listCart: aStoreService 
	^Dictionary new.! !

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:20:38'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:20:38'!
PASSED!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:20:38'!
ERROR!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:20:38'!
ERROR!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:20:40'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:21:01'!
PASSED!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:21:01'!
ERROR!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:21:01'!
ERROR!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:26:19'!
ERROR!

!classDefinition: #StoreServiceTest category: 'TusLibros' stamp: 'PhG 11/4/2021 20:29:13'!
TestCase subclass: #StoreServiceTest
	instanceVariableNames: 'testObjectsFactory authenticationBehaviour'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:28:42' prior: 50877377!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'nil' stamp: 'PhG 11/4/2021 20:30:20'!
authenticate: aUsername with: aPassword
	authenticationBehaviour value! !
!StoreServiceTest methodsFor: 'authentication protocol' stamp: 'PhG 11/4/2021 20:30:49' prior: 50877542!
authenticate: aUsername with: aPassword
	authenticationBehaviour value: aUsername value: aPassword! !
!StoreServiceTest methodsFor: 'authentication protocol' stamp: 'PhG 11/4/2021 20:30:51' prior: 50877548!
authenticate: aUsername with: aPassword

	authenticationBehaviour value: aUsername value: aPassword! !
!StoreServiceTest methodsFor: 'authentication protocol' stamp: 'PhG 11/4/2021 20:30:59' prior: 50877555!
authenticate: aUsername with: aPassword

	^authenticationBehaviour value: aUsername value: aPassword! !
!StoreServiceTest methodsFor: 'authentication protocol' stamp: 'PhG 11/4/2021 20:31:01' prior: 50877562!
authenticate: aUsername with: aPassword

	^authenticationBehaviour value: aUsername value: aPassword.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:31:17'!
ERROR!
!StoreService class methodsFor: 'instance creation' stamp: 'PhG 11/4/2021 20:31:38'!
withAuthService: aStoreServiceTest 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithAuthService: aStoreServiceTest ! !
!StoreService class methodsFor: 'instance creation' stamp: 'PhG 11/4/2021 20:31:52' prior: 50877579!
withAuthService: anAuthenticationService

	^self new initializeWithAuthService: anAuthenticationService ! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:31:59'!
ERROR!

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/4/2021 20:32:09'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/4/2021 20:32:09'!
initializeWithAuthService: anAuthenticationService 
	self shouldBeImplemented.
	authenticationService := anAuthenticationService.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/4/2021 20:32:12' prior: 50877606!
initializeWithAuthService: anAuthenticationService 
	
	authenticationService := anAuthenticationService.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:32:14'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:32:14'!
PASSED!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:32:14'!
ERROR!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:32:14'!
ERROR!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/4/2021 20:32:43' prior: 50877309!
createCartFor: aUsername with: aPassword

	authenticationService authenticate: aUsername with: aPassword.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:32:45'!
PASSED!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:32:45'!
ERROR!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:32:45'!
ERROR!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:33:00' prior: 50877427!
test02CreateCartWithValidCredentialsReturnsCartId

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:34:42' prior: 50877654!
test02CreateCartWithValidCredentialsReturnsCartId

	| storeService cartId userAuthenticated passwordAuthenticated |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword .
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:34:43'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:34:43'!
PASSED!

!testRun: #StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:34:43'!
PASSED!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:36:25'!
test02WhenCreatingACartCredentialsAreValidated

	| storeService cartId userAuthenticated passwordAuthenticated |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword .
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !

!methodRemoval: StoreServiceTest #test02CreateCartWithValidCredentialsReturnsCartId stamp: 'PhG 11/4/2021 20:36:25'!
test02CreateCartWithValidCredentialsReturnsCartId

	| storeService cartId userAuthenticated passwordAuthenticated |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword .
	self assert: (storeService listCart: cartId) equals: Dictionary new.!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:36:42'!
test03CreateCartWithValidCredentialsCreatesEmptyCart

	| storeService cartId userAuthenticated passwordAuthenticated |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword .
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:36:46' prior: 50877751!
test03CreateCartWithValidCredentialsCreatesEmptyCart

	| storeService cartId userAuthenticated passwordAuthenticated |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:37:07' prior: 50877774!
test03CreateCartWithValidCredentialsCreatesEmptyCart

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:37:14' prior: 50877705!
test02WhenCreatingACartCredentialsAreValidated

	| storeService cartId userAuthenticated passwordAuthenticated |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword .! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:37:16' prior: 50877808!
test02WhenCreatingACartCredentialsAreValidated

	| storeService cartId userAuthenticated passwordAuthenticated |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:37:26' prior: 50877829!
test02WhenCreatingACartCredentialsAreValidated

	| storeService userAuthenticated passwordAuthenticated |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword.! !

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/4/2021 20:37:27'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/4/2021 20:37:27'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/4/2021 20:37:27'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/4/2021 20:37:27'!
PASSED!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:41:46'!
test04AddBookNotSoldErrorIsInvalidBookError

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:45:31'!
test05AddBookNotSoldErrorIsInvalidBookError

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !

!methodRemoval: StoreServiceTest #test04AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/4/2021 20:45:31'!
test04AddBookNotSoldErrorIsInvalidBookError

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:46:17'!
test04AddBookToCreatedCart

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:48:24'!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !

!methodRemoval: StoreServiceTest #test04AddBookToCreatedCart stamp: 'PhG 11/4/2021 20:48:24'!
test04AddBookToCreatedCart

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:50:41' prior: 50877943!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	authenticationBehaviour := [:aUsername :aPassword | true ].
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	storeService addToCart: cartId quantity: 1 of: (testObjectsFactory itemSellByTheStore).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/4/2021 20:50:53'!
itemSoldByTheStore
	
	^ 'validBook'! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50876727!
test04CanNotAddNonPositiveNumberOfItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [cart add: 0 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50876962!
test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit

	| cart cashier salesBook creditCard |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 	debitBehavior := [ :anAmount :aCreditCard | self error: Cashier creditCardHasNoCreditErrorMessage].
	
	cashier:= Cashier 
		toCheckout: cart 
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	self 
		should: [cashier checkOut ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardHasNoCreditErrorMessage.
			self assert: salesBook isEmpty ]! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50877973!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId |

	storeService := StoreService withAuthService: self.
	authenticationBehaviour := [:aUsername :aPassword | true ].
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	storeService addToCart: cartId quantity: 1 of: (testObjectsFactory itemSoldByTheStore).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50876988!
test05CashierChargesCreditCardUsingMerchantProcessor

	| cart cashier salesBook total creditCard debitedAmout debitedCreditCard  |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart 
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	debitBehavior := [ :anAmount :aCreditCard | 
		debitedAmout := anAmount.
		debitedCreditCard := aCreditCard ].
	total := cashier checkOut.
					
	self assert: debitedCreditCard = creditCard.
	self assert: debitedAmout = total.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50876754!
test08CartRemembersTheNumberOfAddedItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50876799!
test06CartRemembersAddedItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	cart add: testObjectsFactory itemSoldByTheStore.
	self assert: (cart includes: testObjectsFactory itemSoldByTheStore)! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50876777!
test07CartDoesNotHoldNotAddedItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self deny: (cart includes: testObjectsFactory itemSoldByTheStore)! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50876769!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	cart add: testObjectsFactory itemSoldByTheStore.
	self deny: cart isEmpty ! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50876944!
test04CheckoutRegistersASale

	| cart cashier salesBook total |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart 
		charging: testObjectsFactory notExpiredCreditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	total := cashier checkOut.
					
	self assert: salesBook size = 1.
	self assert: salesBook first total = total.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50876923!
test03CanNotCheckoutWithAnExpiredCreditCart

	| cart salesBook |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	salesBook := OrderedCollection new.
	
	self
		should: [ Cashier 
				toCheckout: cart 
				charging: testObjectsFactory expiredCreditCard 
				throught: self
				on: testObjectsFactory today
				registeringOn: salesBook ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assert: anError messageText = Cashier canNotChargeAnExpiredCreditCardErrorMessage.
			self assert: salesBook isEmpty ]! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50877157!
defaultCatalog
	
	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSellByTheStorePrice;
		yourself ! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:50:53' prior: 50877030!
test02CalculatedTotalIsCorrect

	| cart cashier |
	
	cart := testObjectsFactory createCart.
	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	
	cashier :=  Cashier
		toCheckout: cart 
		charging: testObjectsFactory notExpiredCreditCard 
		throught: self
		on: testObjectsFactory today 
		registeringOn: OrderedCollection new.
		
	self assert: cashier checkOut = (testObjectsFactory itemSellByTheStorePrice * 2)! !

!methodRemoval: StoreTestObjectsFactory #itemSellByTheStore stamp: 'PhG 11/4/2021 20:50:53'!
itemSellByTheStore
	
	^ 'validBook'!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:51:58' prior: 50878037!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId itemToBeAdded |

	storeService := StoreService withAuthService: self.
	authenticationBehaviour := [:aUsername :aPassword | true ].
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 20:52:07' prior: 50878186!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId itemToBeAdded |

	storeService := StoreService withAuthService: self.
	authenticationBehaviour := [:aUsername :aPassword | true ].
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/4/2021 20:52:18'!
itemNotSoldByTheStore
	
	^'invalidBook'! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:52:18' prior: 50876741!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [ cart add: testObjectsFactory itemNotSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:52:18' prior: 50876785!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [cart add: 2 of: testObjectsFactory itemNotSoldByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !

!methodRemoval: StoreTestObjectsFactory #itemNotSellByTheStore stamp: 'PhG 11/4/2021 20:52:18'!
itemNotSellByTheStore
	
	^'invalidBook'!
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/4/2021 20:52:29'!
itemSoldByTheStorePrice
	
	^10! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:52:29' prior: 50878166!
test02CalculatedTotalIsCorrect

	| cart cashier |
	
	cart := testObjectsFactory createCart.
	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	
	cashier :=  Cashier
		toCheckout: cart 
		charging: testObjectsFactory notExpiredCreditCard 
		throught: self
		on: testObjectsFactory today 
		registeringOn: OrderedCollection new.
		
	self assert: cashier checkOut = (testObjectsFactory itemSoldByTheStorePrice * 2)! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:52:29' prior: 50878159!
defaultCatalog
	
	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSoldByTheStorePrice;
		yourself ! !

!methodRemoval: StoreTestObjectsFactory #itemSellByTheStorePrice stamp: 'PhG 11/4/2021 20:52:29'!
itemSellByTheStorePrice
	
	^10!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/4/2021 20:53:06'!
ERROR!
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:53:29'!
addToCart: aStoreService quantity: aSmallInteger of: aString 
	self shouldBeImplemented.! !

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/4/2021 20:53:34'!
ERROR!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/4/2021 20:55:38' prior: 50877636!
createCartFor: aUsername with: aPassword

	authenticationService authenticate: aUsername with: aPassword.
	! !

Object subclass: #StoreService
	instanceVariableNames: 'authenticationService carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/4/2021 20:55:47'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/4/2021 20:56:01' prior: 50877614!
initializeWithAuthService: anAuthenticationService 
	
	authenticationService := anAuthenticationService.
	carts := OrderedCollection new.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/4/2021 20:56:27' prior: 50878327!
initializeWithAuthService: anAuthenticationService 
	
	authenticationService := anAuthenticationService.
	carts := Dictionary new.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/4/2021 20:56:47' prior: 50878308!
createCartFor: aUsername with: aPassword

	authenticationService authenticate: aUsername with: aPassword.
	
	! !

Object subclass: #StoreService
	instanceVariableNames: 'authenticationService carts cartId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/4/2021 20:56:54'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService carts cartId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/4/2021 20:57:07' prior: 50878335!
initializeWithAuthService: anAuthenticationService 
	
	authenticationService := anAuthenticationService.
	carts := Dictionary new.
	cartId := 0.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/4/2021 20:57:24' prior: 50878343!
createCartFor: aUsername with: aPassword

	authenticationService authenticate: aUsername with: aPassword.
	cartId := cartId + 1.
	! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/4/2021 20:57:50' prior: 50878371!
createCartFor: aUsername with: aPassword

	authenticationService authenticate: aUsername with: aPassword.

	cartId := cartId + 1.
	Cart .
	! !
!StoreService methodsFor: 'nil' stamp: 'PhG 11/4/2021 20:58:42'!
createCart
	
	^Cart acceptingItemsOf: self defaultCatalog! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/4/2021 20:59:00'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService carts cartId catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:58:57' prior: 50878386!
createCart
	
	^Cart acceptingItemsOf: catalogue! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 20:59:01' prior: 50878400!
createCart
	
	^Cart acceptingItemsOf: catalogue.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/4/2021 20:59:56'!
initializeWithAuthService: anAuthenticationService withCatalogue: aCatalogue
	
	authenticationService := anAuthenticationService.
	carts := Dictionary new.
	cartId := 0.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/4/2021 21:00:06' prior: 50878409!
initializeWithAuthService: anAuthenticationService withCatalogue: aCatalogue
	
	authenticationService := anAuthenticationService.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartId := 0.! !

!methodRemoval: StoreService #initializeWithAuthService: stamp: 'PhG 11/4/2021 21:00:08'!
initializeWithAuthService: anAuthenticationService 
	
	authenticationService := anAuthenticationService.
	carts := Dictionary new.
	cartId := 0.!
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 21:00:21' prior: 50877524!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService withAuthService: self.
	
	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreService class methodsFor: 'instance creation' stamp: 'PhG 11/4/2021 21:00:38'!
withAuthService: anAuthenticationService withCatalogue: aCatalogue

	^self new initializeWithAuthService: anAuthenticationService withCatalogue: aCatalogue! !

!methodRemoval: StoreService class #withAuthService:withCatalogue: stamp: 'PhG 11/4/2021 21:00:40'!
withAuthService: anAuthenticationService withCatalogue: aCatalogue

	^self new initializeWithAuthService: anAuthenticationService withCatalogue: aCatalogue!
!StoreService class methodsFor: 'instance creation' stamp: 'PhG 11/4/2021 21:00:46'!
withAuthService: anAuthenticationService withCatalogue: aCatalogue

	^self new initializeWithAuthService: anAuthenticationService withCatalogue: aCatalogue! !

!methodRemoval: StoreService class #withAuthService: stamp: 'PhG 11/4/2021 21:00:49'!
withAuthService: anAuthenticationService

	^self new initializeWithAuthService: anAuthenticationService !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 21:01:09' prior: 50878435!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService withAuthService: self withCatalogue: (testObjectsFactory defaultCatalog).
	
	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'PhG 11/4/2021 21:01:15'!
defaultCatalogue
	
	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSoldByTheStorePrice;
		yourself ! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 21:01:15' prior: 50877152!
createCart
	
	^Cart acceptingItemsOf: self defaultCatalogue! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/4/2021 21:01:15' prior: 50878484!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := StoreService withAuthService: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !

!methodRemoval: StoreTestObjectsFactory #defaultCatalog stamp: 'PhG 11/4/2021 21:01:15'!
defaultCatalog
	
	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSoldByTheStorePrice;
		yourself !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 21:01:24' prior: 50877850!
test02WhenCreatingACartCredentialsAreValidated

	| storeService userAuthenticated passwordAuthenticated |

	storeService := StoreService withAuthService: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 21:01:27' prior: 50877793!
test03CreateCartWithValidCredentialsCreatesEmptyCart

	| storeService cartId |

	storeService := StoreService withAuthService: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 21:02:18' prior: 50877899!
test05AddBookNotSoldErrorIsInvalidBookError

	| storeService cartId |

	storeService := StoreService withAuthService: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: (storeService listCart: cartId) equals: Dictionary new.! !
!StoreServiceTest methodsFor: 'tests' stamp: 'PhG 11/4/2021 21:02:23' prior: 50878204!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId itemToBeAdded |

	storeService := StoreService withAuthService: self withCatalogue: (testObjectsFactory defaultCatalogue).
	authenticationBehaviour := [:aUsername :aPassword | true ].
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).! !

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/4/2021 21:04:36'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'user credentials' stamp: 'PhG 11/4/2021 21:11:58' prior: 50877448!
validUser
	^'maximilianoCozzetti'! !

----QUIT----(4 November 2021 21:14:27) CuisUniversity-4532.image priorSource: 17437797!

----STARTUP---- (7 November 2021 10:41:23) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!classRemoval: #StoreTestObjectsFactory stamp: 'PhG 11/7/2021 10:41:37'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreService stamp: 'PhG 11/7/2021 10:41:38'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService carts cartId catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Sale stamp: 'PhG 11/7/2021 10:41:38'!
Object subclass: #Sale
	instanceVariableNames: 'total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'PhG 11/7/2021 10:41:38'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'PhG 11/7/2021 10:41:38'!
Object subclass: #Cashier
	instanceVariableNames: 'cart salesBook merchantProcessor creditCard total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'PhG 11/7/2021 10:41:39'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreServiceTest stamp: 'PhG 11/7/2021 10:41:39'!
TestCase subclass: #StoreServiceTest
	instanceVariableNames: 'testObjectsFactory authenticationBehaviour'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'PhG 11/7/2021 10:41:39'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'PhG 11/7/2021 10:41:40'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/iteracion3/TusLibros.st----!

----QUIT----(7 November 2021 11:35:57) CuisUniversity-4532.image priorSource: 17503364!

----STARTUP---- (7 November 2021 15:49:34) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


----QUIT----(7 November 2021 18:45:01) CuisUniversity-4532.image priorSource: 17532854!

----STARTUP---- (7 November 2021 22:04:30) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!classRemoval: #StoreTestObjectsFactory stamp: 'PhG 11/7/2021 22:04:45'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreService stamp: 'PhG 11/7/2021 22:04:45'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService carts latestCartId catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Sale stamp: 'PhG 11/7/2021 22:04:46'!
Object subclass: #Sale
	instanceVariableNames: 'total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'PhG 11/7/2021 22:04:46'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'PhG 11/7/2021 22:04:46'!
Object subclass: #Cashier
	instanceVariableNames: 'cart salesBook merchantProcessor creditCard total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'PhG 11/7/2021 22:04:46'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreServiceTest stamp: 'PhG 11/7/2021 22:04:47'!
TestCase subclass: #StoreServiceTest
	instanceVariableNames: 'testObjectsFactory authenticationBehaviour'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'PhG 11/7/2021 22:04:47'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'PhG 11/7/2021 22:04:47'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/iteracion3/TusLibros.st----!
!CreditCard methodsFor: 'initialization' stamp: 'PhG 11/7/2021 22:06:04'!
initializeWithCardNumber: aCCN expirationDate: aCCED withCardOwner: aCCO 

	ccn := aCCN.
	cced := aCCED.
	cco := aCCO.! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:06:04' prior: 50880336!
withCCN: aCCN withCCED: aCCED withCCO: aCCO 
	
	^self new initializeWithCardNumber: aCCN expirationDate: aCCED withCardOwner: aCCO.! !

!methodRemoval: CreditCard #initializeWithCCN:withCCED:withCCO: stamp: 'PhG 11/7/2021 22:06:04'!
initializeWithCCN: aCCN withCCED: aCCED withCCO: aCCO 

	ccn := aCCN.
	cced := aCCED.
	cco := aCCO.!
!CreditCard methodsFor: 'initialization' stamp: 'PhG 11/7/2021 22:06:09' prior: 50880596!
initializeWithCardNumber: aCardNumber expirationDate: aCCED withCardOwner: aCCO 

	ccn := aCardNumber.
	cced := aCCED.
	cco := aCCO.! !
!CreditCard methodsFor: 'initialization' stamp: 'PhG 11/7/2021 22:06:15' prior: 50880617!
initializeWithCardNumber: aCardNumber expirationDate: anExpirationDate withCardOwner: aCCO 

	ccn := aCardNumber.
	cced := anExpirationDate.
	cco := aCCO.! !
!CreditCard methodsFor: 'initialization' stamp: 'PhG 11/7/2021 22:06:20' prior: 50880625!
initializeWithCardNumber: aCardNumber expirationDate: anExpirationDate withCardOwner: aCardOwner 

	ccn := aCardNumber.
	cced := anExpirationDate.
	cco := aCardOwner.! !

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'PhG 11/7/2021 22:06:24'!
Object subclass: #CreditCard
	instanceVariableNames: 'cced ccn cardOwner expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:06:24' prior: 50880633!
initializeWithCardNumber: aCardNumber expirationDate: anExpirationDate withCardOwner: aCardOwner 

	ccn := aCardNumber.
	cced := anExpirationDate.
	cardOwner := aCardOwner.! !

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'PhG 11/7/2021 22:06:29'!
Object subclass: #CreditCard
	instanceVariableNames: 'expirationDate ccn cardOwner expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:06:29' prior: 50880316!
isExpiredOn: aDate 
	
	^expirationDate start < (Month month: aDate monthIndex year: aDate yearNumber) start ! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:06:29' prior: 50880649!
initializeWithCardNumber: aCardNumber expirationDate: anExpirationDate withCardOwner: aCardOwner 

	ccn := aCardNumber.
	expirationDate := anExpirationDate.
	cardOwner := aCardOwner.! !

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'PhG 11/7/2021 22:06:34'!
Object subclass: #CreditCard
	instanceVariableNames: 'expirationDate cardNumber cardOwner expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:06:34' prior: 50880673!
initializeWithCardNumber: aCardNumber expirationDate: anExpirationDate withCardOwner: aCardOwner 

	cardNumber := aCardNumber.
	expirationDate := anExpirationDate.
	cardOwner := aCardOwner.! !
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/7/2021 22:07:31'!
withCardNumber: aCCN expiring: aCCED cardOwner: aCCO 
	
	^self new initializeWithCardNumber: aCCN expirationDate: aCCED withCardOwner: aCCO.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:07:31' prior: 50880551!
creditCardExpired
	
	^CreditCard withCardNumber: '123456789123456'
				expiring: (Month month: today monthIndex year: today yearNumber - 1)
			     	cardOwner: 'pepito'.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:07:31' prior: 50880396!
checkoutCart: aCartId withCCN: aCCN withCCED: aCCED withCCO: aCCO

	| creditCard cashier cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCCN expiring: aCCED cardOwner: aCCO.
	cart := carts at: aCartId.
	
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.
	
	latestTransactionId := latestTransactionId +1.
	^latestTransactionId.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:07:31' prior: 50880559!
creditCardNonExpired
	
	^CreditCard withCardNumber: '123456789123456'
			     expiring: (Month month: today monthIndex year: today yearNumber + 1)
			     cardOwner: 'pepito'.! !

!methodRemoval: CreditCard class #withCCN:withCCED:withCCO: stamp: 'PhG 11/7/2021 22:07:31'!
withCCN: aCCN withCCED: aCCED withCCO: aCCO 
	
	^self new initializeWithCardNumber: aCCN expirationDate: aCCED withCardOwner: aCCO.!
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/7/2021 22:07:36' prior: 50880699!
withCardNumber: aCCN expiring: aCCED cardOwner: aCardOwner 
	
	^self new initializeWithCardNumber: aCCN expirationDate: aCCED withCardOwner: aCardOwner.! !
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/7/2021 22:07:42' prior: 50880751!
withCardNumber: aCardNumber expiring: aCCED cardOwner: aCardOwner 
	
	^self new initializeWithCardNumber: aCardNumber expirationDate: aCCED withCardOwner: aCardOwner.! !
!CreditCard class methodsFor: 'instance creation' stamp: 'PhG 11/7/2021 22:07:47' prior: 50880759!
withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner 
	
	^self new initializeWithCardNumber: aCardNumber expirationDate: anExpirationDate withCardOwner: aCardOwner.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:08:07'!
PASSED!

!testRun: #StoreServiceTest #test06ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:08:08'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:08:08'!
PASSED!

!testRun: #StoreServiceTest #test08CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:08:08'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:08:08'!
ERROR!

!testRun: #StoreServiceTest #test09CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:08:08'!
ERROR!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #StoreServiceTest #test06ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #StoreServiceTest #test08CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:08:12'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:08:12'!
ERROR!

!testRun: #StoreServiceTest #test09CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:08:12'!
ERROR!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #StoreServiceTest #test06ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #StoreServiceTest #test08CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:08:25'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:08:25'!
ERROR!

!testRun: #StoreServiceTest #test09CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:08:25'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'PhG 11/7/2021 22:09:38' prior: 50880707!
creditCardExpired
	
	^CreditCard withCardNumber: '1234567890123456'
				expiring: (Month month: today monthIndex year: today yearNumber - 1)
			     	cardOwner: 'pepito'.! !

Month month: today monthIndex year: today yearNumber - 1!

today := DateAndTime now.
Month month: today monthIndex year: today yearNumber - 1!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'PhG 11/7/2021 22:12:15' prior: 50880537!
creditCardCCED
	^Month month: today monthIndex year: today yearNumber + 1.! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'PhG 11/7/2021 22:12:27'!
validCardExpirationDate
	^Month month: today monthIndex year: today yearNumber + 1.! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:12:27' prior: 50880067!
test08CheckoutInvalidCartShouldFail

	| storeService cartId |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self should: [ storeService checkoutCart: (cartId+1) 
						 withCCN: testObjectsFactory creditCardCCN 
						 withCCED: testObjectsFactory validCardExpirationDate 
						 withCCO: testObjectsFactory creditCardCCO. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:12:27' prior: 50880097!
test09CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := storeService checkoutCart: cartId 
							 withCCN: testObjectsFactory creditCardCCN 
							 withCCED: testObjectsFactory validCardExpirationDate 
							 withCCO: testObjectsFactory creditCardCCO.

	self assert: 1 equals: transactionId.! !

!methodRemoval: StoreTestObjectsFactory #creditCardCCED stamp: 'PhG 11/7/2021 22:12:27'!
creditCardCCED
	^Month month: today monthIndex year: today yearNumber + 1.!

today := DateAndTime now.
Month month: today monthIndex year: today yearNumber + 1!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'PhG 11/7/2021 22:12:52'!
validCardNumber
	^'123456789123456'.! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:12:52' prior: 50881051!
test08CheckoutInvalidCartShouldFail

	| storeService cartId |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self should: [ storeService checkoutCart: (cartId+1) 
						 withCCN: testObjectsFactory validCardNumber 
						 withCCED: testObjectsFactory validCardExpirationDate 
						 withCCO: testObjectsFactory creditCardCCO. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:12:52' prior: 50881082!
test09CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := storeService checkoutCart: cartId 
							 withCCN: testObjectsFactory validCardNumber 
							 withCCED: testObjectsFactory validCardExpirationDate 
							 withCCO: testObjectsFactory creditCardCCO.

	self assert: 1 equals: transactionId.! !

!methodRemoval: StoreTestObjectsFactory #creditCardCCN stamp: 'PhG 11/7/2021 22:12:52'!
creditCardCCN
	^'123456789123456'.!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'PhG 11/7/2021 22:13:02'!
validCardOwner
	^'pepito'.! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:13:02' prior: 50881123!
test08CheckoutInvalidCartShouldFail

	| storeService cartId |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self should: [ storeService checkoutCart: (cartId+1) 
						 withCCN: testObjectsFactory validCardNumber 
						 withCCED: testObjectsFactory validCardExpirationDate 
						 withCCO: testObjectsFactory validCardOwner. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:13:02' prior: 50881154!
test09CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := storeService checkoutCart: cartId 
							 withCCN: testObjectsFactory validCardNumber 
							 withCCED: testObjectsFactory validCardExpirationDate 
							 withCCO: testObjectsFactory validCardOwner.

	self assert: 1 equals: transactionId.! !

!methodRemoval: StoreTestObjectsFactory #creditCardCCO stamp: 'PhG 11/7/2021 22:13:02'!
creditCardCCO
	^'pepito'.!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #StoreServiceTest #test06ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #StoreServiceTest #test08CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:13:09'!
PASSED!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:14:11'!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := storeService checkoutCart: cartId 
							 withCCN: testObjectsFactory validCardNumber 
							 withCCED: testObjectsFactory validCardExpirationDate 
							 withCCO: testObjectsFactory validCardOwner.

	self assert: 1 equals: transactionId.! !

!methodRemoval: StoreServiceTest #test09CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:14:11'!
test09CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := storeService checkoutCart: cartId 
							 withCCN: testObjectsFactory validCardNumber 
							 withCCED: testObjectsFactory validCardExpirationDate 
							 withCCO: testObjectsFactory validCardOwner.

	self assert: 1 equals: transactionId.!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:14:17'!
test09CheckoutInvalidCartShouldFail

	| storeService cartId |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self should: [ storeService checkoutCart: (cartId+1) 
						 withCCN: testObjectsFactory validCardNumber 
						 withCCED: testObjectsFactory validCardExpirationDate 
						 withCCO: testObjectsFactory validCardOwner. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !

!methodRemoval: StoreServiceTest #test08CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:14:17'!
test08CheckoutInvalidCartShouldFail

	| storeService cartId |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self should: [ storeService checkoutCart: (cartId+1) 
						 withCCN: testObjectsFactory validCardNumber 
						 withCCED: testObjectsFactory validCardExpirationDate 
						 withCCO: testObjectsFactory validCardOwner. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]!
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:14:24'!
test08ListCartsShouldFailWithInvalidCart

	| storeService cartId |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
		
	storeService addToCart: cartId quantity: 1 of: (testObjectsFactory itemSoldByTheStore).
	
	self should: [ storeService listCart: (cartId+1)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription.]! !

!methodRemoval: StoreServiceTest #test07ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:14:24'!
test07ListCartsShouldFailWithInvalidCart

	| storeService cartId |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
		
	storeService addToCart: cartId quantity: 1 of: (testObjectsFactory itemSoldByTheStore).
	
	self should: [ storeService listCart: (cartId+1)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription.]!
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:14:29'!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	anotherCartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore ).
	anotherItemToBeAdded := (testObjectsFactory anotherItemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 1 of: anotherItemToBeAdded.
	storeService addToCart: anotherCartId quantity: 1 of: anotherItemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).
	self assert: (storeService listCart: anotherCartId) equals: (Dictionary with: anotherItemToBeAdded->2).! !

!methodRemoval: StoreServiceTest #test06ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:14:29'!
test06ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	anotherCartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore ).
	anotherItemToBeAdded := (testObjectsFactory anotherItemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 1 of: anotherItemToBeAdded.
	storeService addToCart: anotherCartId quantity: 1 of: anotherItemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).
	self assert: (storeService listCart: anotherCartId) equals: (Dictionary with: anotherItemToBeAdded->2).!
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:15:01'!
test06AddBookToInvalidCartThrowsError

	| storeService cartId itemToBeAdded |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	itemToBeAdded := (testObjectsFactory itemNotSoldByTheStore).
		
	self should: [ storeService addToCart: cartId quantity: 1 of: itemToBeAdded.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = Cart invalidItemErrorMessage .]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:15:32' prior: 50881575!
test06AddBookToInvalidCartThrowsError

	| storeService cartId invalidCartId itemToBeAdded |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	itemToBeAdded := (testObjectsFactory itemNotSoldByTheStore).
		
	self should: [ storeService addToCart: cartId quantity: 1 of: itemToBeAdded.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = Cart invalidItemErrorMessage .]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:15:44' prior: 50881599!
test06AddBookToInvalidCartThrowsError

	| storeService cartId invalidCartId itemToBeAdded |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	invalidCartId := cartId + 1.
	itemToBeAdded := (testObjectsFactory itemNotSoldByTheStore).
		
	self should: [ storeService addToCart: cartId quantity: 1 of: itemToBeAdded.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = Cart invalidItemErrorMessage .]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:16:01' prior: 50881623!
test06AddBookToInvalidCartThrowsError

	| storeService cartId invalidCartId itemToBeAdded |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	invalidCartId := cartId + 1.
		
	self should: [ storeService addToCart: cartId quantity: 1 of: testObjectsFactory itemSoldByTheStore.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = Cart invalidItemErrorMessage .]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:16:15' prior: 50881648!
test06AddBookToInvalidCartThrowsError

	| storeService cartId invalidCartId |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	invalidCartId := cartId + 1.
		
	self should: [ storeService addToCart: invalidCartId quantity: 1 of: testObjectsFactory itemSoldByTheStore.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = Cart invalidItemErrorMessage .]! !

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:16:17'!
FAILURE!
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:16:35' prior: 50881672!
test06AddBookToInvalidCartThrowsError

	| storeService cartId invalidCartId |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	invalidCartId := cartId + 1.
		
	self should: [ storeService addToCart: invalidCartId quantity: 1 of: testObjectsFactory itemSoldByTheStore.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:16:38'!
FAILURE!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:16:53' prior: 50880389!
addToCart: aCartId quantity: aQuantity of: anItem 
	
	| cart |
	
	self assertCartExists: aCartId.
	
	cart := carts at: aCartId .
	cart add: aQuantity of: anItem.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:16:54'!
PASSED!
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:17:30' prior: 50881499!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded |

	storeService := StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).
	
	authenticationBehaviour := [:aUsername :aPassword | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	anotherCartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore ).
	anotherItemToBeAdded := (testObjectsFactory anotherItemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 2 of: anotherItemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).
	self assert: (storeService listCart: anotherCartId) equals: (Dictionary with: anotherItemToBeAdded->2).! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:20:30'!
storeServiceWithAuthenticationBehaviour: authBehaviour

	authenticationBehaviour := authBehaviour.

	^StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:20:38' prior: 50881807!
storeServiceWithAuthenticationBehaviour: anAuthenticationBehaviour

	authenticationBehaviour := anAuthenticationBehaviour.

	^StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:21:24' prior: 50879891!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := self storeServiceWithAuthenticationBehaviour: [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:21:47' prior: 50879912!
test02WhenCreatingACartCredentialsAreValidated

	| storeService userAuthenticated passwordAuthenticated |
	
	storeService := self storeServiceWithAuthenticationBehaviour: [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword.
	! !

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:21:48'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:21:49'!
PASSED!
!StoreServiceTest methodsFor: 'store service creation' stamp: 'PhG 11/7/2021 22:22:15'!
storeServiceAuthenticatingUsers

	| anAuthenticationBehaviour |
	authenticationBehaviour := anAuthenticationBehaviour.

	^StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).! !
!StoreServiceTest methodsFor: 'store service creation' stamp: 'PhG 11/7/2021 22:22:43' prior: 50881907!
storeServiceAuthenticatingUsers

	authenticationBehaviour := [:aUsername :aPassword | true ].

	^StoreService withAuthService: self withMerchantProcessor: self withCatalogue: (testObjectsFactory defaultCatalogue).! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:22:58' prior: 50879935!
test03CreateCartWithValidCredentialsCreatesEmptyCart

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: Dictionary new equals: (storeService listCart: cartId).! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:23:08' prior: 50881772!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	anotherCartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore ).
	anotherItemToBeAdded := (testObjectsFactory anotherItemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 2 of: anotherItemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).
	self assert: (storeService listCart: anotherCartId) equals: (Dictionary with: anotherItemToBeAdded->2).! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:23:13' prior: 50881452!
test08ListCartsShouldFailWithInvalidCart

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
		
	storeService addToCart: cartId quantity: 1 of: (testObjectsFactory itemSoldByTheStore).
	
	self should: [ storeService listCart: (cartId+1)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription.]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:23:20' prior: 50880020!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId itemToBeAdded |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:23:25' prior: 50880043!
test05AddBookNotSoldErrorIsInvalidBookError

	| storeService cartId itemToBeAdded |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	itemToBeAdded := (testObjectsFactory itemNotSoldByTheStore).
		
	self should: [ storeService addToCart: cartId quantity: 1 of: itemToBeAdded.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = Cart invalidItemErrorMessage .]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:23:30' prior: 50881699!
test06AddBookToInvalidCartThrowsError

	| storeService cartId invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	invalidCartId := cartId + 1.
		
	self should: [ storeService addToCart: invalidCartId quantity: 1 of: testObjectsFactory itemSoldByTheStore.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:23:35' prior: 50881391!
test09CheckoutInvalidCartShouldFail

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self should: [ storeService checkoutCart: (cartId+1) 
						 withCCN: testObjectsFactory validCardNumber 
						 withCCED: testObjectsFactory validCardExpirationDate 
						 withCCO: testObjectsFactory validCardOwner. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:23:40' prior: 50881333!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := storeService checkoutCart: cartId 
							 withCCN: testObjectsFactory validCardNumber 
							 withCCED: testObjectsFactory validCardExpirationDate 
							 withCCO: testObjectsFactory validCardOwner.

	self assert: 1 equals: transactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:24:33'!
checkoutCart: aCartId payingWithCreditCard: aCCN expiringOn: aCCED ownedBy: aCCO

	| creditCard cashier cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCCN expiring: aCCED cardOwner: aCCO.
	cart := carts at: aCartId.
	
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.
	
	latestTransactionId := latestTransactionId +1.
	^latestTransactionId.! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:24:33' prior: 50882078!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := storeService checkoutCart: cartId 
							 payingWithCreditCard: testObjectsFactory validCardNumber 
							 expiringOn: testObjectsFactory validCardExpirationDate 
							 ownedBy: testObjectsFactory validCardOwner.

	self assert: 1 equals: transactionId.! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:24:34' prior: 50882052!
test09CheckoutInvalidCartShouldFail

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self should: [ storeService checkoutCart: (cartId+1) 
						 payingWithCreditCard: testObjectsFactory validCardNumber 
						 expiringOn: testObjectsFactory validCardExpirationDate 
						 ownedBy: testObjectsFactory validCardOwner. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !

!methodRemoval: StoreService #checkoutCart:withCCN:withCCED:withCCO: stamp: 'PhG 11/7/2021 22:24:34'!
checkoutCart: aCartId withCCN: aCCN withCCED: aCCED withCCO: aCCO

	| creditCard cashier cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCCN expiring: aCCED cardOwner: aCCO.
	cart := carts at: aCartId.
	
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.
	
	latestTransactionId := latestTransactionId +1.
	^latestTransactionId.!
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:26:40'!
createCartForValidUserIn: storeService

	^ storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword)! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:26:40' prior: 50881928!
test03CreateCartWithValidCredentialsCreatesEmptyCart

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	
	self assert: Dictionary new equals: (storeService listCart: cartId).! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:26:52' prior: 50881993!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId itemToBeAdded |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:26:57' prior: 50882012!
test05AddBookNotSoldErrorIsInvalidBookError

	| storeService cartId itemToBeAdded |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	itemToBeAdded := (testObjectsFactory itemNotSoldByTheStore).
		
	self should: [ storeService addToCart: cartId quantity: 1 of: itemToBeAdded.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = Cart invalidItemErrorMessage .]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:27:01' prior: 50882032!
test06AddBookToInvalidCartThrowsError

	| storeService cartId invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	invalidCartId := cartId + 1.
		
	self should: [ storeService addToCart: invalidCartId quantity: 1 of: testObjectsFactory itemSoldByTheStore.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:27:13' prior: 50882247!
test06AddBookToInvalidCartThrowsError

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	invalidCartId := (self createCartForValidUserIn: storeService) + 1.
		
	self should: [ storeService addToCart: invalidCartId quantity: 1 of: testObjectsFactory itemSoldByTheStore.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:27:30' prior: 50882147!
test09CheckoutInvalidCartShouldFail

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self should: [ storeService checkoutCart: (cartId+1) 
						 payingWithCreditCard: testObjectsFactory validCardNumber 
						 expiringOn: testObjectsFactory validCardExpirationDate 
						 ownedBy: testObjectsFactory validCardOwner. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:27:38' prior: 50882122!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := storeService checkoutCart: cartId 
							 payingWithCreditCard: testObjectsFactory validCardNumber 
							 expiringOn: testObjectsFactory validCardExpirationDate 
							 ownedBy: testObjectsFactory validCardOwner.

	self assert: 1 equals: transactionId.! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:27:48' prior: 50881942!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	anotherCartId  := storeService createCartFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore ).
	anotherItemToBeAdded := (testObjectsFactory anotherItemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 2 of: anotherItemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).
	self assert: (storeService listCart: anotherCartId) equals: (Dictionary with: anotherItemToBeAdded->2).! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:27:55' prior: 50882330!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	anotherCartId  := self createCartForValidUserIn: storeService.
	
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore ).
	anotherItemToBeAdded := (testObjectsFactory anotherItemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 2 of: anotherItemToBeAdded.
	
	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).
	self assert: (storeService listCart: anotherCartId) equals: (Dictionary with: anotherItemToBeAdded->2).! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:28:00' prior: 50881973!
test08ListCartsShouldFailWithInvalidCart

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
		
	storeService addToCart: cartId quantity: 1 of: (testObjectsFactory itemSoldByTheStore).
	
	self should: [ storeService listCart: (cartId+1)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription.]! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:28:20' prior: 50881829!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := self storeServiceWithAuthenticationBehaviour: [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ self createCartForValidUserIn: storeService]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:28:20' prior: 50882406!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := self storeServiceWithAuthenticationBehaviour: [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ self createCartForValidUserIn: storeService]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:21:24' prior: 50882423!
test01CreateCartWithInvalidCredentialsThrowsError

	| storeService |

	storeService := self storeServiceWithAuthenticationBehaviour: [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService createCartFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/7/2021 22:29:11' prior: 50881847!
test02WhenCreatingACartCredentialsAreValidated

	| storeService userAuthenticated passwordAuthenticated |
	
	storeService := self storeServiceWithAuthenticationBehaviour: [:aUsername :aPassword | 
		userAuthenticated := aUsername.
		passwordAuthenticated := aPassword.
		].
	
	self createCartForValidUserIn: storeService.
	
	self assert: userAuthenticated equals: testObjectsFactory validUser.
	self assert: passwordAuthenticated equals: testObjectsFactory validPassword.
	! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:29:20'!
PASSED!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:30:54'!
checkoutCart: cartId in: storeService

	^ storeService checkoutCart: cartId 
							 payingWithCreditCard: testObjectsFactory validCardNumber 
							 expiringOn: testObjectsFactory validCardExpirationDate 
							 ownedBy: testObjectsFactory validCardOwner! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:30:54' prior: 50882307!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := self checkoutCart: cartId in: storeService.

	self assert: 1 equals: transactionId.! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:31:34'!
checkoutCart: cartId usingValidCreditCardIn: storeService

	^ storeService checkoutCart: cartId 
							 payingWithCreditCard: testObjectsFactory validCardNumber 
							 expiringOn: testObjectsFactory validCardExpirationDate 
							 ownedBy: testObjectsFactory validCardOwner! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:31:34' prior: 50882525!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId|

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := self checkoutCart: cartId usingValidCreditCardIn: storeService.

	self assert: 1 equals: transactionId.! !

!methodRemoval: StoreServiceTest #checkoutCart:in: stamp: 'PhG 11/7/2021 22:31:34'!
checkoutCart: cartId in: storeService

	^ storeService checkoutCart: cartId 
							 payingWithCreditCard: testObjectsFactory validCardNumber 
							 expiringOn: testObjectsFactory validCardExpirationDate 
							 ownedBy: testObjectsFactory validCardOwner!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:32:16' prior: 50882282!
test09CheckoutInvalidCartShouldFail

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	
	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:32:21' prior: 50882583!
test09CheckoutInvalidCartShouldFail

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	invalidCartId  := self createCartForValidUserIn: storeService.
	
	self should: [ self checkoutCart: invalidCartId usingValidCreditCardIn: storeService. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:32:26' prior: 50882600!
test09CheckoutInvalidCartShouldFail

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	invalidCartId  := (self createCartForValidUserIn: storeService) + 1.
	
	self should: [ self checkoutCart: invalidCartId usingValidCreditCardIn: storeService. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:32:28'!
PASSED!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:32:42' prior: 50882618!
test09CheckoutInvalidCartShouldFail

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	"debitBehavior := [ :anAmount :aCreditCard | true ]."
	
	invalidCartId  := (self createCartForValidUserIn: storeService) + 1.
	
	self should: [ self checkoutCart: invalidCartId usingValidCreditCardIn: storeService. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:32:43'!
PASSED!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:32:45' prior: 50882676!
test09CheckoutInvalidCartShouldFail

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	invalidCartId  := (self createCartForValidUserIn: storeService) + 1.
	
	self should: [ self checkoutCart: invalidCartId usingValidCreditCardIn: storeService. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:34:11' prior: 50882229!
test05AddBookNotSoldErrorIsInvalidBookError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
		
	self should: [ storeService addToCart: cartId quantity: 1 of: (testObjectsFactory itemNotSoldByTheStore).]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = Cart invalidItemErrorMessage .]! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:35:09' prior: 50882388!
test08ListCartsShouldFailWithInvalidCart

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	
	self should: [ storeService listCart: (cartId+1)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription.]! !

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:35:09'!
PASSED!
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:35:22' prior: 50882767!
test08ListCartsShouldFailWithInvalidCart

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	invalidCartId  := self createCartForValidUserIn: storeService.
	
	self should: [ storeService listCart: (invalidCartId+1)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription.]! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:35:31' prior: 50882822!
test08ListCartsShouldFailWithInvalidCart

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	invalidCartId  := (self createCartForValidUserIn: storeService) + 1.
	
	self should: [ storeService listCart: invalidCartId]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription.]! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:35:33' prior: 50882838!
test08ListCartsShouldFailWithInvalidCart

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	invalidCartId  := (self createCartForValidUserIn: storeService) + 1.
	
	self should: [ storeService listCart: invalidCartId. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription.]! !

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:35:35'!
PASSED!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:36:34'!
invalidCartIdIn: storeService

	^ (self createCartForValidUserIn: storeService) + 1! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/7/2021 22:36:34' prior: 50882734!
test09CheckoutInvalidCartShouldFail

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	invalidCartId  := self invalidCartIdIn: storeService.
	
	self should: [ self checkoutCart: invalidCartId usingValidCreditCardIn: storeService. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/7/2021 22:36:50' prior: 50882854!
test08ListCartsShouldFailWithInvalidCart

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	invalidCartId  := self invalidCartIdIn: storeService.
	
	self should: [ storeService listCart: invalidCartId. ]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription.]! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/7/2021 22:37:13' prior: 50882265!
test06AddBookToInvalidCartThrowsError

	| storeService invalidCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	invalidCartId := self invalidCartIdIn: storeService.
		
	self should: [ storeService addToCart: invalidCartId quantity: 1 of: testObjectsFactory itemSoldByTheStore.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCartErrorDescription .]! !
!StoreServiceTest methodsFor: 'store service creation' stamp: 'PhG 11/7/2021 22:38:21' prior: 50881918!
storeServiceAuthenticatingUsers

	^self storeServiceWithAuthenticationBehaviour: [:aUsername :aPassword | true ].! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:39:22' prior: 50882102!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: aCCED ownedBy: aCCO

	| creditCard cashier cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: aCCED cardOwner: aCCO.
	cart := carts at: aCartId.
	
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.
	
	latestTransactionId := latestTransactionId +1.
	^latestTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:39:27' prior: 50882970!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCCO

	| creditCard cashier cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCCO.
	cart := carts at: aCartId.
	
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.
	
	latestTransactionId := latestTransactionId +1.
	^latestTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:39:31' prior: 50882990!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cashier cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.
	
	latestTransactionId := latestTransactionId +1.
	^latestTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:40:44'!
nextTransactionId

	^ latestTransactionId := latestTransactionId +1! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:40:44' prior: 50883010!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cashier cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.
	
	self nextTransactionId.
	^latestTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:40:53'!
nextCartId

	^ latestCartId := latestCartId + 1! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:40:53' prior: 50880414!
createCartFor: aUsername with: aPassword
		
	authenticationService authenticate: aUsername with: aPassword.
	self nextCartId.
	carts at: latestCartId put: (Cart acceptingItemsOf: catalogue).
	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:41:32'!
assertAuthenticationForUser: aUsername withPassword: aPassword

	^ authenticationService authenticate: aUsername with: aPassword! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:41:32' prior: 50883061!
createCartFor: aUsername with: aPassword
		
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	self nextCartId.
	carts at: latestCartId put: (Cart acceptingItemsOf: catalogue).
	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:42:11' prior: 50883077!
createCartFor: aUsername with: aPassword
		
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	carts at: self nextCartId put: (Cart acceptingItemsOf: catalogue).

	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:42:33' prior: 50881727!
addToCart: aCartId quantity: aQuantity of: anItem 
	
	| cart |
	
	self assertCartExists: aCartId.
	
	cart := carts at: aCartId.
	cart add: aQuantity of: anItem.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:43:18' prior: 50883036!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cashier cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:44:32' prior: 50883105!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cashier cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.
	
	^self nextTransactionId.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/7/2021 22:44:37'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/7/2021 22:44:37'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/7/2021 22:44:37'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/7/2021 22:44:37'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/7/2021 22:44:37'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/7/2021 22:44:37'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/7/2021 22:44:37'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/7/2021 22:44:37'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/7/2021 22:44:37'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:44:37'!
ERROR!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/7/2021 22:44:37'!
ERROR!
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:44:49'!
checkout: aCart chargingOn: aCreditCard 
	self shouldBeImplemented.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:45:11' prior: 50883124!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart |
	
	self assertCartExists: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:45:27' prior: 50883185!
checkout: aCart chargingOn: aCreditCard 
	| cart cashier creditCard |
	cashier := Cashier toCheckout: cart 
					charging: creditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:45:44' prior: 50883206!
checkout: aCart chargingOn: aCreditCard 
	| cashier |

	cashier := Cashier toCheckout: aCart 
					charging: aCreditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/7/2021 22:45:50' prior: 50883217!
checkout: aCart chargingOn: aCreditCard 
	
	| cashier |

	cashier := Cashier toCheckout: aCart 
					charging: aCreditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	cashier checkOut.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/7/2021 22:49:50' prior: 50880424!
listCart: aCartId

	|cart items|
	
	self assertCartExists: aCartId.
	
	cart := carts at: aCartId.
	items := Dictionary new.
	catalogue 	keysDo: [:anItem | 
		|occurences|
		occurences := cart occurrencesOf: anItem.
		(occurences >0) ifTrue: [items at: anItem put: occurences]].
	^items.! !

----QUIT----(7 November 2021 22:56:51) CuisUniversity-4532.image priorSource: 17533074!

----STARTUP---- (8 November 2021 17:03:39) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


Undeclared!

self removeKey: #cashier!

self removeKey: #cashier!

self removeKey: #cashier!

self removeKey: #creditCard!

self removeKey: #storeService!

self removeKey: #storeServicestoreService!

self removeKey: #cartId!

self removeKey: #aUsername!

self removeKey: #aPassword!

self removeKey: #cart!

Undeclared!

self removeKey: #tddState!

self removeKey: #x!

self removeKey: #statements!

self removeKey: #StringMorph!

self removeKey: #EllipseMorph!

Undeclared!
!StoreServiceTest methodsFor: 'store service creation' stamp: 'PhG 11/8/2021 17:16:44' prior: 50881818!
storeServiceWithAuthenticationBehaviour: anAuthenticationBehaviour

	authenticationBehaviour := anAuthenticationBehaviour.

	^StoreService 
		withAuthService: self 
		withMerchantProcessor: self 
		withCatalogue: testObjectsFactory defaultCatalogue.! !
!StoreServiceTest methodsFor: 'checkout cart' stamp: 'PhG 11/8/2021 17:17:12' prior: 50882542!
checkoutCart: cartId usingValidCreditCardIn: storeService

	^ storeService checkoutCart: cartId 
		 payingWithCreditCard: testObjectsFactory validCardNumber 
		 expiringOn: testObjectsFactory validCardExpirationDate 
		 ownedBy: testObjectsFactory validCardOwner! !
!StoreServiceTest methodsFor: 'create cart' stamp: 'PhG 11/8/2021 17:17:30' prior: 50882192!
createCartForValidUserIn: storeService

	^ storeService createCartFor: testObjectsFactory validUser 
		with: testObjectsFactory validPassword! !
!StoreServiceTest methodsFor: 'create cart tests' stamp: 'PhG 11/8/2021 17:21:58' prior: 50882200!
test03CreateCartWithValidCredentialsCreatesEmptyCart

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	
	self assert: (storeService listCart: cartId) isEmpty.! !

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 17:21:58'!
PASSED!
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/8/2021 17:36:01' prior: 50882212!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId itemToBeAdded cartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	
	cartContent := storeService listCart: cartId.
	self assert: cartContent size equals: 1.
	self assert: (cartContent at: itemToBeAdded) equals: 1.! !

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 17:36:03'!
PASSED!
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/8/2021 17:36:13' prior: 50883357!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId itemToBeAdded cartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	cartContent := storeService listCart: cartId.

	self assert: cartContent size equals: 1.
	self assert: (cartContent at: itemToBeAdded) equals: 1.! !
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/8/2021 17:36:30' prior: 50883417!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId itemToBeAdded cartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	itemToBeAdded := testObjectsFactory itemSoldByTheStore.
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	cartContent := storeService listCart: cartId.

	self assert: cartContent size equals: 1.
	self assert: (cartContent at: itemToBeAdded) equals: 1.! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/8/2021 17:37:58' prior: 50882360!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded cartContent anotherCartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	anotherCartId  := self createCartForValidUserIn: storeService.
	
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore ).
	anotherItemToBeAdded := (testObjectsFactory anotherItemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 2 of: anotherItemToBeAdded.
	
	cartContent := storeService listCart: cartId.
	anotherCartContent := storeService listCart: anotherCartId.

	self assert: cartContent size equals: 1.
	self assert: (cartContent at: itemToBeAdded) equals: 1.
	self assert: anotherCartContent size equals: 1.
	self assert: (anotherCartContent at: anotherItemToBeAdded) equals: 2.
	
"	self assert: (storeService listCart: cartId) equals: (Dictionary with: itemToBeAdded->1).
	self assert: (storeService listCart: anotherCartId) equals: (Dictionary with: anotherItemToBeAdded->2)."! !

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 17:37:59'!
PASSED!
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/8/2021 17:38:25' prior: 50883455!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded cartContent anotherCartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	anotherCartId  := self createCartForValidUserIn: storeService.
	
	itemToBeAdded := (testObjectsFactory itemSoldByTheStore ).
	anotherItemToBeAdded := (testObjectsFactory anotherItemSoldByTheStore).
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 2 of: anotherItemToBeAdded.
	
	cartContent := storeService listCart: cartId.
	anotherCartContent := storeService listCart: anotherCartId.

	self assert: cartContent size equals: 1.
	self assert: (cartContent at: itemToBeAdded) equals: 1.
	self assert: anotherCartContent size equals: 1.
	self assert: (anotherCartContent at: anotherItemToBeAdded) equals: 2.! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/8/2021 17:38:38' prior: 50883534!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded cartContent anotherCartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	anotherCartId  := self createCartForValidUserIn: storeService.
	
	itemToBeAdded := testObjectsFactory itemSoldByTheStore .
	anotherItemToBeAdded := testObjectsFactory anotherItemSoldByTheStore.
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 2 of: anotherItemToBeAdded.
	
	cartContent := storeService listCart: cartId.
	anotherCartContent := storeService listCart: anotherCartId.

	self assert: cartContent size equals: 1.
	self assert: (cartContent at: itemToBeAdded) equals: 1.
	self assert: anotherCartContent size equals: 1.
	self assert: (anotherCartContent at: anotherItemToBeAdded) equals: 2.! !
!StoreService methodsFor: 'next id' stamp: 'PhG 11/8/2021 17:53:49' prior: 50883056!
nextCartId
	
	latestCartId := latestCartId + 1.

	^ latestCartId copy! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 17:53:59' prior: 50883239!
listCart: aCartId

	|cart items|
	
	self assertCartExists: aCartId.
	
	cart := carts at: aCartId.
	items := Dictionary new.
	catalogue 	keysDo: [:anItem | 
		|occurences|
		occurences := cart occurrencesOf: anItem.
		(occurences >0) ifTrue: [items at: anItem put: occurences]].
	^items copy.! !
!StoreService methodsFor: 'next id' stamp: 'PhG 11/8/2021 17:55:03' prior: 50883599!
nextCartId
	
	^latestCartId := latestCartId + 1.! !
!Cart methodsFor: 'adding' stamp: 'PhG 11/8/2021 18:05:54'!
content

	^items copy.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 18:06:33' prior: 50883605!
listCart: aCartId

	|cart items|
	
	self assertCartExists: aCartId.
	
	cart := carts at: aCartId.
	items := Dictionary new.
"	catalogue 	keysDo: [:anItem | 
		|occurences|
		occurences := cart occurrencesOf: anItem.
		(occurences >0) ifTrue: [items at: anItem put: occurences]].
	^items copy."
	^cart content copy.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 18:06:39'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 18:06:39'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 18:06:39'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:06:39'!
ERROR!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 18:06:39'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 18:06:39'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:06:39'!
ERROR!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 18:06:39'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 18:06:39'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 18:06:39'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:06:45'!
ERROR!
!Cart methodsFor: 'content' stamp: 'PhG 11/8/2021 18:12:59' prior: 50883621!
content

	^Bag new 
		addAll: items;
		yourself.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:13:11'!
ERROR!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:13:11'!
ERROR!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 18:13:11'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:13:25'!
ERROR!
!StoreServiceTest methodsFor: 'add to cart tests' stamp: 'PhG 11/8/2021 18:14:23' prior: 50883436!
test04WhenAddingBookToCreatedCartBookIsReturnedInListCart

	| storeService cartId itemToBeAdded cartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	itemToBeAdded := testObjectsFactory itemSoldByTheStore.
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	cartContent := storeService listCart: cartId.

	self assert: cartContent size equals: 1.
	self assert: (cartContent occurrencesOf: itemToBeAdded) equals: 1.! !

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:14:26'!
ERROR!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 18:14:26'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:14:26'!
ERROR!
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/8/2021 18:14:43' prior: 50883567!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded cartContent anotherCartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	anotherCartId  := self createCartForValidUserIn: storeService.
	
	itemToBeAdded := testObjectsFactory itemSoldByTheStore .
	anotherItemToBeAdded := testObjectsFactory anotherItemSoldByTheStore.
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 2 of: anotherItemToBeAdded.
	
	cartContent := storeService listCart: cartId.
	anotherCartContent := storeService listCart: anotherCartId.

	self assert: cartContent size equals: 1.
	self assert: (cartContent occurrencesOf: itemToBeAdded) equals: 1.
	self assert: anotherCartContent size equals: 1.
	self assert: (anotherCartContent occurrencesOf: anotherItemToBeAdded) equals: 2.! !

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:14:45'!
FAILURE!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/8/2021 18:14:54'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/8/2021 18:14:54'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/8/2021 18:14:54'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:14:55'!
FAILURE!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 18:14:55'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:14:55'!
FAILURE!
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/8/2021 18:16:19' prior: 50883833!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId itemToBeAdded anotherItemToBeAdded cartContent anotherCartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	anotherCartId  := self createCartForValidUserIn: storeService.
	
	itemToBeAdded := testObjectsFactory itemSoldByTheStore .
	anotherItemToBeAdded := testObjectsFactory anotherItemSoldByTheStore.
	
	storeService addToCart: cartId quantity: 1 of: itemToBeAdded.
	storeService addToCart: anotherCartId quantity: 2 of: anotherItemToBeAdded.
	
	cartContent := storeService listCart: cartId.
	anotherCartContent := storeService listCart: anotherCartId.

	self assert: cartContent size equals: 1.
	self assert: (cartContent occurrencesOf: itemToBeAdded) equals: 1.
	self assert: anotherCartContent size equals: 2.
	self assert: (anotherCartContent occurrencesOf: anotherItemToBeAdded) equals: 2.! !

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:16:21'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 18:16:23'!
PASSED!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 18:16:43' prior: 50883625!
listCart: aCartId

	|cart |
	
	self assertCartExists: aCartId.
	
	cart := carts at: aCartId.
	^cart content copy.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 18:16:45' prior: 50884075!
listCart: aCartId

	| cart |
	
	self assertCartExists: aCartId.
	
	cart := carts at: aCartId.
	^cart content copy.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 18:17:03' prior: 50884082!
listCart: aCartId

	self assertCartExists: aCartId.
	
	^(carts at: aCartId) content copy.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 18:17:05'!
PASSED!

----SNAPSHOT----(8 November 2021 18:18:10) CuisUniversity-4532.image priorSource: 17651201!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 18:39:14'!
PASSED!

----SNAPSHOT----(8 November 2021 18:40:31) CuisUniversity-4532.image priorSource: 17680835!

----QUIT----(8 November 2021 18:44:51) CuisUniversity-4532.image priorSource: 17683559!

----STARTUP---- (8 November 2021 19:21:08) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!

!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/8/2021 19:33:42'!
test11OperatingCartAfter30MinutesThrowsUnusedError

	| storeService cartId transactionId|

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	transactionId := self checkoutCart: cartId usingValidCreditCardIn: storeService.

	self assert: 1 equals: transactionId.! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 19:35:04' prior: 50884272!
test11OperatingCartAfter30MinutesThrowsUnusedError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartUnusedDuring30MinutesErrorDescription .]! !

!testRun: #StoreServiceTest #test11OperatingCartAfter30MinutesThrowsUnusedError stamp: 'PhG 11/8/2021 19:35:12'!
FAILURE!
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 19:36:40'!
test11OperatingCartAfterExpirationTimeThrowsTimeout

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartUnusedDuring30MinutesErrorDescription .]! !

!methodRemoval: StoreServiceTest #test11OperatingCartAfter30MinutesThrowsUnusedError stamp: 'PhG 11/8/2021 19:36:40'!
test11OperatingCartAfter30MinutesThrowsUnusedError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartUnusedDuring30MinutesErrorDescription .]!
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 19:36:54' prior: 50884314!
test11OperatingCartAfterExpirationTimeThrowsTimeout

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription .]! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 19:37:01' prior: 50884356!
test11OperatingCartAfterExpirationTimeThrowsTimeout

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'nil' stamp: 'PhG 11/8/2021 19:46:13'!
isExpired: aCart on: aTimestamp
	^true! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/8/2021 19:48:39'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook timeoutService'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 19:48:36'!
assertCartTimeout: aCart on: aTimeout

	^ timeoutService isExpired: aCart on: aTimeout! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 19:48:46' prior: 50884411!
assertCartTimeout: aCart on: aTimeout

	^ timeoutService isExpired: aCart on: aTimeout.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/8/2021 19:49:21'!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withTimeoutService: aTimeoutService
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	timeoutService := aTimeoutService.
	catalogue := aCatalogue.
	carts := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.! !
!StoreService class methodsFor: 'instance creation' stamp: 'PhG 11/8/2021 19:49:37'!
withAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withTimeoutService: aTimeoutService

	^self new initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withTimeoutService: aTimeoutService! !
!StoreServiceTest methodsFor: 'store service creation' stamp: 'PhG 11/8/2021 19:51:41' prior: 50883274!
storeServiceWithAuthenticationBehaviour: anAuthenticationBehaviour

	authenticationBehaviour := anAuthenticationBehaviour.

	^StoreService 
		withAuthService: self 
		withMerchantProcessor: self 
		withCatalogue: testObjectsFactory defaultCatalogue
		withTimeoutService: self.! !

!classDefinition: #StoreServiceTest category: 'TusLibros' stamp: 'PhG 11/8/2021 19:52:32'!
TestCase subclass: #StoreServiceTest
	instanceVariableNames: 'testObjectsFactory authenticationBehaviour debitBehavior timeoutBehaviour'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreServiceTest methodsFor: 'store service creation' stamp: 'PhG 11/8/2021 19:52:31' prior: 50884453!
storeServiceWithAuthenticationBehaviour: anAuthenticationBehaviour

	authenticationBehaviour := anAuthenticationBehaviour.
	timeoutBehaviour := [:aCart :aTimestamp | true.].

	^StoreService 
		withAuthService: self 
		withMerchantProcessor: self 
		withCatalogue: testObjectsFactory defaultCatalogue
		withTimeoutService: self.! !
!StoreServiceTest methodsFor: 'store service creation' stamp: 'PhG 11/8/2021 19:52:37' prior: 50884475!
storeServiceWithAuthenticationBehaviour: anAuthenticationBehaviour

	authenticationBehaviour := anAuthenticationBehaviour.
	timeoutBehaviour := [:aCart :aTimestamp | true ].

	^StoreService 
		withAuthService: self 
		withMerchantProcessor: self 
		withCatalogue: testObjectsFactory defaultCatalogue
		withTimeoutService: self.! !
!StoreServiceTest methodsFor: 'cart timeout protocol' stamp: 'PhG 11/8/2021 19:52:57' prior: 50884397!
isExpired: aCart on: aTimestamp
	
	^timeoutBehaviour value! !
!StoreServiceTest methodsFor: 'cart timeout protocol' stamp: 'PhG 11/8/2021 19:52:59' prior: 50884503!
isExpired: aCart on: aTimestamp
	
	^timeoutBehaviour value.! !
!StoreServiceTest methodsFor: 'cart timeout protocol' stamp: 'PhG 11/8/2021 19:53:15' prior: 50884509!
isExpired: aCart on: aTimestamp
	
	^timeoutBehaviour value: aCart value: aTimestamp.! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 19:54:02' prior: 50884377!
test11OperatingCartAfterExpirationTimeThrowsTimeout

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	timeoutBehaviour := [:aCart :aTimestamp | self error: StoreService cartTimeoutErrorDescription ].

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeout stamp: 'PhG 11/8/2021 19:54:07'!
FAILURE!
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 19:54:38' prior: 50884521!
test11OperatingCartAfterExpirationTimeThrowsTimeout

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	timeoutBehaviour := [:aCart :aTimestamp | true ].

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 19:54:57' prior: 50884417!
assertCartTimeout: aCart on: aTimeout

	^ (timeoutService isExpired: aCart on: aTimeout) ifTrue: [self error: StoreService cartTimeoutErrorDescription].! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 19:55:00' prior: 50884571!
assertCartTimeout: aCart on: aTimeout

	(timeoutService isExpired: aCart on: aTimeout) ifTrue: [self error: StoreService cartTimeoutErrorDescription].! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 19:55:26' prior: 50883097!
addToCart: aCartId quantity: aQuantity of: anItem 
	
	| cart |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId on: cart.
	
	cart := carts at: aCartId.
	cart add: aQuantity of: anItem.! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 19:58:14' prior: 50884579!
assertCartTimeout: aCart on: aTimeout

	(timeoutService isExpired: aCart) ifTrue: [self error: StoreService cartTimeoutErrorDescription].! !
!StoreServiceTest methodsFor: 'cart timeout protocol' stamp: 'PhG 11/8/2021 19:58:31'!
isExpired: aCart
	
	| aTimestamp |
	^timeoutBehaviour value: aCart value: aTimestamp.! !
!StoreServiceTest methodsFor: 'cart timeout protocol' stamp: 'PhG 11/8/2021 19:58:45' prior: 50884605!
isExpired: aCart
	
	^timeoutBehaviour value: aCart.! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 19:58:52' prior: 50884549!
test11OperatingCartAfterExpirationTimeThrowsTimeout

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	timeoutBehaviour := [:aCart | true ].

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 19:58:54' prior: 50884616!
test11OperatingCartAfterExpirationTimeThrowsTimeout

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	timeoutBehaviour := [:aCartId | true ].

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'cart timeout protocol' stamp: 'PhG 11/8/2021 19:59:06' prior: 50884611!
isExpired: aCartId
	
	^timeoutBehaviour value: aCartId.! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 20:02:13'!
test11OperatingCartAfterExpirationTimeThrowsTimeoutError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	timeoutBehaviour := [:aCartId | true ].

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !

!methodRemoval: StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeout stamp: 'PhG 11/8/2021 20:02:13'!
test11OperatingCartAfterExpirationTimeThrowsTimeout

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	timeoutBehaviour := [:aCartId | true ].

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]!

!methodRemoval: StoreServiceTest #isExpired:on: stamp: 'PhG 11/8/2021 20:04:23'!
isExpired: aCart on: aTimestamp
	
	^timeoutBehaviour value: aCart value: aTimestamp.!
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 20:13:36' prior: 50884665!
test11OperatingCartAfterExpirationTimeThrowsTimeoutError

	| storeService cartId timenow |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	timenow := [:aCartId | | untiempoexpirado | untiempoexpirado ].

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 20:17:35' prior: 50884714!
test11OperatingCartAfterExpirationTimeThrowsTimeoutError

	| storeService cartId timenow |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	timenow := [:aCartId |  ].

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 20:22:51' prior: 50884587!
addToCart: aCartId quantity: aQuantity of: anItem 
	
	| cart |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	cart := carts at: aCartId.
	cart add: aQuantity of: anItem.! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/8/2021 20:23:23'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook timeoutService cartTimeout'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/8/2021 20:23:35'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook timeoutService cartTimeout clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 20:23:21' prior: 50883087!
createCartFor: aUsername with: aPassword
		
	| cart |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	carts at: self nextCartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout put: cart->clock now.

	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 20:24:03' prior: 50884790!
createCartFor: aUsername with: aPassword
		
	| cart |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cart :=	(Cart acceptingItemsOf: catalogue).
	carts at: self nextCartId put: cart.
	cartTimeout at: cart put: clock now.

	^latestCartId.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/8/2021 20:25:13'!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aTimeoutService
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	timeoutService := aTimeoutService.
	catalogue := aCatalogue.
	carts := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.! !
!StoreService class methodsFor: 'as yet unclassified' stamp: 'PhG 11/8/2021 20:25:13' prior: 50884439!
withAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withTimeoutService: aTimeoutService

	^self new initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aTimeoutService! !

!methodRemoval: StoreService #initializeWithAuthService:withMerchantProcessor:withCatalogue:withTimeoutService: stamp: 'PhG 11/8/2021 20:25:13'!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withTimeoutService: aTimeoutService
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	timeoutService := aTimeoutService.
	catalogue := aCatalogue.
	carts := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.!
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/8/2021 20:25:19' prior: 50884812!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	timeoutService := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/8/2021 20:25:24' prior: 50884860!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/8/2021 20:25:45' prior: 50884876!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.! !

!methodRemoval: StoreService #initializeWithAuthService:withMerchantProcessor:withCatalogue: stamp: 'PhG 11/8/2021 20:25:49'!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	catalogue := aCatalogue.
	carts := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.!

Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/8/2021 20:25:58'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!methodRemoval: StoreService class #withAuthService:withMerchantProcessor:withCatalogue: stamp: 'PhG 11/8/2021 20:26:04'!
withAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue

	^self new initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue!
!StoreService class methodsFor: 'instance creation' stamp: 'PhG 11/8/2021 20:26:14'!
withAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aTimeoutService

	^self new initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aTimeoutService! !
!StoreServiceTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/8/2021 20:26:14' prior: 50884489!
storeServiceWithAuthenticationBehaviour: anAuthenticationBehaviour

	authenticationBehaviour := anAuthenticationBehaviour.
	timeoutBehaviour := [:aCart :aTimestamp | true ].

	^StoreService 
		withAuthService: self 
		withMerchantProcessor: self 
		withCatalogue: testObjectsFactory defaultCatalogue
		withClock: self.! !

!methodRemoval: StoreService class #withAuthService:withMerchantProcessor:withCatalogue:withTimeoutService: stamp: 'PhG 11/8/2021 20:26:14'!
withAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withTimeoutService: aTimeoutService

	^self new initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aTimeoutService!
!StoreService class methodsFor: 'instance creation' stamp: 'PhG 11/8/2021 20:26:18' prior: 50884953!
withAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock

	^self new initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock! !

!classDefinition: #StoreServiceTest category: 'TusLibros' stamp: 'PhG 11/8/2021 20:28:32'!
TestCase subclass: #StoreServiceTest
	instanceVariableNames: 'testObjectsFactory authenticationBehaviour debitBehavior timeoutBehaviour now'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreServiceTest methodsFor: 'cart timeout protocol' stamp: 'PhG 11/8/2021 20:28:31'!
now
	^now! !

!methodRemoval: StoreServiceTest #isExpired: stamp: 'PhG 11/8/2021 20:28:40'!
isExpired: aCartId
	
	^timeoutBehaviour value: aCartId.!
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 20:29:24' prior: 50884737!
test11OperatingCartAfterExpirationTimeThrowsTimeoutError

	| storeService cartId timenow |

	now := DateAndTime now.
	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 20:30:04' prior: 50885023!
test11OperatingCartAfterExpirationTimeThrowsTimeoutError

	| storeService cartId |

	now := DateAndTime now.
	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now .

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 20:37:15' prior: 50885045!
test11OperatingCartAfterExpirationTimeThrowsTimeoutError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now .

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'store service creation' stamp: 'PhG 11/8/2021 20:37:22' prior: 50884966!
storeServiceWithAuthenticationBehaviour: anAuthenticationBehaviour

	authenticationBehaviour := anAuthenticationBehaviour.
	now := DateAndTime now.

	^StoreService 
		withAuthService: self 
		withMerchantProcessor: self 
		withCatalogue: testObjectsFactory defaultCatalogue
		withClock: self.! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 20:37:40' prior: 50885067!
test11OperatingCartAfterExpirationTimeThrowsTimeoutError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now + (Duration minutes: 31).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 20:37:41'!
ERROR!
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/8/2021 20:37:54'!
assertCartTimeout: aSmallInteger 
	self shouldBeImplemented.! !

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:20:01'!
ERROR!
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:20:18' prior: 50885128!
assertCartTimeout: aCartId 
	self shouldBeImplemented.! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:20:53' prior: 50885137!
assertCartTimeout: aCartId 
	
	| lastUsage |
	
	lastUsage := cartTimeout at: aCartId.! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:21:49' prior: 50885142!
assertCartTimeout: aCartId 
	
	| lastUsage |
	
	lastUsage := cartTimeout at: aCartId.
	((Duration minutes: 30) < lastUsage - clock now) ifTrue: [self error: StoreService ]! !
!StoreService class methodsFor: 'error descriptions' stamp: 'PhG 11/8/2021 21:22:08'!
cartTimeoutErrorDescription
	^'Timeout exceeded.'.! !

!methodRemoval: StoreService #assertCartTimeout:on: stamp: 'PhG 11/8/2021 21:22:18'!
assertCartTimeout: aCart on: aTimeout

	(timeoutService isExpired: aCart) ifTrue: [self error: StoreService cartTimeoutErrorDescription].!
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:22:26' prior: 50885148!
assertCartTimeout: aCartId 
	
	| lastUsage |
	
	lastUsage := cartTimeout at: aCartId.
	((Duration minutes: 30) < lastUsage - clock now) ifTrue: [self error: StoreService cartTimeoutErrorDescription.]! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:23:01' prior: 50885169!
assertCartTimeout: aCartId 
	
	| lastUsage now |
	
	lastUsage := cartTimeout at: aCartId.
	now := clock now.
	
	((Duration minutes: 30) < (lastUsage - now)) ifTrue: [self error: StoreService cartTimeoutErrorDescription.].
	
	! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:23:19' prior: 50885179!
assertCartTimeout: aCartId 
	
	| lastUsage now |
	
	lastUsage := cartTimeout at: aCartId.
	now := clock now.
	
	((Duration minutes: 30) < (lastUsage - now)) ifTrue: [self error: StoreService cartTimeoutErrorDescription.].
	
	cartTimeout at: aCartId put: now.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 21:23:27'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 21:23:27'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 21:23:27'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 21:23:27'!
ERROR!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 21:23:27'!
FAILURE!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 21:23:27'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 21:23:27'!
ERROR!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 21:23:27'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 21:23:27'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 21:23:27'!
ERROR!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:23:27'!
ERROR!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 21:24:21'!
ERROR!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 21:25:31' prior: 50884801!
createCartFor: aUsername with: aPassword
		
	| cart cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cart :=	(Cart acceptingItemsOf: catalogue).
	cartId := self nextCartId.
	carts at: cartId put: cart.
	cartTimeout at: cart put: clock now.

	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 21:25:51' prior: 50885245!
createCartFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.

	^latestCartId.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 21:25:57'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:25:57'!
FAILURE!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:25:57'!
FAILURE!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 21:26:33' prior: 50883191!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/8/2021 21:26:40' prior: 50884089!
listCart: aCartId

	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	^(carts at: aCartId) content copy.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 21:26:42'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:26:42'!
FAILURE!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:26:42'!
FAILURE!
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:32:31' prior: 50885189!
assertCartTimeout: aCartId 
	
	| lastUsage now |
	
	lastUsage := cartTimeout at: aCartId.
	now := clock now.
	
	((Duration minutes: 30) < (lastUsage - now)) ifTrue: [self error: StoreService cartTimeoutErrorDescription].
	
	cartTimeout at: aCartId put: now.! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:32:48' prior: 50885383!
assertCartTimeout: aCartId 
	
	| lastUsage now |
	
	lastUsage := cartTimeout at: aCartId.
	now := clock now.
	
	((Duration minutes: 30) < (lastUsage - now)) ifTrue: [^self error: StoreService cartTimeoutErrorDescription].
	
	cartTimeout at: aCartId put: now.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 21:32:49'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:32:49'!
FAILURE!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:32:49'!
FAILURE!
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:33:01' prior: 50885394!
assertCartTimeout: aCartId 
	
	| lastUsage now |
	
	lastUsage := cartTimeout at: aCartId.
	now := clock now.
	
	((Duration minutes: 30) < (lastUsage - now)) ifTrue: [self error: StoreService cartTimeoutErrorDescription].
	
	cartTimeout at: aCartId put: now.! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:33:59' prior: 50885450!
assertCartTimeout: aCartId 
	
	| lastUsage now subs clos |
	
	lastUsage := cartTimeout at: aCartId.
	now := clock now.
	
	subs := (lastUsage - now).
	clos := ((Duration minutes: 30) < subs).
	
	clos ifTrue: [self error: StoreService cartTimeoutErrorDescription].
	
	cartTimeout at: aCartId put: now.! !
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:34:57' prior: 50885461!
assertCartTimeout: aCartId 
	
	| lastUsage now subs clos |
	
	lastUsage := cartTimeout at: aCartId.
	now := clock now.
	
	subs := (now - lastUsage).
	clos := ((Duration minutes: 30) < subs).
	
	clos ifTrue: [self error: StoreService cartTimeoutErrorDescription].
	
	cartTimeout at: aCartId put: now.! !

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:34:58'!
PASSED!
!StoreService methodsFor: 'assertions' stamp: 'PhG 11/8/2021 21:35:19' prior: 50885474!
assertCartTimeout: aCartId 
	
	| lastUsage now |
	
	lastUsage := cartTimeout at: aCartId.
	now := clock now.
	
	((Duration minutes: 30) < (now - lastUsage)) ifTrue: [self error: StoreService cartTimeoutErrorDescription].
	
	cartTimeout at: aCartId put: now.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:35:22'!
PASSED!
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 21:35:52'!
test12OperatingCartJustBeforeExpirationTimeRenewsExpirationDate

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now + (Duration minutes: 31).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 21:35:58'!
test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now + (Duration minutes: 31).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !

!methodRemoval: StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationDate stamp: 'PhG 11/8/2021 21:35:58'!
test12OperatingCartJustBeforeExpirationTimeRenewsExpirationDate

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now + (Duration minutes: 31).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]!
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 21:36:03' prior: 50885565!
test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now + (Duration minutes: 29).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/8/2021 21:37:16' prior: 50885610!
test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now + (Duration minutes: 29).
	
	storeService listCart: cartId.
	
	now := now + (Duration minutes: 25).

	self shouldnt: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error.! !

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/8/2021 21:37:18'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/8/2021 21:37:25'!
PASSED!

----QUIT----(8 November 2021 21:37:30) CuisUniversity-4532.image priorSource: 17683652!

----STARTUP---- (9 November 2021 23:29:04) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!

!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/9/2021 23:31:32'!
test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now + (Duration minutes: 29).
	
	storeService listCart: cartId.
	
	now := now + (Duration minutes: 25).

	self shouldnt: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error.! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/9/2021 23:34:08' prior: 50885799!
test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/9/2021 23:35:25'!
FAILURE!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/9/2021 23:35:50'!
listPurchasesFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.

	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/9/2021 23:36:09' prior: 50885852!
listPurchasesFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
"	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.

	^latestCartId."! !

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/9/2021 23:36:15'!
PASSED!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/9/2021 23:36:36'!
test13ListPurchasesOfValidClientShowsLastPurchase

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/9/2021 23:37:29' prior: 50885929!
test13ListPurchasesOfValidClientShowsLastPurchase

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/9/2021 23:47:54'!
test14ListPurchasesOfValidClientShowsLastPurchase

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !

!methodRemoval: StoreServiceTest #test13ListPurchasesOfValidClientShowsLastPurchase stamp: 'PhG 11/9/2021 23:47:54'!
test13ListPurchasesOfValidClientShowsLastPurchase

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/9/2021 23:48:31' prior: 50885981!
test14ListPurchasesOfValidClientShowsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword).
	! !

----QUIT----(9 November 2021 23:52:10) CuisUniversity-4532.image priorSource: 17732519!

----STARTUP---- (10 November 2021 08:06:26) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!

!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:15:43'!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword).
	
	self assert: purchases size equals: 2.
	! !

!methodRemoval: StoreServiceTest #test14ListPurchasesOfValidClientShowsLastPurchase stamp: 'PhG 11/10/2021 08:15:47'!
test14ListPurchasesOfValidClientShowsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword).
	!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:16:42' prior: 50886057!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword).
	
	self assert: purchases size equals: 1.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:20:52' prior: 50886100!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword).
	
	self assert: purchases size equals: 1.
	self assert: (purchases occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases total equals: testObjectsFactory itemSoldByTheStorePrice.
	! !

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:20:53'!
ERROR!
!Sale class methodsFor: 'instance creation' stamp: 'PhG 11/10/2021 08:22:07' prior: 50880366!
of: aTotal

	aTotal <= 0 ifTrue: [self error: Sale totalIsNotAPositiveNumber.].
	^self new initializeTotal: aTotal.! !
!Sale class methodsFor: 'instance creation' stamp: 'PhG 11/10/2021 08:22:16' prior: 50886153!
of: aTotal

	aTotal <= 0 ifTrue: [self error: Sale totalIsNotAPositiveNumber.].
	
	^self new initializeTotal: aTotal.! !
!Sale class methodsFor: 'nil' stamp: 'PhG 11/10/2021 08:22:34'!
totalIsNotAPositiveNumber
	^'Total must be a positive number'! !
!Sale class methodsFor: 'instance creation' stamp: 'PhG 11/10/2021 08:23:01'!
assertTotalIsPositive: aTotal

	^ aTotal <= 0 ifTrue: [self error: Sale totalIsNotAPositiveNumber.]! !
!Sale class methodsFor: 'instance creation' stamp: 'PhG 11/10/2021 08:23:01' prior: 50886160!
of: aTotal

	self assertTotalIsPositive: aTotal.
	
	^self new initializeTotal: aTotal.! !
!Sale class methodsFor: 'instance creation' stamp: 'PhG 11/10/2021 08:23:33'!
of: aTotal with: someProducts

	self assertTotalIsPositive: aTotal.
	
	^self new initializeTotal: aTotal.! !
!Sale class methodsFor: 'instance creation' stamp: 'PhG 11/10/2021 08:23:42' prior: 50886184!
of: aTotal with: someProducts

	self assertTotalIsPositive: aTotal.
	
	^self new initializeTotal: aTotal withProducts: someProducts.! !
!Cashier methodsFor: 'checkout - private' stamp: 'PhG 11/10/2021 08:24:11' prior: 50880226!
createSale

	^ Sale of: total with: cart content.
! !
!Sale methodsFor: 'initialization' stamp: 'PhG 11/10/2021 08:24:25'!
initializeTotal: aTotal withProducts: someProducts

	total := aTotal.! !

!classDefinition: #Sale category: 'TusLibros' stamp: 'PhG 11/10/2021 08:24:43'!
Object subclass: #Sale
	instanceVariableNames: 'total products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Sale methodsFor: 'initialization' stamp: 'PhG 11/10/2021 08:24:42' prior: 50886203!
initializeTotal: aTotal withProducts: someProducts

	total := aTotal.
	products := someProducts.! !
!Sale methodsFor: 'nil' stamp: 'PhG 11/10/2021 08:24:59'!
products
	^products copy.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:26:30' prior: 50885258!
createCartFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.


	^latestCartId.! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/10/2021 08:31:45'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock cartsByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:31:41' prior: 50886224!
createCartFor: aUsername with: aPassword
		
	| cartId key |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	key := (aUsername,aPassword).
	cartsByUser containsKey: key 
		ifTrue: [ (cartsByUser get: key) add: cartId ]
		ifFalse: [ cartsByUser at: key put: (OrderedCollection with: cartId) ].

	^latestCartId.! !

x _ Dictionary new.							"allocate collection"
x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	!

x at: #a!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:33:29' prior: 50886247!
createCartFor: aUsername with: aPassword
		
	| cartId key |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	key := (aUsername,aPassword).
	cartsByUser containsKey: key 
		ifTrue: [ (cartsByUser at: key) add: cartId ]
		ifFalse: [ cartsByUser at: key put: (OrderedCollection with: cartId) ].

	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:33:44' prior: 50886269!
createCartFor: aUsername with: aPassword
		
	| cartId key |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	key := (aUsername,aPassword).
	cartsByUser includesKey: key 
		ifTrue: [ (cartsByUser at: key) add: cartId ]
		ifFalse: [ cartsByUser at: key put: (OrderedCollection with: cartId) ].

	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:33:51' prior: 50886287!
createCartFor: aUsername with: aPassword
		
	| cartId key |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	key := (aUsername,aPassword).
	(cartsByUser includesKey: key) 
		ifTrue: [ (cartsByUser at: key) add: cartId ]
		ifFalse: [ cartsByUser at: key put: (OrderedCollection with: cartId) ].

	^latestCartId.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/10/2021 08:34:06' prior: 50884892!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	cartsByUser := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/10/2021 08:34:17' prior: 50886323!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	cartsByUser := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := Dictionary new.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/10/2021 08:35:25' prior: 50886341!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	cartsByUser := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:36:18' prior: 50886305!
createCartFor: aUsername with: aPassword
		
	| cartId value |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	value := (aUsername,aPassword).
	(cartsByUser includesKey: value) 
		ifTrue: [ (cartsByUser at: value) add: cartId ]
		ifFalse: [ cartsByUser at: value put: (OrderedCollection with: cartId) ].

	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:36:43' prior: 50886376!
createCartFor: aUsername with: aPassword
		
	| cartId value |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	value := (aUsername,aPassword).
	cartsByUser at: cartId put: value.

	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:36:54' prior: 50886394!
createCartFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	cartsByUser at: cartId put: (aUsername,aPassword).

	^latestCartId.! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/10/2021 08:38:04'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock cartsByUser salesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/10/2021 08:38:02' prior: 50886358!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	cartsByUser := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.
	salesByUser := Dictionary new.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:39:10' prior: 50885315!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	salesByUser at: (cartsByUser at: aCartId) put: salesBook last.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:39:54' prior: 50885864!
listPurchasesFor: aUsername with: aPassword
		
	
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	^(salesByUser at: (aUsername,aPassword)) copy.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:39:59' prior: 50886470!
listPurchasesFor: aUsername with: aPassword
		
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	^(salesByUser at: (aUsername,aPassword)) copy.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:47:22' prior: 50886479!
listPurchasesFor: aUsername with: aPassword

	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	^(salesByUser at: (aUsername,aPassword)) copy.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:48:48' prior: 50886452!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	salesByUser at: (cartsByUser at: aCartId) put: salesBook last.
	cartsByUser removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:51:40' prior: 50886497!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	(salesByUser includesKey: salesByUserKey) 
		ifTrue: [salesByUser at: salesByUserKey put: salesBook last]
		ifFalse: [salesByUser at: salesByUserKey put: (OrderedCollection with: salesBook last)].
	cartsByUser removeKey: aCartId.
	
	^self nextTransactionId.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 08:52:23'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:52:23'!
ERROR!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:52:23'!
ERROR!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:52:50' prior: 50886122!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases size equals: 1.
	self assert: (purchases occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases total equals: testObjectsFactory itemSoldByTheStorePrice.
	! !

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:52:51'!
FAILURE!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:54:14' prior: 50886488!
listPurchasesFor: aUsername with: aPassword

	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	^(salesByUser at: (aUsername,aPassword)) at: 1 copy.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 08:54:17'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:54:17'!
ERROR!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:54:17'!
ERROR!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:54:46' prior: 50886630!
listPurchasesFor: aUsername with: aPassword

	| salesCollection |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	salesCollection := (salesByUser at: (aUsername,aPassword)).
	
	^salesCollection at: 1 copy.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:55:00' prior: 50886696!
listPurchasesFor: aUsername with: aPassword

	| salesCollection |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	salesCollection := (salesByUser at: (aUsername,aPassword)).
	
	^salesCollection first copy.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 08:55:02'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:55:02'!
ERROR!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:55:02'!
ERROR!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:56:05' prior: 50886707!
listPurchasesFor: aUsername with: aPassword

	| sale |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	sale := (salesByUser at: (aUsername,aPassword)) first.
	
	^sale content->sale total.! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:56:27' prior: 50886599!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases first size equals: 1.
	self assert: (purchases first occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases second equals: testObjectsFactory itemSoldByTheStorePrice.
	! !

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:56:28'!
ERROR!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:56:43' prior: 50886775!
listPurchasesFor: aUsername with: aPassword

	| sale |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	sale := (salesByUser at: (aUsername,aPassword)) first.
	
	^sale products ->sale total.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 08:56:47' prior: 50886816!
listPurchasesFor: aUsername with: aPassword

	| sale |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	sale := (salesByUser at: (aUsername,aPassword)) first.
	
	^sale products -> sale total.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 08:56:48'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:56:48'!
ERROR!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:56:48'!
ERROR!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:57:04' prior: 50886785!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 1.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases value equals: testObjectsFactory itemSoldByTheStorePrice.
	! !

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 08:57:05'!
PASSED!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:57:26'!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 1.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases value equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:57:54' prior: 50886979!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: cartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 1.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases value equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:58:02' prior: 50887007!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: cartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 1.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases value equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:58:04' prior: 50887043!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: cartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 1.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases value equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:58:30' prior: 50887080!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: cartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 4.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases key occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	self assert: purchases value equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 08:58:48' prior: 50887118!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: cartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 4.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases key occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	self assert: purchases value equals: (testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStore * 2).
	! !

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 08:58:50'!
ERROR!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 08:59:04'!
ERROR!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 09:00:10' prior: 50887159!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: anotherCartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: anotherCartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 4.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases key occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	self assert: purchases value equals: (testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStore * 2).
	! !

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:00:12'!
ERROR!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 09:01:39' prior: 50886516!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	(salesByUser includesKey: salesByUserKey) 
		ifTrue: [salesByUser at: salesByUserKey put: ((salesByUser at: salesByUserKey) add: salesBook last)]
		ifFalse: [salesByUser at: salesByUserKey put: (OrderedCollection with: salesBook last)].
	cartsByUser removeKey: aCartId.
	
	^self nextTransactionId.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 09:01:45'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:01:45'!
ERROR!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:01:45'!
ERROR!

salesByUser includesKey: salesByUserKey!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 09:05:17' prior: 50887258!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	(salesByUser includesKey: salesByUserKey) 
		ifTrue: [salesByUser at: salesByUserKey put: ((salesByUser at: salesByUserKey) add: (salesBook last))]
		ifFalse: [salesByUser at: salesByUserKey put: (OrderedCollection with: salesBook last)].
	cartsByUser removeKey: aCartId.
	
	^self nextTransactionId.! !

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:05:57'!
ERROR!

x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	"add element to collection"!

x _ Dictionary new.							"allocate collection"
x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	"add element to collection"!

x at: #a ifPresent: [x at: #a + 1]!

x at: #a ifPresent: [(x at: #a) + 1]!

x _ Dictionary new.							"allocate collection"
x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	"add element to collection"

x at: #a ifPresent: [(x at: #a) + 1]!

x _ Dictionary new.							"allocate collection"
x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	"add element to collection"

x at: #a ifPresent: [x at: #a]!

x _ Dictionary new.							"allocate collection"
x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	"add element to collection"

x at: #a ifPresent: [:val | val+1]!

x _ Dictionary new.							"allocate collection"
x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	"add element to collection"

x at: #a ifAbsent: [x+1]!

x _ Dictionary new.							"allocate collection"
x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	"add element to collection"

x at: #a ifAbsent: [x at: #a +1]!

x at: #a ifAbsent: [x at: #a +1]!

 4 !

 4 !

 4 !

x at: #e ifAbsent: [x at: #e put: OrderedCollection new]!

x _ Dictionary new.							"allocate collection"
x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	"add element to collection"

x at: #e ifAbsent: [x at: #e put: OrderedCollection new].!

x _ Dictionary new.							"allocate collection"
x add: #a->4; add: #b->3; add: #c->1; add: #d->2; yourself.	"add element to collection"

x at: #e ifAbsent: [x at: #e put: OrderedCollection new].!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 09:11:47' prior: 50887348!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	(salesByUser at: salesByUserKey) 
		ifPresent: [:userSales | userSales add: salesBook last]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: salesBook last)].
	cartsByUser removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 09:12:17' prior: 50887431!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	salesByUser at: salesByUserKey
		ifPresent: [:userSales | userSales add: salesBook last]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: salesBook last)].
	cartsByUser removeKey: aCartId.
	
	^self nextTransactionId.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 09:12:21'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:12:21'!
FAILURE!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:12:21'!
FAILURE!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 09:14:32' prior: 50886826!
listPurchasesFor: aUsername with: aPassword

	| allProducts total |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	allProducts := Bag new.
	total := 0.
	
	(salesByUser at: (aUsername,aPassword)) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	].
	
	^allProducts->total.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 09:14:37'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 09:14:37'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 09:14:37'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 09:14:37'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 09:14:38'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:14:38'!
ERROR!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:14:38'!
ERROR!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 09:14:51' prior: 50887210!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: anotherCartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: anotherCartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 4.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases key occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	self assert: purchases value equals: (testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	! !

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:14:54'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 09:14:57'!
PASSED!

----QUIT----(10 November 2021 09:15:06) CuisUniversity-4532.image priorSource: 17740764!

----STARTUP---- (10 November 2021 09:22:18) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


----QUIT----(10 November 2021 09:42:57) CuisUniversity-4532.image priorSource: 17795817!

----STARTUP---- (10 November 2021 16:59:23) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!

!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 18:05:05' prior: 50885820!
test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:15:56' prior: 50886408!
createCartFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	cartsByUser at: cartId put: aUsername.

	^latestCartId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:16:12' prior: 50887543!
listPurchasesFor: aUsername with: aPassword

	| allProducts total |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	allProducts := Bag new.
	total := 0.
	
	(salesByUser at: aUsername) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	].
	
	^allProducts->total.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:16:21'!
ERROR!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:16:21'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:16:21'!
ERROR!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/9/2021 23:34:08' prior: 50887785!
test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:17:21'!
PASSED!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:23:58' prior: 50887456!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	salesByUser at: salesByUserKey
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: salesBook last)].
	cartsByUser removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:24:14' prior: 50887986!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	salesByUser at: salesByUserKey
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: sale)].
	cartsByUser removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'checkout' stamp: 'PhG 11/10/2021 18:24:20' prior: 50883228!
checkout: aCart chargingOn: aCreditCard 
	
	| cashier |

	cashier := Cashier toCheckout: aCart 
					charging: aCreditCard 
					throught: merchantProcessor 
					on: (DateAndTime now) 
					registeringOn: salesBook.
	^cashier checkOut.! !
!Cashier methodsFor: 'checkout - private' stamp: 'PhG 11/10/2021 18:24:41'!
registerSale: sale

	salesBook add: sale.! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/10/2021 18:25:03' prior: 50880239!
checkOut

	| sale |
	self calculateTotal.
	self debitTotal.
	sale := (self createSale).
	self registerSale: sale.

	^ sale.! !
!Cashier methodsFor: 'checkout' stamp: 'PhG 11/10/2021 18:25:07' prior: 50888049!
checkOut

	| sale |

	self calculateTotal.
	self debitTotal.
	sale := (self createSale).
	self registerSale: sale.

	^ sale.! !

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/10/2021 18:25:09'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/10/2021 18:25:09'!
FAILURE!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/10/2021 18:25:09'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/10/2021 18:25:09'!
FAILURE!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/10/2021 18:25:09'!
FAILURE!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/10/2021 18:25:09'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'PhG 11/10/2021 18:25:19' prior: 50879752!
test02CalculatedTotalIsCorrect

	| cart cashier |
	
	cart := testObjectsFactory createCart.
	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	
	cashier :=  Cashier
		toCheckout: cart 
		charging: testObjectsFactory creditCardNonExpired 
		throught: self
		on: testObjectsFactory today 
		registeringOn: OrderedCollection new.
		
	self assert: cashier checkOut total = (testObjectsFactory itemSoldByTheStorePrice * 2)! !
!CashierTest methodsFor: 'tests' stamp: 'PhG 11/10/2021 18:25:32' prior: 50879789!
test04CheckoutRegistersASale

	| cart cashier salesBook total |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart 
		charging: testObjectsFactory creditCardNonExpired
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	total := cashier checkOut total.
					
	self assert: salesBook size = 1.
	self assert: salesBook first total = total.! !
!CashierTest methodsFor: 'tests' stamp: 'PhG 11/10/2021 18:25:38' prior: 50879807!
test05CashierChargesCreditCardUsingMerchantProcessor

	| cart cashier salesBook total creditCard debitedAmout debitedCreditCard  |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	creditCard := testObjectsFactory creditCardNonExpired.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart 
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	debitBehavior := [ :anAmount :aCreditCard | 
		debitedAmout := anAmount.
		debitedCreditCard := aCreditCard ].
	total := cashier checkOut total.
					
	self assert: debitedCreditCard = creditCard.
	self assert: debitedAmout = total.! !

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/10/2021 18:25:39'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/10/2021 18:25:39'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/10/2021 18:25:39'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/10/2021 18:25:39'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/10/2021 18:25:39'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/10/2021 18:25:39'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:25:43'!
PASSED!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:26:15' prior: 50888011!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	salesByUser at: salesByUserKey
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: sale)].
	cartsByUser removeKey: aCartId.
	carts removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:26:25' prior: 50888266!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	salesByUser at: salesByUserKey
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: sale)].
	cartsByUser removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:26:34'!
PASSED!

!methodRemoval: Sale class #of: stamp: 'PhG 11/10/2021 18:28:28'!
of: aTotal

	self assertTotalIsPositive: aTotal.
	
	^self new initializeTotal: aTotal.!

!methodRemoval: Sale #initializeTotal: stamp: 'PhG 11/10/2021 18:28:32'!
initializeTotal: aTotal

	total := aTotal.!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:28:38'!
PASSED!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 18:30:21' prior: 50887900!
test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	"debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService."

	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:30:24'!
PASSED!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 18:30:31' prior: 50888534!
test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError

	| storeService |

	storeService := self storeServiceAuthenticatingUsers.

	authenticationBehaviour := [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 18:30:56' prior: 50888625!
test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError

	| storeService |

	storeService := self storeServiceWithAuthenticationBehaviour: [:aUsername :aPassword | self error: StoreService invalidCredentialsErrorDesciption].
	
	self should: [ storeService listPurchasesFor: (testObjectsFactory invalidUser) with: (testObjectsFactory invalidPassword)]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService invalidCredentialsErrorDesciption.]! !

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:30:57'!
PASSED!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:33:18' prior: 50888291!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	salesByUser at: salesByUserKey
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: sale)].
	
	cartsByUser removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:34:14'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock cartsByUser usersByCart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:34:14' prior: 50886433!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	cartsByUser := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.
	usersByCart := Dictionary new.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:34:14' prior: 50888726!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	usersByCart at: salesByUserKey
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ usersByCart at: salesByUserKey put: (OrderedCollection with: sale)].
	
	cartsByUser removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:34:14' prior: 50887824!
listPurchasesFor: aUsername with: aPassword

	| allProducts total |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	allProducts := Bag new.
	total := 0.
	
	(usersByCart at: aUsername) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	].
	
	^allProducts->total.! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:35:01'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock cartsByUser salesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:35:01' prior: 50888764!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	cartsByUser := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.
	salesByUser := Dictionary new.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:35:01' prior: 50888783!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (cartsByUser at: aCartId).
	salesByUser at: salesByUserKey
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: sale)].
	
	cartsByUser removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:35:01' prior: 50888810!
listPurchasesFor: aUsername with: aPassword

	| allProducts total |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	allProducts := Bag new.
	total := 0.
	
	(salesByUser at: aUsername) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	].
	
	^allProducts->total.! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:35:08'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock usersByCart salesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:35:08' prior: 50887811!
createCartFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	usersByCart at: cartId put: aUsername.

	^latestCartId.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:35:08' prior: 50888854!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (usersByCart at: aCartId).
	salesByUser at: salesByUserKey
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: sale)].
	
	usersByCart removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:35:08' prior: 50888835!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	usersByCart := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.
	salesByUser := Dictionary new.! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:35:14'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock userByCart salesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:35:14' prior: 50888906!
createCartFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	userByCart at: cartId put: aUsername.

	^latestCartId.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:35:14' prior: 50888919!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart salesByUserKey sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	salesByUserKey := (userByCart at: aCartId).
	salesByUser at: salesByUserKey
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: salesByUserKey put: (OrderedCollection with: sale)].
	
	userByCart removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:35:14' prior: 50888946!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	userByCart := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.
	salesByUser := Dictionary new.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:35:24' prior: 50888989!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart userForCart sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	userForCart := (userByCart at: aCartId).
	salesByUser at: userForCart
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: userForCart put: (OrderedCollection with: sale)].
	
	userByCart removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:42:48' prior: 50889035!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart userForCart sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	userForCart := (userByCart at: aCartId).
	salesByUser at: userForCart
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: userForCart put: (OrderedCollection with: sale)].
		
	userByCart removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !

Object subclass: #UserService
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:42:58'!
Object subclass: #UserService
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!UserService methodsFor: 'nil' stamp: 'PhG 11/10/2021 18:43:14'!
purchasesFor: aUsername! !
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:43:29'!
registerPurchase: aPurchase for: aUsername! !
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:43:42'!
userFor: aCartId! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:45:51' prior: 50889061!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart userForCart sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	
	
	userForCart := (userByCart at: aCartId).
	salesByUser at: userForCart
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: userForCart put: (OrderedCollection with: sale)].
		
	userByCart removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:46:05'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock userByCart salesByUser userService'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/10/2021 18:46:03' prior: 50889016!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	userByCart := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.
	salesByUser := Dictionary new.
	userService := UserService new.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:46:56' prior: 50889109!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart userForCart sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	
	userService registerPurchase: sale for: (userService userFor: aCartId).
	
"	userForCart := (userByCart at: aCartId).
	salesByUser at: userForCart
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: userForCart put: (OrderedCollection with: sale)]."
		
	userByCart removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:47:03' prior: 50889167!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart userForCart sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	userService registerPurchase: sale for: (userService userFor: aCartId).
	
"	userForCart := (userByCart at: aCartId).
	salesByUser at: userForCart
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: userForCart put: (OrderedCollection with: sale)]."
		
	userByCart removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:47:54' prior: 50888881!
listPurchasesFor: aUsername with: aPassword

	| allProducts total |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	allProducts := Bag new.
	total := 0.
	
	userService .
	
	(salesByUser at: aUsername) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	].
	
	^allProducts->total.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:48:16' prior: 50889225!
listPurchasesFor: aUsername with: aPassword

	| allProducts total |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	allProducts := Bag new.
	total := 0.
	
	^userService purchasesFor: aUsername.
	
	"(salesByUser at: aUsername) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	].
	
	^allProducts->total."! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 18:48:57' prior: 50888976!
createCartFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	userByCart at: cartId put: aUsername.
	userService registerCart: cartId for: aUsername.

	^latestCartId.! !
!UserService methodsFor: 'nil' stamp: 'PhG 11/10/2021 18:49:09'!
registerCart: aCartId for: aUsername! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:49:34'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:49:34'!
ERROR!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:49:34'!
ERROR!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 18:50:15'!
test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal

	| storeService cartId purchases anotherCartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: anotherCartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: anotherCartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 4.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases key occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	self assert: purchases value equals: (testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 18:50:35' prior: 50889330!
test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 0.
	self assert: purchases value equals: 0.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/10/2021 18:50:44' prior: 50889374!
test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal

	| storeService purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	self createCartForValidUserIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases key size equals: 0.
	self assert: purchases value equals: 0.
	! !

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/10/2021 18:50:52'!
ERROR!

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:51:52'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:51:51' prior: 50889268!
registerCart: aCartId for: aUsername

	usersByCart at: aCartId put: aUsername.! !
!UserService methodsFor: 'nil' stamp: 'PhG 11/10/2021 18:52:05' overrides: 16896425!
initialize
	usersByCart := Dictionary new.! !
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:52:28' prior: 50889105!
userFor: aCartId

	^usersByCart at: aCartId! !
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:52:29' prior: 50889433!
userFor: aCartId

	^usersByCart at: aCartId.! !
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:52:36' prior: 50889438!
userFor: aCartId

	"assert user exists?"

	^usersByCart at: aCartId.! !
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:53:41' prior: 50889101!
registerPurchase: aPurchase for: aUsername

	! !

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:54:21'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:54:31'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser salesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:54:34'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser salesByUser userForCart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:54:20' prior: 50889449!
registerPurchase: aPurchase for: aUsername

	| sale |
	purchasesByUser at: aUsername
		ifPresent: [:userSales | userSales add: sale]
		ifAbsent: [ salesByUser at: userForCart put: (OrderedCollection with: sale)].! !
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:54:51' prior: 50889478!
registerPurchase: aPurchase for: aUsername

	purchasesByUser at: aUsername
		ifPresent: [:userSales | userSales add: aPurchase]
		ifAbsent: [ purchasesByUser at: aUsername put: (OrderedCollection with: aPurchase)].! !

Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/10/2021 18:54:57'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!UserService methodsFor: 'initialization' stamp: 'PhG 11/10/2021 18:55:14' prior: 50889428 overrides: 16896425!
initialize
	usersByCart := Dictionary new.
	purchasesByUser := Dictionary new.! !
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 18:56:14' prior: 50889097!
purchasesFor: aUsername

	| allProducts total |
	
	allProducts := Bag new.
	total := 0.
	
	(purchasesByUser at: aUsername) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	].
	
	^allProducts->total.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:56:55'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:56:56'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:56:56'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:56:56'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:56:56'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:56:56'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:56:56'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:56:56'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/10/2021 18:56:56'!
ERROR!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/10/2021 18:56:56'!
ERROR!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:57:52'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/10/2021 18:57:52'!
ERROR!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/10/2021 18:57:52'!
ERROR!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 18:59:59'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/10/2021 18:59:59'!
ERROR!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/10/2021 18:59:59'!
ERROR!
!UserService methodsFor: 'as yet unclassified' stamp: 'PhG 11/10/2021 19:01:16' prior: 50889517!
purchasesFor: aUsername

	| allProducts total |
	
	(purchasesByUser includesKey: aUsername) ifFalse: [^OrderedCollection new->0].
	
	allProducts := Bag new.
	total := 0.
	
	(purchasesByUser at: aUsername) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	].
	
	^allProducts->total.! !

----QUIT----(10 November 2021 19:01:21) CuisUniversity-4532.image priorSource: 17796039!

----STARTUP---- (10 November 2021 19:01:25) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/10/2021 19:01:39'!
PASSED!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 19:01:55' prior: 50889196!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	userService registerPurchase: sale for: (userService userFor: aCartId).
		
	userByCart removeKey: aCartId.
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 19:02:08' prior: 50889239!
listPurchasesFor: aUsername with: aPassword

	| allProducts total |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	allProducts := Bag new.
	total := 0.
	
	^userService purchasesFor: aUsername.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 19:02:16' prior: 50889876!
listPurchasesFor: aUsername with: aPassword

	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	^userService purchasesFor: aUsername.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 19:02:29' prior: 50889254!
createCartFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	userService registerCart: cartId for: aUsername.

	^latestCartId.! !

Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock userService'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreService category: 'TusLibros' stamp: 'PhG 11/10/2021 19:02:39'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock userService'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/10/2021 19:02:51' prior: 50889854!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard cart sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	cart := carts at: aCartId.
	
	sale := self checkout: cart chargingOn: creditCard.
	
	userService registerPurchase: sale for: (userService userFor: aCartId).
		
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'initialization' stamp: 'PhG 11/10/2021 19:03:04' prior: 50889147!
initializeWithAuthService: anAuthenticationService withMerchantProcessor: aMerchantProcessor withCatalogue: aCatalogue withClock: aClock
	
	authenticationService := anAuthenticationService.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	catalogue := aCatalogue.
	carts := Dictionary new.
	cartTimeout := Dictionary new.
	latestCartId := 0.
	latestTransactionId := 0.
	salesBook := OrderedCollection new.
	userService := UserService new.! !

Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/10/2021 19:08:20'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----QUIT----(10 November 2021 19:08:44) CuisUniversity-4532.image priorSource: 17860287!

----STARTUP---- (11 November 2021 07:52:15) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!methodRemoval: Cashier #registerSale stamp: 'PhG 11/11/2021 07:53:34'!
registerSale

	salesBook add: (self createSale).!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 07:56:21' prior: 50882554!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId transactionId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: 1 equals: transactionId.! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 07:57:25' prior: 50889988!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: purchases key size equals: 1.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore ) equals: 1.! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 07:57:30' prior: 50890010!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: purchases key size equals: 1.
	self assert: (purchases key occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.! !

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/11/2021 07:58:17'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/11/2021 07:58:34'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser products productsa'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/11/2021 07:58:35'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser products productsa totala'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!UserService methodsFor: 'initialization' stamp: 'PhG 11/11/2021 07:58:33' prior: 50889511 overrides: 16896425!
initialize
	usersByCart := Dictionary new.
	purchasesByUser := Dictionary new.
	productsa := Bag new.
	totala := 0.! !
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 07:59:14' prior: 50889488!
registerPurchase: aPurchase for: aUsername

	products addAll: aPurchase products.

	purchasesByUser at: aUsername
		ifPresent: [:userSales | userSales add: aPurchase]
		ifAbsent: [ purchasesByUser at: aUsername put: (OrderedCollection with: aPurchase)].! !
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 07:59:34' prior: 50890092!
registerPurchase: aPurchase for: aUsername

	products addAll: aPurchase products.
	totala := totala + aPurchase total.

	purchasesByUser at: aUsername
		ifPresent: [:userSales | userSales add: aPurchase]
		ifAbsent: [ purchasesByUser at: aUsername put: (OrderedCollection with: aPurchase)].! !
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 07:59:41' prior: 50889772!
purchasesFor: aUsername

	| allProducts total |
	
	(purchasesByUser includesKey: aUsername) ifFalse: [^OrderedCollection new->0].
	
	"allProducts := Bag new.
	total := 0.
	
	(purchasesByUser at: aUsername) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	]."
	
	^allProducts->total.! !

Object subclass: #UserPurchase
	instanceVariableNames: 'products total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #UserPurchase category: 'TusLibros' stamp: 'PhG 11/11/2021 08:00:55'!
Object subclass: #UserPurchase
	instanceVariableNames: 'products total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!UserPurchase methodsFor: 'nil' stamp: 'PhG 11/11/2021 08:01:16'!
addPr! !

!classRenamed: #UserPurchase as: #UserPurchases stamp: 'PhG 11/11/2021 08:01:34'!
Smalltalk renameClassNamed: #UserPurchase as: #UserPurchases!
!UserPurchases methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 08:01:40' prior: 50890139!
addPr! !
!UserPurchases methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 08:01:48'!
addPurchase! !

!methodRemoval: UserPurchases #addPr stamp: 'PhG 11/11/2021 08:01:48'!
addPr!
!UserPurchases methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 08:01:55'!
addPurchase: aPurchase! !

!methodRemoval: UserPurchases #addPurchase stamp: 'PhG 11/11/2021 08:01:58'!
addPurchase!
!UserPurchases methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 08:02:20' prior: 50890156!
addPurchase: aPurchase
	products addAll: aPurchase products.
	total := total + aPurchase total.! !
!UserPurchases methodsFor: 'nil' stamp: 'PhG 11/11/2021 08:02:37'!
products
	^products! !
!UserPurchases methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 08:02:43'!
total
	^total! !
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 08:03:24' prior: 50890103!
registerPurchase: aPurchase for: aUsername

	products addAll: aPurchase products.
	totala := totala + aPurchase total.

	purchasesByUser at: aUsername
		ifPresent: [:userSales | userSales add: aPurchase]
		ifAbsent: [ purchasesByUser at: aUsername put: (UserPurchases with: aPurchase)].! !
!UserPurchases methodsFor: 'nil' stamp: 'PhG 11/11/2021 08:04:15'!
initializeWithPurchase: aPurchase
	products := Bag with: aPurchase products.
	total := aPurchase total.! !
!UserPurchases methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 08:04:16' prior: 50890189!
initializeWithPurchase: aPurchase

	products := Bag with: aPurchase products.
	total := aPurchase total.! !
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 08:04:31' prior: 50890177!
registerPurchase: aPurchase for: aUsername

	products addAll: aPurchase products.
	totala := totala + aPurchase total.

	purchasesByUser at: aUsername
		ifPresent: [:userSales | userSales addPurchase: aPurchase]
		ifAbsent: [ purchasesByUser at: aUsername put: (UserPurchases with: aPurchase)].! !

Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #UserService category: 'TusLibros' stamp: 'PhG 11/11/2021 08:04:37'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 08:04:43' prior: 50890203!
registerPurchase: aPurchase for: aUsername

	purchasesByUser at: aUsername
		ifPresent: [:userSales | userSales addPurchase: aPurchase]
		ifAbsent: [ purchasesByUser at: aUsername put: (UserPurchases with: aPurchase)].! !
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 08:05:33' prior: 50890115!
purchasesFor: aUsername

	
	
	(purchasesByUser includesKey: aUsername) ifFalse: [^OrderedCollection new->0].
	
	"allProducts := Bag new.
	total := 0.
	
	(purchasesByUser at: aUsername) do: [:aSale |
		allProducts addAll: aSale products.
		total := total + aSale total.
	]."
	
	^purchasesByUser at: aUsername.! !
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 08:05:53' prior: 50890238!
purchasesFor: aUsername
	
	(purchasesByUser includesKey: aUsername) ifFalse: [^OrderedCollection new->0].
	

	^purchasesByUser at: aUsername.! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:06:23' prior: 50889393!
test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal

	| storeService purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	self createCartForValidUserIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 0.
	self assert: purchases total equals: 0.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:06:42' prior: 50887619!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: anotherCartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: anotherCartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases products occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	self assert: purchases value equals: (testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:06:45' prior: 50890277!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: anotherCartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: anotherCartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases products occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	self assert: purchases total equals: (testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:06:50' prior: 50886894!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases total equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 08:07:08' prior: 50890251!
purchasesFor: aUsername
	
	(purchasesByUser includesKey: aUsername) ifFalse: [^OrderedCollection new->0].

	^purchasesByUser at: aUsername.! !
!UserService methodsFor: 'purchases' stamp: 'PhG 11/11/2021 08:07:20' prior: 50890392!
purchasesFor: aUsername
	
	(purchasesByUser includesKey: aUsername) ifFalse: [^UserPurchases new].

	^purchasesByUser at: aUsername.! !
!UserPurchases methodsFor: 'initialization' stamp: 'PhG 11/11/2021 08:07:45' overrides: 16896425!
initialize
	products := Bag new.
	total := 0.! !
!UserPurchases class methodsFor: 'nil' stamp: 'PhG 11/11/2021 08:08:32'!
with: aPurchase

	^UserPurchases basicNew initializeWithPurchase: aPurchase.! !
!UserService methodsFor: 'user' stamp: 'PhG 11/11/2021 08:09:11' prior: 50889443!
userFor: aCartId

	^usersByCart at: aCartId.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/11/2021 08:09:14'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/11/2021 08:09:15'!
ERROR!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/11/2021 08:09:15'!
FAILURE!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:09:15'!
FAILURE!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:09:15'!
PASSED!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 08:09:31' prior: 50890035!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:09:33'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/11/2021 08:09:33'!
FAILURE!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/11/2021 08:09:33'!
FAILURE!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:09:33'!
FAILURE!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/11/2021 08:09:35'!
FAILURE!
!UserPurchases methodsFor: 'initialization' stamp: 'PhG 11/11/2021 08:10:13' prior: 50890196!
initializeWithPurchase: aPurchase

	products := aPurchase products.
	total := aPurchase total.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:10:16'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:10:18'!
PASSED!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 08:10:48'!
test10CheckoutWithValidCartCreatesAPurchaseContainingItems

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.! !

!methodRemoval: StoreServiceTest #test10CheckoutWithValidCartShouldReturnTransactionId stamp: 'PhG 11/11/2021 08:10:48'!
test10CheckoutWithValidCartShouldReturnTransactionId

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	debitBehavior := [ :anAmount :aCreditCard | true ].
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.!
!StoreServiceTest methodsFor: 'store service creation' stamp: 'PhG 11/11/2021 08:13:20' prior: 50885089!
storeServiceWithAuthenticationBehaviour: anAuthenticationBehaviour

	debitBehavior := [ :anAmount :aCreditCard | true ].
	authenticationBehaviour := anAuthenticationBehaviour.
	now := DateAndTime now.

	^StoreService 
		withAuthService: self 
		withMerchantProcessor: self 
		withCatalogue: testObjectsFactory defaultCatalogue
		withClock: self.! !

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartCreatesAPurchaseContainingItems stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:13:22'!
PASSED!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 08:13:36' prior: 50890844!
test10CheckoutWithValidCartCreatesAPurchaseContainingItems

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/11/2021 08:13:45' prior: 50885102!
test11OperatingCartAfterExpirationTimeThrowsTimeoutError

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now + (Duration minutes: 31).

	self should: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error
		withExceptionDo: [ :anError | self assert: anError messageText = StoreService cartTimeoutErrorDescription. ]! !
!StoreServiceTest methodsFor: 'timer tests' stamp: 'PhG 11/11/2021 08:13:50' prior: 50885632!
test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime

	| storeService cartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	now := now + (Duration minutes: 29).
	
	storeService listCart: cartId.
	
	now := now + (Duration minutes: 25).

	self shouldnt: [ self checkoutCart: cartId usingValidCreditCardIn: storeService.]
		raise: Error.! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:14:00' prior: 50890365!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases total equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:14:05' prior: 50890321!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: anotherCartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: anotherCartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases products occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	self assert: purchases total equals: (testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:14:13' prior: 50890259!
test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal

	| storeService purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	self createCartForValidUserIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 0.
	self assert: purchases total equals: 0.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:15:26' prior: 50891061!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: anotherCartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	storeService addToCart: anotherCartId quantity: 2 of:  (testObjectsFactory anotherItemSoldByTheStore).
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases products occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	expectedTotal := 	(testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:19:14'!
addTo: aCartId quantity: anAmount ofItemSoldByStore: aStoreService

	| itemToAdd |
	
	itemToAdd := testObjectsFactory itemSoldByTheStore.
	
	aStoreService addToCart: aCartId quantity: anAmount of: itemToAdd.
	^itemToAdd.
! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:19:23' prior: 50891165!
addTo: aCartId quantity: anAmount ofItemSoldByStore: aStoreService

	| itemToAdd |
	
	itemToAdd := testObjectsFactory itemSoldByTheStore.
	aStoreService addToCart: aCartId quantity: anAmount of: itemToAdd.

	^itemToAdd.
! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:19:27'!
addTo: aCartId quantity: anAmount ofAnotherItemSoldByStore: aStoreService

	| itemToAdd |
	
	itemToAdd := testObjectsFactory itemSoldByTheStore.
	aStoreService addToCart: aCartId quantity: anAmount of: itemToAdd.

	^itemToAdd.
! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:19:31' prior: 50891186!
addTo: aCartId quantity: anAmount ofAnotherItemSoldByStore: aStoreService

	| itemToAdd |
	
	itemToAdd := testObjectsFactory anotherItemSoldByTheStore .
	aStoreService addToCart: aCartId quantity: anAmount of: itemToAdd.

	^itemToAdd.
! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:19:32' prior: 50891197!
addTo: aCartId quantity: anAmount ofAnotherItemSoldByStore: aStoreService

	| itemToAdd |
	
	itemToAdd := testObjectsFactory anotherItemSoldByTheStore.
	aStoreService addToCart: aCartId quantity: anAmount of: itemToAdd.

	^itemToAdd.
! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:20:33' prior: 50891035!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases addedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	addedItem := self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: addedItem) equals: 1.
	self assert: purchases total equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:21:38' prior: 50891121!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	addedItem := self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	otherAddedItem := self addTo: anotherCartId quantity: 2 ofAnotherItemSoldByStore: storeService.
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 2.
	self assert: (purchases products occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.
	expectedTotal := 	(testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:22:01' prior: 50891244!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	addedItem := self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	otherAddedItem := self addTo: anotherCartId quantity: 2 ofAnotherItemSoldByStore: storeService.
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: addedItem ) equals: 2.
	self assert: (purchases products occurrencesOf: otherAddedItem ) equals: 2.
	expectedTotal := 	(testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:22:04' prior: 50891287!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	addedItem := self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	otherAddedItem := self addTo: anotherCartId quantity: 2 ofAnotherItemSoldByStore: storeService.
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: addedItem) equals: 2.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 2.
	expectedTotal := 	(testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:22:22' prior: 50891329!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	addedItem := self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addTo: anotherCartId quantity: 1 ofItemSoldByStore: storeService.
	otherAddedItem := self addTo: anotherCartId quantity: 2 ofAnotherItemSoldByStore: storeService.
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: addedItem) equals: 2.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 2.
	expectedTotal := 	(testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:24:15'!
addAndCheckout: aCartId quantity: anAmount ofItem: anItem inStore: aStoreService

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	addedItem := self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addTo: anotherCartId quantity: 1 ofItemSoldByStore: storeService.
	otherAddedItem := self addTo: anotherCartId quantity: 2 ofAnotherItemSoldByStore: storeService.
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: addedItem) equals: 2.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 2.
	expectedTotal := 	(testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:25:03' prior: 50891412!
addAndCheckout: aCartId quantity: anAmount ofItem: anItem inStore: aStoreService


	aStoreService addToCart: aCartId quantity: anAmount of: anItem.
	self checkoutCart: aCartId usingValidCreditCardIn: aStoreService.
! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:25:05' prior: 50891454!
addAndCheckout: aCartId quantity: anAmount ofItem: anItem inStore: aStoreService

	aStoreService addToCart: aCartId quantity: anAmount of: anItem.
	self checkoutCart: aCartId usingValidCreditCardIn: aStoreService.
! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:26:27' prior: 50891219!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases addedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	
	self addAndCheckout: cartId quantity: 1 ofItem: addedItem inStore: testObjectsFactory itemSoldByTheStore.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases total equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:26:41' prior: 50891476!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	
	self addAndCheckout: cartId quantity: 1 ofItem: testObjectsFactory itemSoldByTheStore inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: purchases total equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:28:10' prior: 50891371!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: testObjectsFactory itemSoldByTheStore inStore: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addTo: anotherCartId quantity: 1 ofItemSoldByStore: storeService.
	otherAddedItem := self addTo: anotherCartId quantity: 2 ofAnotherItemSoldByStore: storeService.
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: addedItem) equals: 2.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 2.

	expectedTotal := 	(testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:28:54' prior: 50891526!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	addedItem := self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addTo: anotherCartId quantity: 1 ofItemSoldByStore: storeService.
	otherAddedItem := self addTo: anotherCartId quantity: 2 ofAnotherItemSoldByStore: storeService.
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: addedItem) equals: 2.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 2.
	expectedTotal := 	(testObjectsFactory itemSoldByTheStorePrice * 2) + (testObjectsFactory anotherItemSoldByTheStorePrice * 2).
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list carts tests' stamp: 'PhG 11/11/2021 08:30:19' prior: 50883956!
test07ListCartsShouldWorkWithDifferentCarts

	| storeService cartId anotherCartId cartContent anotherCartContent |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	anotherCartId  := self createCartForValidUserIn: storeService.
	
	storeService addToCart: cartId quantity: 1 of: testObjectsFactory itemSoldByTheStore.
	storeService addToCart: anotherCartId quantity: 2 of: testObjectsFactory anotherItemSoldByTheStore.
	
	cartContent := storeService listCart: cartId.
	anotherCartContent := storeService listCart: anotherCartId.

	self assert: cartContent size equals: 1.
	self assert: (cartContent occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.
	self assert: anotherCartContent size equals: 2.
	self assert: (anotherCartContent occurrencesOf: testObjectsFactory anotherItemSoldByTheStore) equals: 2.! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 08:31:53'!
assert: aPurchase hasOnly: anAmount of: anItem

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: purchases products size equals: 1.
	self assert: (purchases products occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1.! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 08:32:47' prior: 50891640!
assert: aPurchase hasOnly: anAmount of: anItem

	| products | 
	
	products := aPurchase products.

	self assert: products size equals: anAmount.
	self assert: (products occurrencesOf: anItem) equals: anAmount.! !
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 08:33:11' prior: 50890972!
test10CheckoutWithValidCartCreatesAPurchaseContainingItems

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	storeService addToCart: cartId quantity: 1 of:  (testObjectsFactory itemSoldByTheStore ).
	
	self checkoutCart: cartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: purchases hasOnly: 1 of: testObjectsFactory itemSoldByTheStore.! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:33:48' prior: 50891501!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	
	self addAndCheckout: cartId quantity: 1 ofItem: testObjectsFactory itemSoldByTheStore inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	

	self assert: purchases hasOnly: 1 of: testObjectsFactory itemSoldByTheStore.
	self assert: purchases total equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:33:50' prior: 50891695!
test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	
	self addAndCheckout: cartId quantity: 1 ofItem: testObjectsFactory itemSoldByTheStore inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases hasOnly: 1 of: testObjectsFactory itemSoldByTheStore.
	self assert: purchases total equals: testObjectsFactory itemSoldByTheStorePrice.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:36:00' prior: 50891567!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	addedItem := self addTo: cartId quantity: 1 ofItemSoldByStore: storeService.
	self checkoutCart: cartId usingValidCreditCardIn: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	otherAddedItem := self addTo: anotherCartId quantity: 1 ofAnotherItemSoldByStore: storeService.
	self checkoutCart: anotherCartId usingValidCreditCardIn: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: addedItem) equals: 1.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 1.
	expectedTotal := 	testObjectsFactory itemSoldByTheStorePrice + testObjectsFactory anotherItemSoldByTheStorePrice.
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:37:27' prior: 50891741!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory itemSoldByTheStore) inStore: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory anotherItemSoldByTheStore) inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 4.
	self assert: (purchases products occurrencesOf: addedItem) equals: 1.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 1.
	expectedTotal := 	testObjectsFactory itemSoldByTheStorePrice + testObjectsFactory anotherItemSoldByTheStorePrice.
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:37:36' prior: 50891780!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId expectedTotal addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory itemSoldByTheStore) inStore: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory anotherItemSoldByTheStore) inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 2.
	self assert: (purchases products occurrencesOf: addedItem) equals: 1.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 1.
	expectedTotal := 	testObjectsFactory itemSoldByTheStorePrice + testObjectsFactory anotherItemSoldByTheStorePrice.
	self assert: purchases total equals: expectedTotal.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:37:57' prior: 50891817!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory itemSoldByTheStore) inStore: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory anotherItemSoldByTheStore) inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 2.
	self assert: (purchases products occurrencesOf: addedItem) equals: 1.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 1.
	self assert: purchases total equals: (	testObjectsFactory itemSoldByTheStorePrice + testObjectsFactory anotherItemSoldByTheStorePrice).
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:39:11' prior: 50891854!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory itemSoldByTheStore) inStore: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory itemSoldByTheStore) inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 2.
	self assert: (purchases products occurrencesOf: addedItem) equals: 1.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 1.
	self assert: purchases hasOnly: 2 ofItem: addedItem inStore: storeService.
	self assert: purchases total equals: (	testObjectsFactory itemSoldByTheStorePrice * 2).
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:39:57' prior: 50891889!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId addedItem otherAddedItem |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory itemSoldByTheStore) inStore: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory itemSoldByTheStore) inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 2.
	self assert: (purchases products occurrencesOf: addedItem) equals: 1.
	self assert: (purchases products occurrencesOf: otherAddedItem) equals: 1.
	self assert: purchases hasOnly: 2 ofItem: addedItem.
	self assert: purchases total equals: (	testObjectsFactory itemSoldByTheStorePrice * 2).
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:40:57' prior: 50891925!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId itemToAdd |

	storeService := self storeServiceAuthenticatingUsers.
	itemToAdd := testObjectsFactory itemSoldByTheStore.
	
	cartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: itemToAdd inStore: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: itemToAdd inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases hasOnly: 2 of: itemToAdd.
	self assert: purchases total equals: (	testObjectsFactory itemSoldByTheStorePrice * 2).
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:41:06' prior: 50891960!
test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases

	| storeService cartId purchases anotherCartId itemToAdd |

	storeService := self storeServiceAuthenticatingUsers.
	itemToAdd := testObjectsFactory itemSoldByTheStore.
	
	cartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: itemToAdd inStore: storeService.

	anotherCartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: anotherCartId quantity: 1 ofItem: itemToAdd inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases hasOnly: 2 of: itemToAdd.
	self assert: purchases total equals: (	testObjectsFactory itemSoldByTheStorePrice * 2).
	! !

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartCreatesAPurchaseContainingItems stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:41:13'!
PASSED!

!methodRemoval: StoreServiceTest #addTo:quantity:ofAnotherItemSoldByStore: stamp: 'PhG 11/11/2021 08:41:31'!
addTo: aCartId quantity: anAmount ofAnotherItemSoldByStore: aStoreService

	| itemToAdd |
	
	itemToAdd := testObjectsFactory anotherItemSoldByTheStore.
	aStoreService addToCart: aCartId quantity: anAmount of: itemToAdd.

	^itemToAdd.
!

!methodRemoval: StoreServiceTest #addTo:quantity:ofItemSoldByStore: stamp: 'PhG 11/11/2021 08:41:33'!
addTo: aCartId quantity: anAmount ofItemSoldByStore: aStoreService

	| itemToAdd |
	
	itemToAdd := testObjectsFactory itemSoldByTheStore.
	aStoreService addToCart: aCartId quantity: anAmount of: itemToAdd.

	^itemToAdd.
!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartCreatesAPurchaseContainingItems stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:41:47'!
PASSED!
!StoreServiceTest methodsFor: 'checkout cart tests' stamp: 'PhG 11/11/2021 08:43:36' prior: 50891673!
test10CheckoutWithValidCartCreatesAPurchaseContainingItems

	| storeService cartId purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	cartId  := self createCartForValidUserIn: storeService.
	self addAndCheckout: cartId quantity: 1 ofItem: (testObjectsFactory itemSoldByTheStore) inStore: storeService.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).

	self assert: purchases hasOnly: 1 of: testObjectsFactory itemSoldByTheStore.! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:44:25' prior: 50891104!
test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal

	| storeService purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	"self createCartForValidUserIn: storeService."
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 0.
	self assert: purchases total equals: 0.
	! !

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartCreatesAPurchaseContainingItems stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:44:26'!
PASSED!
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:44:29' prior: 50892232!
test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal

	| storeService purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 0.
	self assert: purchases total equals: 0.
	! !
!StoreServiceTest methodsFor: 'list purchases tests' stamp: 'PhG 11/11/2021 08:44:33' prior: 50892315!
test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal

	| storeService purchases |

	storeService := self storeServiceAuthenticatingUsers.
	
	purchases := storeService listPurchasesFor: (testObjectsFactory validUser) with: (testObjectsFactory validPassword).
	
	self assert: purchases products size equals: 0.
	self assert: purchases total equals: 0.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/11/2021 08:46:10' prior: 50889926!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	
	sale := self checkout: (carts at: aCartId) chargingOn: creditCard.
	
	userService registerPurchase: sale for: (userService userFor: aCartId).
		
	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/11/2021 08:46:50'!
removeCart: aCartId

	carts removeKey: aCartId.
	cartTimeout removeKey: aCartId! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/11/2021 08:46:50' prior: 50892345!
checkoutCart: aCartId payingWithCreditCard: aCardNumber expiringOn: anExpirationDate ownedBy: aCardOwner

	| creditCard sale |
	
	self assertCartExists: aCartId.
	self assertCartTimeout: aCartId.
	
	creditCard := CreditCard withCardNumber: aCardNumber expiring: anExpirationDate cardOwner: aCardOwner.
	
	sale := self checkout: (carts at: aCartId) chargingOn: creditCard.
	
	userService registerPurchase: sale for: (userService userFor: aCartId).
		
	self removeCart: aCartId.
	
	^self nextTransactionId.! !
!StoreService methodsFor: 'rest interface' stamp: 'PhG 11/11/2021 08:47:43' prior: 50889894!
createCartFor: aUsername with: aPassword
		
	| cartId |
	self assertAuthenticationForUser: aUsername withPassword: aPassword.
	
	cartId := self nextCartId.
	carts at: cartId put: (Cart acceptingItemsOf: catalogue).
	cartTimeout at: cartId put: clock now.
	userService registerCart: cartId for: aUsername.

	^cartId.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test01CreateCartWithInvalidCredentialsThrowsError stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test02WhenCreatingACartCredentialsAreValidated stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test03CreateCartWithValidCredentialsCreatesEmptyCart stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test04WhenAddingBookToCreatedCartBookIsReturnedInListCart stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test05AddBookNotSoldErrorIsInvalidBookError stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test06AddBookToInvalidCartThrowsError stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test07ListCartsShouldWorkWithDifferentCarts stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test08ListCartsShouldFailWithInvalidCart stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test09CheckoutInvalidCartShouldFail stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test10CheckoutWithValidCartCreatesAPurchaseContainingItems stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test11OperatingCartAfterExpirationTimeThrowsTimeoutError stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test12OperatingCartJustBeforeExpirationTimeRenewsExpirationTime stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test13ListPurchasesOfInvalidClientThrowsInvalidCredentialsError stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test14ListPurchasesOfClientWithOnePurchaseIsLastPurchase stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test15ListPurchasesOfClientWithTwoPurchaseIncludesBothPurchases stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

!testRun: #StoreServiceTest #test16ListPurchasesOfClientWithoutPurchaseHasNoItemsNorTotal stamp: 'PhG 11/11/2021 08:47:46'!
PASSED!

----QUIT----(11 November 2021 08:58:27) CuisUniversity-4532.image priorSource: 17866418!

----STARTUP---- (11 November 2021 17:03:40) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


----QUIT----(11 November 2021 18:52:56) CuisUniversity-4532.image priorSource: 17947522!

----STARTUP---- (11 November 2021 19:33:48) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


!classRemoval: #UserService stamp: 'PhG 11/11/2021 20:01:20'!
Object subclass: #UserService
	instanceVariableNames: 'usersByCart purchasesByUser'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #UserPurchases stamp: 'PhG 11/11/2021 20:01:20'!
Object subclass: #UserPurchases
	instanceVariableNames: 'products total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreTestObjectsFactory stamp: 'PhG 11/11/2021 20:01:21'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreService stamp: 'PhG 11/11/2021 20:01:21'!
Object subclass: #StoreService
	instanceVariableNames: 'authenticationService merchantProcessor carts latestCartId latestTransactionId catalogue salesBook cartTimeout clock userService'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Sale stamp: 'PhG 11/11/2021 20:01:21'!
Object subclass: #Sale
	instanceVariableNames: 'total products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'PhG 11/11/2021 20:01:22'!
Object subclass: #CreditCard
	instanceVariableNames: 'expirationDate cardNumber cardOwner expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'PhG 11/11/2021 20:01:22'!
Object subclass: #Cashier
	instanceVariableNames: 'cart salesBook merchantProcessor creditCard total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'PhG 11/11/2021 20:01:23'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreServiceTest stamp: 'PhG 11/11/2021 20:01:23'!
TestCase subclass: #StoreServiceTest
	instanceVariableNames: 'testObjectsFactory authenticationBehaviour debitBehavior timeoutBehaviour now'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'PhG 11/11/2021 20:01:24'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'PhG 11/11/2021 20:01:24'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/Packages/System/Collections-CompactArrays.pck.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/Packages/Features/Compression.pck.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/Packages/Features/Sound.pck.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/Packages/Features/Cryptography-DigitalSignatures.pck.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/Packages/Features/Identities-UUID.pck.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/Packages/System/Network-Kernel.pck.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/iteracion4/WebClient.pck.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/iteracion4/StringsServicesServer.st----!

----End fileIn of /Users/pgarrett/Documents/facultad/inge1/is1-2021-2C/20-TusLibros/iteracion4/Iteracion3/TusLibros-80.st----!

server := StringsServicesRestInterface listeningOn: 8080.!

server destroy.!

Object subclass: #TusLibrosRestAPI
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosRestAPI category: 'TusLibros-Model' stamp: 'PhG 11/11/2021 21:08:51'!
Object subclass: #TusLibrosRestAPI
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosRestAPI class methodsFor: 'nil' stamp: 'PhG 11/11/2021 21:09:13'!
listeningOn: aPortNumber

	^self new initializeWith: aPortNumber.! !

Object subclass: #TusLibrosRestAPI
	instanceVariableNames: 'webServer port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosRestAPI category: 'TusLibros-Model' stamp: 'PhG 11/11/2021 21:09:50'!
Object subclass: #TusLibrosRestAPI
	instanceVariableNames: 'webServer port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

Object subclass: #TusLibrosRestAPI
	instanceVariableNames: 'webServer port tusLibrosFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosRestAPI category: 'TusLibros-Model' stamp: 'PhG 11/11/2021 21:09:57'!
Object subclass: #TusLibrosRestAPI
	instanceVariableNames: 'webServer port tusLibrosFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosRestAPI methodsFor: 'nil' stamp: 'PhG 11/11/2021 21:10:20'!
initializeWith: aPortNumber
	
	| stringGenius |
	tusLibrosFacade := StringGenius new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!TusLibrosRestAPI methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 21:10:41' prior: 50931160!
initializeWith: aPortNumber
	
	tusLibrosFacade := StringGenius new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := tusLibrosFacade words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := tusLibrosFacade firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := tusLibrosFacade vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := tusLibrosFacade toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!TusLibrosRestAPI methodsFor: 'nil' stamp: 'PhG 11/11/2021 21:11:08'!
destroy
	
	webServer ifNotNil:[webServer destroy].! !
!TusLibrosRestAPI methodsFor: 'enabling services' stamp: 'PhG 11/11/2021 21:11:35'!
startListening
	
	webServer startListener.

	^'Listening on port: ', self port asString.
	! !
!TusLibrosRestAPI methodsFor: 'enabling services' stamp: 'PhG 11/11/2021 21:11:57'!
stopListening
	
	webServer stopListener.

	^'Stopped listening on port: ', self port asString.
	! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:12:13'!
port
	"Use a random port to minimise chances of concurrently running test suites clashing."
	"^ port
		ifNil: [port := (10000 to: 50000) atRandom]"
	
	^port ifNil: [port:=8080].
	
	! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:13:17' prior: 50931219!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := tusLibrosFacade words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := tusLibrosFacade firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := tusLibrosFacade vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := tusLibrosFacade toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:21:14' prior: 50931302!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |username := (request fields at:'username').
		password := (request fields at:'password').
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := tusLibrosFacade words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := tusLibrosFacade firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := tusLibrosFacade vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := tusLibrosFacade toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:21:37' prior: 50931361!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := tusLibrosFacade words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := tusLibrosFacade firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := tusLibrosFacade vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := tusLibrosFacade toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:23:59' prior: 50931431!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId cartIdAsJson bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		cartId := tusLibrosFacade addToCart: cartId of: bookIsbn.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:25:03' prior: 50931501!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId cartIdAsJson bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		cartId := tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedBy: cartId.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:25:18' prior: 50931540!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId cartIdAsJson bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		cartId := tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:26:21' prior: 50931580!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		cartId := tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:27:08' prior: 50931620!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		cartId := tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:28:17' prior: 50931658!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:28:41' prior: 50931708!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:29:17' prior: 50931757!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:32:36' prior: 50931808!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		cartContent := tusLibrosFacade .
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:33:20' prior: 50931871!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		cartContent := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:35:17' prior: 50931939!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:36:50' prior: 50932011!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].

	webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases). "consultar transaction id"
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:36:53' prior: 50932084!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].

	webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:00'!
registerCreateCart

	^ webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:00' prior: 50932173!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCart.
	
	webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].

	webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:13'!
registerAddToCart

	^ webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:13' prior: 50932280!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCart.
	
	self registerAddToCart.
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].

	webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:25' prior: 50932373!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCart.
	self registerAddToCart.
	
	webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].

	webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:30'!
registerListCart

	^ webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:30' prior: 50932434!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCart.
	self registerAddToCart.
	
	self registerListCart.
	
	webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].

	webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:41'!
registerCheckoutCart

	^ webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:41' prior: 50932511!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCart.
	self registerAddToCart.
	
	self registerListCart.
	
	self registerCheckoutCart.

	webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:51' prior: 50932586!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCart.
	self registerAddToCart.
	self registerListCart.
	self registerCheckoutCart.

	webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:57'!
registerListPurchases

	^ webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 21:38:57' prior: 50932613!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCart.
	self registerAddToCart.
	self registerListCart.
	self registerCheckoutCart.

	self registerListPurchases.! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:39:46'!
registerAddToCartEndpoint

	^ webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 21:39:46' prior: 50932659!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCart.
	self registerAddToCartEndpoint.
	self registerListCart.
	self registerCheckoutCart.

	self registerListPurchases.! !

!methodRemoval: TusLibrosRestAPI #registerAddToCart stamp: 'PhG 11/11/2021 21:39:46'!
registerAddToCart

	^ webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:39:52'!
registerCheckoutCartEndpoint

	^ webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 21:39:52' prior: 50932690!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCart.
	self registerAddToCartEndpoint.
	self registerListCart.
	self registerCheckoutCartEndpoint.

	self registerListPurchases.! !

!methodRemoval: TusLibrosRestAPI #registerCheckoutCart stamp: 'PhG 11/11/2021 21:39:52'!
registerCheckoutCart

	^ webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:39:57'!
registerCreateCartEndpoint

	^ webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 21:39:57' prior: 50932747!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCart.
	self registerCheckoutCartEndpoint.

	self registerListPurchases.! !

!methodRemoval: TusLibrosRestAPI #registerCreateCart stamp: 'PhG 11/11/2021 21:39:57'!
registerCreateCart

	^ webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:40:01'!
registerListCartEndpoint

	^ webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 21:40:01' prior: 50932805!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.

	self registerListPurchases.! !

!methodRemoval: TusLibrosRestAPI #registerListCart stamp: 'PhG 11/11/2021 21:40:01'!
registerListCart

	^ webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:40:06'!
registerListPurchasesEndpoint

	^ webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]! !
!TusLibrosRestAPI methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 21:40:06' prior: 50932853!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.

	self registerListPurchasesEndpoint.! !

!methodRemoval: TusLibrosRestAPI #registerListPurchases stamp: 'PhG 11/11/2021 21:40:06'!
registerListPurchases

	^ webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]]!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:40:52'!
respond400ErrorFor: request

	^ [ :anError |
			request send400Response: (anError messageText) ]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:40:52' prior: 50932882!
registerListPurchasesEndpoint

	^ webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: self respond400ErrorFor: request]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:40:59' prior: 50932941!
registerListPurchasesEndpoint

	^ webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases purchasesAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		purchasesAsJson := WebUtils jsonEncode: (purchases).
		request send200Response: (purchasesAsJson)
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:41:15' prior: 50932836!
registerListCartEndpoint

	^ webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:41:20' prior: 50932786!
registerCreateCartEndpoint

	^ webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:41:26' prior: 50932720!
registerCheckoutCartEndpoint

	^ webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket transactionIdAsJson |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		transactionIdAsJson := WebUtils jsonEncode: (ticket transactionId). "consultar transaction id"
		request send200Response: (transactionIdAsJson)
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:41:31' prior: 50932671!
registerAddToCartEndpoint

	^ webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		request send200Response: (WebUtils jsonEncode: ('OK'))
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:43:01'!
respond: request for: cartIdAsJson

	^ request send200Response: (cartIdAsJson)! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:43:01' prior: 50932995!
registerCreateCartEndpoint

	^ webServer addService: '/createCart' action:[:request |	
		
		[ | cartId cartIdAsJson password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		cartIdAsJson := WebUtils jsonEncode: (cartId).
		self respond: request for: cartIdAsJson
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:43:47' prior: 50933057!
respond: request for: cartIdAsJson
	
	| encodedResponse |

	encodedResponse := WebUtils jsonEncode: (cartIdAsJson ).
	^ request send200Response: (cartIdAsJson)! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:43:52' prior: 50933081!
respond: request for: cartIdAsJson
	
	| encodedResponse |

	encodedResponse := WebUtils jsonEncode: (cartIdAsJson ).
	^ request send200Response: (encodedResponse)! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:44:13' prior: 50933063!
registerCreateCartEndpoint

	^ webServer addService: '/createCart' action:[:request |	
		
		[ | cartId password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond: cartId for: request
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:44:31'!
respond200WithBody: request for: cartIdAsJson
	
	| encodedResponse |

	encodedResponse := WebUtils jsonEncode: (cartIdAsJson ).
	^ request send200Response: (encodedResponse)! !
!TusLibrosRestAPI methodsFor: 'as yet unclassified' stamp: 'PhG 11/11/2021 21:44:31' prior: 50933099!
registerCreateCartEndpoint

	^ webServer addService: '/createCart' action:[:request |	
		
		[ | cartId password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond200WithBody: cartId for: request
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !

!methodRemoval: TusLibrosRestAPI #respond:for: stamp: 'PhG 11/11/2021 21:44:31'!
respond: request for: cartIdAsJson
	
	| encodedResponse |

	encodedResponse := WebUtils jsonEncode: (cartIdAsJson ).
	^ request send200Response: (encodedResponse)!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:44:55' prior: 50933115!
respond200WithBody: responseBody for: request
	
	| encodedResponse |

	encodedResponse := WebUtils jsonEncode: responseBody.
	^ request send200Response: (encodedResponse)! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:45:17' prior: 50932979!
registerListCartEndpoint

	^ webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent cartContentAsJson |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		cartContentAsJson := WebUtils jsonEncode: (cartContent).
		request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:45:38' prior: 50933157!
registerListCartEndpoint

	^ webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		self respond200WithBody: cartContent for: request
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:45:43' prior: 50933173!
registerListCartEndpoint

	^ webServer addService: '/listCart' action:[:request |	
		
		[ | cartId cartContent |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		self respond200WithBody: cartContent for: request.
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:45:55' prior: 50932960!
registerListPurchasesEndpoint

	^ webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		self respond200WithBody: purchases for: request.
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:46:29' prior: 50933013!
registerCheckoutCartEndpoint

	^ webServer addService: '/checkOutCart' action:[:request |	
		
		[ | cartId cardNumber cardExpirationDate cardHolder ticket |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		self respond200WithBody: (ticket transactionId) for: request. "consultar transaction id"
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:46:52' prior: 50933039!
registerAddToCartEndpoint

	^ webServer addService: '/addToCart' action:[:request |	
		
		[ | cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		self respond200WithBody: 'OK' for: request
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !

----SNAPSHOT----(11 November 2021 21:47:19) CuisUniversity-4532.image priorSource: 17947744!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:49:12'!
registerEndpoint: endpoint withAction: action

	^ webServer addService: '/listPurchases' action:[:request |	
		
		[ | purchases password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		self respond200WithBody: purchases for: request.
		 ] 
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:51:02' prior: 50933262!
registerEndpoint: endpoint withAction: action

	^ webServer addService: endpoint action:[:request |	
		(action value: request)
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:51:39' prior: 50933187!
registerListCartEndpoint

	^ webServer addService: '/listCart' action:[:request |	 
		| cartId cartContent |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		self respond200WithBody: cartContent for: request.
		 ] ! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:51:42' prior: 50933289!
registerListCartEndpoint

	^ webServer addService: '/listCart' action:[:request |	 
		| cartId cartContent |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		self respond200WithBody: cartContent for: request.
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:52:08' prior: 50933201!
registerListPurchasesEndpoint

	^ webServer addService: '/listPurchases' action: [:request |
		 | purchases password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		self respond200WithBody: purchases for: request.
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:52:51' prior: 50933124!
registerCreateCartEndpoint

	^ webServer addService: '/createCart' action:[:request |	 | cartId password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond200WithBody: cartId for: request
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:52:59' prior: 50933218!
registerCheckoutCartEndpoint

	^ webServer addService: '/checkOutCart' action:[:request |	 | cartId cardNumber cardExpirationDate cardHolder ticket |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		self respond200WithBody: (ticket transactionId) for: request. "consultar transaction id"
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:53:01' prior: 50933343!
registerCheckoutCartEndpoint

	^ webServer addService: '/checkOutCart' action:[:request |	 
		| cartId cardNumber cardExpirationDate cardHolder ticket |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		self respond200WithBody: (ticket transactionId) for: request. "consultar transaction id"
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 21:53:13' prior: 50933242!
registerAddToCartEndpoint

	^ webServer addService: '/addToCart' action:[:request |	
		| cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		self respond200WithBody: 'OK' for: request
		 ].! !

----SNAPSHOT----(11 November 2021 21:53:19) CuisUniversity-4532.image priorSource: 19251466!
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/11/2021 22:08:29' prior: 50932902!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	"tusLibrosFacade := TusLibrosSystemFacade
		authenticatingWith: MockUserDB - self validUsersAndPasswords
		acceptingItemsOf: MockCatalogue - testObjectsFactory defaultCatalog
		registeringOn: self createSalesBook
		debitingThrought: MockMerchantProcessor new
		measuringTimeWith: RealClock new."
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.

	self registerListPurchasesEndpoint.! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/11/2021 22:08:45' prior: 50933365!
registerCheckoutCartEndpoint

	^ webServer addService: '/checkOutCart' action:[:request |	 
		| cartId cardNumber cardExpirationDate cardHolder ticket |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		self respond200WithBody: ('OK') for: request. "consultar transaction id"
		 ].! !

----QUIT----(11 November 2021 22:08:54) CuisUniversity-4532.image priorSource: 19256046!

----STARTUP---- (11 November 2021 22:09:31) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


----QUIT----(11 November 2021 22:09:41) CuisUniversity-4532.image priorSource: 19257564!

----STARTUP---- (13 November 2021 11:16:47) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


server := TusLibrosRestAPI listeningOn: 8081.!

server startListening.!

server destroy.!

server destroy.!

TusLibrosRestAPI allInstances !

TusLibrosRestAPI allInstances at: 1 destroy!

(TusLibrosRestAPI allInstances at: 1) destroy!

TusLibrosRestAPI allInstances !

TusLibrosRestAPI allInstances !

stringServer := StringsServicesRestInterface listeningOn: 8082.!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:29:12' prior: 50933387!
registerAddToCartEndpoint

	webServer addService: '/addToCart' action:[:request |	
		| cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		self respond200WithBody: 'OK' for: request
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:29:18' prior: 50933429!
registerCheckoutCartEndpoint

	webServer addService: '/checkOutCart' action:[:request |	 
		| cartId cardNumber cardExpirationDate cardHolder ticket |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		self respond200WithBody: ('OK') for: request. "consultar transaction id"
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:29:25' prior: 50933328!
registerCreateCartEndpoint

	webServer addService: '/createCart' action:[:request |	 | cartId password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond200WithBody: cartId for: request
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:29:29' prior: 50933280!
registerEndpoint: endpoint withAction: action

	webServer addService: endpoint action:[:request |	
		(action value: request)
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:29:32' prior: 50933301!
registerListCartEndpoint

	webServer addService: '/listCart' action:[:request |	 
		| cartId cartContent |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		self respond200WithBody: cartContent for: request.
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:29:36' prior: 50933313!
registerListPurchasesEndpoint

	webServer addService: '/listPurchases' action: [:request |
		 | purchases password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		self respond200WithBody: purchases for: request.
		 ].! !

tusLibrosServer := TusLibrosRestAPI listeningOn: 8083.!

tusLibrosServer destroy!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:31:44' prior: 50933536!
registerListCartEndpoint

	self registerEndpoint: '/listCart' withAction:[:request |	 
		| cartId cartContent |
		cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		self respond200WithBody: cartContent for: request.
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:31:56' prior: 50933548!
registerListPurchasesEndpoint

	self registerEndpoint: '/listPurchases' withAction: [:request |
		 | purchases password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		self respond200WithBody: purchases for: request.
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:32:03' prior: 50933513!
registerCreateCartEndpoint

	self registerEndpoint: '/createCart' withAction:[:request |	 | cartId password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond200WithBody: cartId for: request
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:32:11' prior: 50933492!
registerCheckoutCartEndpoint

	self registerEndpoint: '/checkOutCart' withAction:[:request |	 
		| cartId cardNumber cardExpirationDate cardHolder ticket |
		cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		self respond200WithBody: ('OK') for: request. "consultar transaction id"
		 ].! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:32:19' prior: 50933476!
registerAddToCartEndpoint

	self registerEndpoint: '/addToCart' withAction:[:request |	
		| cartId bookIsbn bookQuantity |
		cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		self respond200WithBody: 'OK' for: request
		 ].! !

tusLibrosServer := TusLibrosRestAPI listeningOn: 8083.!

tusLibrosServer destroy!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:34:10' prior: 50933593!
registerCreateCartEndpoint

	"self registerEndpoint: '/createCart' withAction:[:request |	 | cartId password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond200WithBody: cartId for: request
		 ]."
	
	webServer addService: '/createCart' action:[:request |	
		[ | cartId password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond200WithBody: cartId for: request
		 ]
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:34:40' prior: 50933649!
registerCreateCartEndpoint

	"self registerEndpoint: '/createCart' withAction:[:request |	 | cartId password username |
		username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond200WithBody: cartId for: request
		 ]."
	
	webServer addService: '/createCart' action:[:request |	| cartId password username |
		[username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond200WithBody: cartId for: request
		 ]
		on: Error 
		do: (self respond400ErrorFor: request)]! !

tusLibrosServer := TusLibrosRestAPI listeningOn: 8083.!

tusLibrosServer destroy!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:35:08' prior: 50933675!
registerCreateCartEndpoint
	
	webServer addService: '/createCart' action:[:request |	| cartId password username |
		[username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		cartId := tusLibrosFacade createCartFor: username authenticatedWith: password.
		self respond200WithBody: cartId for: request
		 ]
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:35:44' prior: 50933578!
registerListPurchasesEndpoint
	
	webServer addService: '/listPurchases' action:[:request |	 | purchases password username |
		[username := (request fields at: 'username' ).
		password := (request fields at: 'password' ).
		purchases := tusLibrosFacade listPurchasesOf: username authenticatingWith: password.
		self respond200WithBody: purchases for: request.]
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:36:36' prior: 50933566!
registerListCartEndpoint
	
	webServer addService: '/listCart' action:[:request |	 | cartId cartContent |
		[cartId := (request fields at: 'cartId' ).
		cartContent := tusLibrosFacade listCartIdentifiedAs: cartId.
		self respond200WithBody: cartContent for: request.]
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:37:11' prior: 50933608!
registerCheckoutCartEndpoint
	
	webServer addService: '/checkOutCart' action:[:request |	 | cartId cardNumber cardExpirationDate cardHolder ticket |
		[cartId := (request fields at: 'cartId' ).
		cardNumber := (request fields at: 'ccn' ).
		cardExpirationDate := (request fields at: 'cced' ).
		cardHolder := (request fields at: 'cco' ).
		ticket := tusLibrosFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardHolder expiringOn: cardExpirationDate.
		self respond200WithBody: ('OK') for: request. "consultar transaction id"]
		on: Error 
		do: (self respond400ErrorFor: request)]! !
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 11:37:41' prior: 50933630!
registerAddToCartEndpoint

	webServer addService: '/addToCart' action:[:request |	 | cartId bookIsbn bookQuantity |
		[cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade add: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		self respond200WithBody: 'OK' for: request]
		on: Error 
		do: (self respond400ErrorFor: request)]! !

!methodRemoval: TusLibrosRestAPI #registerEndpoint:withAction: stamp: 'PhG 11/13/2021 11:37:58'!
registerEndpoint: endpoint withAction: action

	webServer addService: endpoint action:[:request |	
		(action value: request)
		on: Error 
		do: (self respond400ErrorFor: request)]!

Object subclass: #UserDB
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #UserDB category: 'TusLibros-Model' stamp: 'PhG 11/13/2021 11:39:12'!
Object subclass: #UserDB
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

UserDB subclass: #MockUserDB
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #MockUserDB category: 'TusLibros-Model' stamp: 'PhG 11/13/2021 11:39:20'!
UserDB subclass: #MockUserDB
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!UserDB methodsFor: 'nil' stamp: 'PhG 11/13/2021 11:39:29'!
users
	self subclassResponsibility.! !
!MockUserDB methodsFor: 'nil' stamp: 'PhG 11/13/2021 11:39:46' overrides: 50933821!
users
	! !
!MockUserDB methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 11:40:02' prior: 50933825 overrides: 50933821!
users
	^Dictionary new
		at: self validUser put: self validUserPassword;
		yourself! !
!MockUserDB methodsFor: 'users' stamp: 'PhG 11/13/2021 11:40:47' prior: 50933829 overrides: 50933821!
users
	^Dictionary new
		at: 'maximilianoCozzetti' put: 'admin';
		yourself! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/13/2021 11:43:03' prior: 50933406!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	"tusLibrosFacade := TusLibrosSystemFacade
		authenticatingWith: MockUserDB new users
		acceptingItemsOf: MockCatalogue - testObjectsFactory defaultCatalog
		registeringOn: self createSalesBook
		debitingThrought: MockMerchantProcessor new
		measuringTimeWith: RealClock new."
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.

	self registerListPurchasesEndpoint.! !

Object subclass: #Catalogue
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #Catalogue category: 'TusLibros-Model' stamp: 'PhG 11/13/2021 11:43:13'!
Object subclass: #Catalogue
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

Catalogue subclass: #MockCatalogue
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #MockCatalogue category: 'TusLibros-Model' stamp: 'PhG 11/13/2021 11:43:18'!
Catalogue subclass: #MockCatalogue
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!Catalogue methodsFor: 'nil' stamp: 'PhG 11/13/2021 11:43:33'!
catalogue
	self subclassResponsibility.! !
!MockCatalogue methodsFor: 'no messages' stamp: 'PhG 11/13/2021 11:43:44' overrides: 50933885!
catalogue
	! !
!MockCatalogue methodsFor: 'catalogue' stamp: 'PhG 11/13/2021 11:44:40' prior: 50933890 overrides: 50933885!
catalogue
	^ Dictionary new
		at: self itemSellByTheStore put: self itemSellByTheStorePrice;
		at: self anotherItemSellByTheStore put: self anotherItemSellByTheStorePrice;
		yourself ! !
!MockCatalogue methodsFor: 'nil' stamp: 'PhG 11/13/2021 11:46:07'!
itemSellByTheStore

	^ 'El Pacto Coprnico'! !
!MockCatalogue methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 11:46:18'!
itemSoldByTheStore

	^ 'El Pacto Coprnico'! !
!MockCatalogue methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 11:46:18' prior: 50933894 overrides: 50933885!
catalogue
	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSellByTheStorePrice;
		at: self anotherItemSellByTheStore put: self anotherItemSellByTheStorePrice;
		yourself ! !

!methodRemoval: MockCatalogue #itemSellByTheStore stamp: 'PhG 11/13/2021 11:46:18'!
itemSellByTheStore

	^ 'El Pacto Coprnico'!
!MockCatalogue methodsFor: 'items' stamp: 'PhG 11/13/2021 11:47:13'!
anotherItemSoldByTheStore

	^'Los Impresentables'! !
!MockCatalogue methodsFor: 'items' stamp: 'PhG 11/13/2021 11:47:56'!
anotherItemSoldByTheStorePrice

	^15! !
!MockCatalogue methodsFor: 'items' stamp: 'PhG 11/13/2021 11:48:04'!
itemSoldByTheStorePrice

	^10! !
!MockCatalogue methodsFor: 'catalogue' stamp: 'PhG 11/13/2021 11:48:18' prior: 50933913 overrides: 50933885!
catalogue
	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSoldByTheStorePrice;
		at: self anotherItemSoldByTheStore put: self anotherItemSoldByTheStorePrice;
		yourself ! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/13/2021 11:48:47' prior: 50933841!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	"tusLibrosFacade := TusLibrosSystemFacade
		authenticatingWith: MockUserDB new users
		acceptingItemsOf: MockCatalogue new catalogue 
		registeringOn: self createSalesBook
		debitingThrought: MockMerchantProcessor new
		measuringTimeWith: RealClock new."
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.

	self registerListPurchasesEndpoint.! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/13/2021 11:49:23' prior: 50933948!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	"tusLibrosFacade := TusLibrosSystemFacade
		authenticatingWith: MockUserDB new users
		acceptingItemsOf: MockCatalogue new catalogue 
		registeringOn: OrderedCollection new
		debitingThrought: MockMerchantProcessor new
		measuringTimeWith: RealClock new."
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.

	self registerListPurchasesEndpoint.! !

----QUIT----(13 November 2021 11:51:38) CuisUniversity-4532.image priorSource: 19257786!

----STARTUP---- (13 November 2021 11:51:45) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!


MerchantProcessor subclass: #MockMerchantProcessor
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #MockMerchantProcessor category: 'TusLibros-Model' stamp: 'PhG 11/13/2021 11:52:10'!
MerchantProcessor subclass: #MockMerchantProcessor
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!MockMerchantProcessor methodsFor: 'no messages' stamp: 'PhG 11/13/2021 11:52:26' overrides: 50929909!
debit: anAmount from: aCreditCard! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'PhG 11/13/2021 11:54:24'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'PhG 11/13/2021 11:55:36'!
PASSED!
!MockMerchantProcessor methodsFor: 'debit' stamp: 'PhG 11/13/2021 12:01:54' prior: 50934012 overrides: 50929909!
debit: anAmount from: aCreditCard

	(self creditCardToBeRejected = aCreditCard) ifTrue: [self error: Cashier creditCardHasNoCreditErrorMessage].! !
!MockMerchantProcessor methodsFor: 'nil' stamp: 'PhG 11/13/2021 12:02:11'!
creditCardToBeRejected
	^CreditCard! !
!MockMerchantProcessor methodsFor: 'private - rejected credit card' stamp: 'PhG 11/13/2021 12:03:36'!
expiredMonthOfYear

	| today |
	^ Month month: today monthIndex year: today yearNumber - 1! !
!MockMerchantProcessor methodsFor: 'private - rejected credit card' stamp: 'PhG 11/13/2021 12:03:50' prior: 50934145!
creditCardToBeRejected
	^CreditCard expiringOn: self expiredMonthOfYear.! !
!MockMerchantProcessor methodsFor: 'private - rejected credit card' stamp: 'PhG 11/13/2021 12:03:53' prior: 50934157!
creditCardToBeRejected

	^CreditCard expiringOn: self expiredMonthOfYear.! !
!MockMerchantProcessor methodsFor: 'private - rejected credit card' stamp: 'PhG 11/13/2021 12:04:24' prior: 50934150!
expiredMonthOfYear

	| today |
	today := DateAndTime now
	^ Month month: today monthIndex year: today yearNumber - 1! !
!MockMerchantProcessor methodsFor: 'private - rejected credit card' stamp: 'PhG 11/13/2021 12:04:27' prior: 50934171!
expiredMonthOfYear

	| today |
	today := DateAndTime now.
	^ Month month: today monthIndex year: today yearNumber - 1! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/13/2021 12:05:33' prior: 50933970!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade new.
	"tusLibrosFacade := TusLibrosSystemFacade
		authenticatingWith: MockUserDB new users
		acceptingItemsOf: MockCatalogue new catalogue 
		registeringOn: OrderedCollection new
		debitingThrought: MockMerchantProcessor new
		measuringTimeWith: RealClock new."
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.

	self registerListPurchasesEndpoint.! !

Object subclass: #RealClock
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #RealClock category: 'TusLibros-Model' stamp: 'PhG 11/13/2021 12:14:03'!
Object subclass: #RealClock
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

Clock subclass: #RealClock
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #RealClock category: 'TusLibros-Model' stamp: 'PhG 11/13/2021 12:14:07'!
Clock subclass: #RealClock
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!RealClock methodsFor: 'nil' stamp: 'PhG 11/13/2021 12:14:17' overrides: 50929801!
now! !
!RealClock methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:14:19' overrides: 50929805!
today! !
!RealClock methodsFor: 'time' stamp: 'PhG 11/13/2021 12:14:43' prior: 50934230 overrides: 50929801!
now
	^DateAndTime now.! !
!RealClock methodsFor: 'time' stamp: 'PhG 11/13/2021 12:14:47' prior: 50934234 overrides: 50929805!
today
	^DateAndTime now.! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/13/2021 12:15:00' prior: 50934186!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade
		authenticatingWith: MockUserDB new users
		acceptingItemsOf: MockCatalogue new catalogue 
		registeringOn: OrderedCollection new
		debitingThrought: MockMerchantProcessor new
		measuringTimeWith: RealClock new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.

	self registerListPurchasesEndpoint.! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/13/2021 12:15:05' prior: 50934246!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade
		authenticatingWith: MockUserDB new users
		acceptingItemsOf: MockCatalogue new catalogue 
		registeringOn: OrderedCollection new
		debitingThrought: MockMerchantProcessor new
		measuringTimeWith: RealClock new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.
	self registerListPurchasesEndpoint.! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list cart' stamp: 'PhG 11/13/2021 12:18:33'!
test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty
	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list catalogue' stamp: 'PhG 11/13/2021 12:20:02' prior: 50934286!
test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty
	
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: OrderedCollection new
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: clock.

	self assert: (systemFacade listCatalogue) isEmpty.
	! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'PhG 11/13/2021 12:20:42'!
emptyCatalog

	^ Dictionary new! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list catalogue' stamp: 'PhG 11/13/2021 12:20:56' prior: 50934297!
test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty
	
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: testObjectsFactory emptyCatalog 
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: clock.

	self assert: (systemFacade listCatalogue) isEmpty.
	! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'PhG 11/13/2021 12:21:04'!
emptyCatalogue

	^ Dictionary new! !
!TusLibrosSystemFacadeTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:21:04' prior: 50934316!
test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty
	
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: testObjectsFactory emptyCatalogue 
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: clock.

	self assert: (systemFacade listCatalogue) isEmpty.
	! !

!methodRemoval: StoreTestObjectsFactory #emptyCatalog stamp: 'PhG 11/13/2021 12:21:04'!
emptyCatalog

	^ Dictionary new!

!testRun: #TusLibrosSystemFacadeTest #test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty stamp: 'PhG 11/13/2021 12:21:08'!
ERROR!
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'PhG 11/13/2021 12:21:30'!
listCatalogue
	self shouldBeImplemented.! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'PhG 11/13/2021 12:21:40' prior: 50934358!
listCatalogue
	^Dictionary new! !

!testRun: #TusLibrosSystemFacadeTest #test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty stamp: 'PhG 11/13/2021 12:21:42'!
PASSED!
!TusLibrosSystemFacadeTest methodsFor: 'tests - list catalogue' stamp: 'PhG 11/13/2021 12:22:07'!
test21ListCatalogueOfStoreWithCatalogueReturnsCatalogue

	self assert: (systemFacade listCatalogue) isEmpty.
	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list catalogue' stamp: 'PhG 11/13/2021 12:22:23' prior: 50934448!
test21ListCatalogueOfStoreWithCatalogueReturnsCatalogue

	self deny: (systemFacade listCatalogue) isEmpty.
	self assert 	! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/13/2021 12:22:42'!
itemSoldByTheStore

	^ 'validBook'! !
!TusLibrosSystemFacadeTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:42' prior: 50930753!
validBook

	^testObjectsFactory itemSoldByTheStore ! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:42' prior: 50930342!
test08CartRemembersTheNumberOfAddedItems

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:42' prior: 50930334!
test07CartDoesNotHoldNotAddedItems

	| cart |

	cart := testObjectsFactory createCart.

	self deny: (cart includes: testObjectsFactory itemSoldByTheStore)! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:42' prior: 50930451!
test05CashierChargesCreditCardUsingMerchantProcessor

	| cart cashier salesBook total creditCard debitedAmout debitedCreditCard  |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.

	cashier:= Cashier
		toCheckout: cart
		ownedBy: testObjectsFactory customer
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.

	debitBehavior := [ :anAmount :aCreditCard |
		debitedAmout := anAmount.
		debitedCreditCard := aCreditCard ].
	total := cashier checkOut total.

	self assert: debitedCreditCard = creditCard.
	self assert: debitedAmout = total.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:43' prior: 50930432!
test04CheckoutRegistersASale

	| cart cashier salesBook total |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	salesBook := OrderedCollection new.

	cashier:= Cashier
		toCheckout: cart
		ownedBy: testObjectsFactory customer
		charging: testObjectsFactory notExpiredCreditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.

	total := cashier checkOut total.

	self assert: salesBook size = 1.
	self assert: salesBook first total = total.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:43' prior: 50931055!
defaultCatalog

	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSellByTheStorePrice;
		at: self anotherItemSellByTheStore put: self anotherItemSellByTheStorePrice;
		yourself ! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:43' prior: 50930298!
test04CanNotAddNonPositiveNumberOfItems

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [cart add: 0 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:43' prior: 50930290!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |

	cart := testObjectsFactory createCart.

	cart add: testObjectsFactory itemSoldByTheStore.
	self deny: cart isEmpty ! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:43' prior: 50930325!
test06CartRemembersAddedItems

	| cart |

	cart := testObjectsFactory createCart.

	cart add: testObjectsFactory itemSoldByTheStore.
	self assert: (cart includes: testObjectsFactory itemSoldByTheStore)! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:43' prior: 50930393!
test02CalculatedTotalIsCorrect

	| cart cashier |

	cart := testObjectsFactory createCart.
	cart add: 2 of: testObjectsFactory itemSoldByTheStore.

	cashier :=  Cashier
		toCheckout: cart
		ownedBy: testObjectsFactory customer
		charging: testObjectsFactory notExpiredCreditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: OrderedCollection new.

	self assert: cashier checkOut total = (testObjectsFactory itemSellByTheStorePrice * 2)! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:43' prior: 50930410!
test03CanNotCheckoutWithAnExpiredCreditCart

	| cart salesBook |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	salesBook := OrderedCollection new.

	self
		should: [ Cashier
				toCheckout: cart
				ownedBy: testObjectsFactory customer
				charging: testObjectsFactory expiredCreditCard
				throught: self
				on: testObjectsFactory today
				registeringOn: salesBook ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier canNotChargeAnExpiredCreditCardErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:43' prior: 50930476!
test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit

	| cart cashier salesBook creditCard |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSoldByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 	debitBehavior := [ :anAmount :aCreditCard | self error: Cashier creditCardHasNoCreditErrorMessage].

	cashier:= Cashier
		toCheckout: cart
		ownedBy: testObjectsFactory customer
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.

	self
		should: [cashier checkOut ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardHasNoCreditErrorMessage.
			self assert: salesBook isEmpty ]! !

!methodRemoval: StoreTestObjectsFactory #itemSellByTheStore stamp: 'PhG 11/13/2021 12:22:43'!
itemSellByTheStore

	^ 'validBook'!
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/13/2021 12:22:49'!
anotherItemSoldByTheStore

	^'anotherValidBook'! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:49' prior: 50934538!
defaultCatalog

	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSellByTheStorePrice;
		at: self anotherItemSoldByTheStore put: self anotherItemSellByTheStorePrice;
		yourself ! !
!TusLibrosSystemFacadeTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:49' prior: 50930726!
anotherValidBook

	^testObjectsFactory anotherItemSoldByTheStore ! !

!methodRemoval: StoreTestObjectsFactory #anotherItemSellByTheStore stamp: 'PhG 11/13/2021 12:22:49'!
anotherItemSellByTheStore

	^'anotherValidBook'!
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/13/2021 12:22:56'!
itemSoldByTheStorePrice

	^10! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:56' prior: 50934580!
test02CalculatedTotalIsCorrect

	| cart cashier |

	cart := testObjectsFactory createCart.
	cart add: 2 of: testObjectsFactory itemSoldByTheStore.

	cashier :=  Cashier
		toCheckout: cart
		ownedBy: testObjectsFactory customer
		charging: testObjectsFactory notExpiredCreditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: OrderedCollection new.

	self assert: cashier checkOut total = (testObjectsFactory itemSoldByTheStorePrice * 2)! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:56' prior: 50934658!
defaultCatalog

	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSoldByTheStorePrice;
		at: self anotherItemSoldByTheStore put: self anotherItemSellByTheStorePrice;
		yourself ! !
!TusLibrosSystemFacadeTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:56' prior: 50930602!
test14ListPurchasesIncludesBoughtItems

	| cartId purchases |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade add: 1 of: self anotherValidBook toCartIdentifiedAs: cartId.
	systemFacade
		checkOutCartIdentifiedAs: cartId
		withCreditCardNumbered: '1111222233334444'
		ownedBy: 'Juan Perez'
		expiringOn: testObjectsFactory notExpiredMonthOfYear.

	purchases := systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword.

	self assert: (purchases at: self validBook) equals: (testObjectsFactory itemSoldByTheStorePrice * 2).
	self assert: (purchases at: self anotherValidBook) equals: testObjectsFactory anotherItemSellByTheStorePrice.! !
!TusLibrosSystemFacadeTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:22:56' prior: 50930774!
test10CanCheckoutACart

	| cartId purchases |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 1 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade
		checkOutCartIdentifiedAs: cartId
		withCreditCardNumbered: testObjectsFactory notExpiredCreditCardNumber
		ownedBy: testObjectsFactory notExpiredCreditCardOwner
		expiringOn: testObjectsFactory notExpiredMonthOfYear.

	purchases := systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword.

	self assert: (purchases at: self validBook) equals: testObjectsFactory itemSoldByTheStorePrice.
! !

!methodRemoval: StoreTestObjectsFactory #itemSellByTheStorePrice stamp: 'PhG 11/13/2021 12:22:56'!
itemSellByTheStorePrice

	^10!
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/13/2021 12:23:03'!
anotherItemSoldByTheStorePrice

	^15! !
!TusLibrosSystemFacadeTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:23:03' prior: 50934711!
test14ListPurchasesIncludesBoughtItems

	| cartId purchases |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade add: 1 of: self anotherValidBook toCartIdentifiedAs: cartId.
	systemFacade
		checkOutCartIdentifiedAs: cartId
		withCreditCardNumbered: '1111222233334444'
		ownedBy: 'Juan Perez'
		expiringOn: testObjectsFactory notExpiredMonthOfYear.

	purchases := systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword.

	self assert: (purchases at: self validBook) equals: (testObjectsFactory itemSoldByTheStorePrice * 2).
	self assert: (purchases at: self anotherValidBook) equals: testObjectsFactory anotherItemSoldByTheStorePrice.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:23:03' prior: 50934701!
defaultCatalog

	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSoldByTheStorePrice;
		at: self anotherItemSoldByTheStore put: self anotherItemSoldByTheStorePrice;
		yourself ! !

!methodRemoval: StoreTestObjectsFactory #anotherItemSellByTheStorePrice stamp: 'PhG 11/13/2021 12:23:03'!
anotherItemSellByTheStorePrice

	^15!
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'PhG 11/13/2021 12:23:08'!
defaultCatalogue

	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSoldByTheStorePrice;
		at: self anotherItemSoldByTheStore put: self anotherItemSoldByTheStorePrice;
		yourself ! !
!TusLibrosSystemFacadeTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:23:08' prior: 50930711 overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new.
	clock := ManualClock now: testObjectsFactory today.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: testObjectsFactory defaultCatalogue
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: clock
! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:23:08' prior: 50931050!
createCart

	^Cart acceptingItemsOf: self defaultCatalogue! !

!methodRemoval: StoreTestObjectsFactory #defaultCatalog stamp: 'PhG 11/13/2021 12:23:08'!
defaultCatalog

	^ Dictionary new
		at: self itemSoldByTheStore put: self itemSoldByTheStorePrice;
		at: self anotherItemSoldByTheStore put: self anotherItemSoldByTheStorePrice;
		yourself !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list catalogue' stamp: 'PhG 11/13/2021 12:24:41' prior: 50934456!
test21ListCatalogueOfStoreWithCatalogueReturnsCatalogue

	| catalogue |
	
	catalogue := systemFacade listCatalogue.

	self deny: catalogue isEmpty.
	self assert: (catalogue at: testObjectsFactory itemSoldByTheStore) equals: testObjectsFactory itemSoldByTheStorePrice.
	self assert: (catalogue at: testObjectsFactory anotherItemSoldByTheStore) equals: testObjectsFactory anotherItemSoldByTheStorePrice.! !

!testRun: #TusLibrosSystemFacadeTest #test21ListCatalogueOfStoreWithCatalogueReturnsCatalogue stamp: 'PhG 11/13/2021 12:24:42'!
FAILURE!

!classDefinition: #TusLibrosSystemFacade category: 'TusLibros-Model' stamp: 'PhG 11/13/2021 12:25:02'!
Object subclass: #TusLibrosSystemFacade
	instanceVariableNames: 'validUsersAndPasswords catalogue lastId merchantProcessor salesBook clock cartSessions'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosSystemFacade methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:25:02' prior: 50930152!
createCartFor: aUser authenticatedWith: aPassword

	^ self if: aUser authenticatesWith: aPassword do: [ | cartId cartSession |

		cartId := self generateCartId.
		cartSession := CartSession ownedBy: aUser with: (Cart acceptingItemsOf: catalogue) on: self..
		cartSessions at: cartId put: cartSession.

		cartId  ]! !
!TusLibrosSystemFacade methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:25:02' prior: 50930217!
initializeAuthenticatingWith: aValidUsersAndPasswords
	acceptingItemsOf: aCatalog
	registeringOn: aSalesBook
	debitingThrought: aMerchantProcessor
	measuringTimeWith: aClock

	validUsersAndPasswords := aValidUsersAndPasswords.
	catalogue := aCatalog.
	salesBook := aSalesBook.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.

	cartSessions := Dictionary new.
	lastId := 0.! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'PhG 11/13/2021 12:25:12' prior: 50934363!
listCatalogue
	^catalogue copy! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21ListCatalogueOfStoreWithCatalogueReturnsCatalogue stamp: 'PhG 11/13/2021 12:25:14'!
PASSED!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/13/2021 12:26:00'!
registerListCatalogueEndpoint
	
	webServer addService: '/listCatalogue' action:[:request |	 
		[self respond200WithBody: tusLibrosFacade listCatalogue for: request.]
		on: Error 
		do: (self respond400ErrorFor: request)]! !

tusLibrosServer := TusLibrosRestAPI listeningOn: 8083.!

tusLibrosServer destroy!
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'PhG 11/13/2021 12:26:48' prior: 50934266!
initializeWith: aPortNumber
	
	tusLibrosFacade := TusLibrosSystemFacade
		authenticatingWith: MockUserDB new users
		acceptingItemsOf: MockCatalogue new catalogue 
		registeringOn: OrderedCollection new
		debitingThrought: MockMerchantProcessor new
		measuringTimeWith: RealClock new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	self registerCreateCartEndpoint.
	self registerAddToCartEndpoint.
	self registerListCartEndpoint.
	self registerCheckoutCartEndpoint.
	self registerListPurchasesEndpoint.
	self registerListCatalogueEndpoint.! !

tusLibrosServer := TusLibrosRestAPI listeningOn: 8083.!

tusLibrosServer destroy!
!MockCatalogue methodsFor: 'items' stamp: 'PhG 11/13/2021 12:27:11' prior: 50933907!
itemSoldByTheStore

	^ 'El Pacto Copernico'! !

tusLibrosServer := TusLibrosRestAPI listeningOn: 8083.!

tusLibrosServer destroy!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:31:50'!
test09CanNotRemoveItemsThatNotBelongToStore

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:32:30'!
test10CartIsEmptyAfterAddingAndRemovingItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:32:52'!
test10CanNotRemoveNonPositiveNumberOfItems

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:33:19'!
test11CartIsEmptyAfterAddingAndRemovingItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !

!methodRemoval: CartTest #test10CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/13/2021 12:33:19'!
test10CartIsEmptyAfterAddingAndRemovingItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:36:27'!
test12CanNotRemoveMoreThanOneItemNotSoldByTheStore

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:37:05'!
test13RemovingOneOfTwoAddedItemsLeavesOneItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:37:45' prior: 50935090!
test09CanNotRemoveItemsThatNotBelongToStore

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [ cart remove: testObjectsFactory itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !

!testRun: #CartTest #test09CanNotRemoveItemsThatNotBelongToStore stamp: 'PhG 11/13/2021 12:37:49'!
ERROR!
!Cart methodsFor: 'remove' stamp: 'PhG 11/13/2021 12:38:05'!
remove: aString 
	self shouldBeImplemented.! !
!Cart methodsFor: 'removing' stamp: 'PhG 11/13/2021 12:38:42' prior: 50935176!
remove: anItem 

	self assertIsValidItem: anItem.! !

!testRun: #CartTest #test09CanNotRemoveItemsThatNotBelongToStore stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test09CanNotRemoveItemsThatNotBelongToStore stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test10CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test11CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test12CanNotRemoveMoreThanOneItemNotSoldByTheStore stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!

!testRun: #CartTest #test13RemovingOneOfTwoAddedItemsLeavesOneItem stamp: 'PhG 11/13/2021 12:38:52'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:39:31' prior: 50935110!
test10CanNotRemoveNonPositiveNumberOfItems

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [cart add: 0 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:39:41'!
test14RemovingOneOfTwoAddedItemsLeavesOneItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !

!methodRemoval: CartTest #test13RemovingOneOfTwoAddedItemsLeavesOneItem stamp: 'PhG 11/13/2021 12:39:41'!
test13RemovingOneOfTwoAddedItemsLeavesOneItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:39:46'!
test13CanNotRemoveMoreThanOneItemNotSoldByTheStore

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !

!methodRemoval: CartTest #test12CanNotRemoveMoreThanOneItemNotSoldByTheStore stamp: 'PhG 11/13/2021 12:39:46'!
test12CanNotRemoveMoreThanOneItemNotSoldByTheStore

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:39:50'!
test12CartIsEmptyAfterAddingAndRemovingItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !

!methodRemoval: CartTest #test11CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/13/2021 12:39:50'!
test11CartIsEmptyAfterAddingAndRemovingItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:39:53'!
test11CanNotRemoveNonPositiveNumberOfItems

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [cart add: 0 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !

!methodRemoval: CartTest #test10CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:39:53'!
test10CanNotRemoveNonPositiveNumberOfItems

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [cart add: 0 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:39:57'!
test10CanNotRemoveItemsThatNotBelongToStore

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [ cart remove: testObjectsFactory itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !

!methodRemoval: CartTest #test09CanNotRemoveItemsThatNotBelongToStore stamp: 'PhG 11/13/2021 12:39:57'!
test09CanNotRemoveItemsThatNotBelongToStore

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [ cart remove: testObjectsFactory itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:40:25'!
test09CanNotRemoveItemsFromEmptyCart

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [ cart remove: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart emptyCartErrorMessage.
			self assert: cart isEmpty ]! !
!Cart methodsFor: 'error signal' stamp: 'PhG 11/13/2021 12:41:47'!
signalCanNotRemoveFromEmptyCart

	self error: self invalidQuantityErrorMessage ! !
!Cart methodsFor: 'error signal' stamp: 'PhG 11/13/2021 12:41:54' prior: 50935373!
signalCanNotRemoveFromEmptyCart

	self error: self canNotRemoveFromEmptyCartErrorMessage ! !
!Cart methodsFor: 'error messages' stamp: 'PhG 11/13/2021 12:42:05'!
canNotRemoveFromEmptyCartErrorMessage

	^self class invalidItemErrorMessage ! !
!Cart class methodsFor: 'error messages' stamp: 'PhG 11/13/2021 12:42:17'!
canNotRemoveFromEmptyCartErrorMessage

	^'Can not remove items from empty cart'! !
!Cart methodsFor: 'assertions' stamp: 'PhG 11/13/2021 12:43:08'!
assertCartIsNotEmpty

	self size = 0 ifTrue: [self signalCanNotRemoveFromEmptyCart ]! !
!Cart methodsFor: 'assertions' stamp: 'PhG 11/13/2021 12:43:24' prior: 50935395!
assertCartIsNotEmpty

	self isEmpty ifTrue: [self signalCanNotRemoveFromEmptyCart ]! !

!testRun: #CartTest #test09CanNotRemoveItemsFromEmptyCart stamp: 'PhG 11/13/2021 12:43:36'!
FAILURE!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:43:44' prior: 50935360!
test09CanNotRemoveItemsFromEmptyCart

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [ cart remove: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart canNotRemoveFromEmptyCartErrorMessage .
			self assert: cart isEmpty ]! !

!testRun: #CartTest #test09CanNotRemoveItemsFromEmptyCart stamp: 'PhG 11/13/2021 12:43:44'!
FAILURE!
!Cart methodsFor: 'removing' stamp: 'PhG 11/13/2021 12:44:07' prior: 50935180!
remove: anItem 

	self assertCartIsNotEmpty.	
	self assertIsValidItem: anItem.
	! !

!testRun: #CartTest #test09CanNotRemoveItemsFromEmptyCart stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test09CanNotRemoveItemsFromEmptyCart stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test10CanNotRemoveItemsThatNotBelongToStore stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test11CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test12CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test13CanNotRemoveMoreThanOneItemNotSoldByTheStore stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!

!testRun: #CartTest #test14RemovingOneOfTwoAddedItemsLeavesOneItem stamp: 'PhG 11/13/2021 12:44:13'!
PASSED!
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'PhG 11/13/2021 12:44:27'!
itemNotSoldByTheStore

	^'invalidBook'! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:44:27' prior: 50930311!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [cart add: 2 of: testObjectsFactory itemNotSoldByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!TusLibrosSystemFacadeTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:44:27' prior: 50930732!
invalidBook

	^testObjectsFactory itemNotSoldByTheStore ! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:44:27' prior: 50935333!
test10CanNotRemoveItemsThatNotBelongToStore

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [ cart remove: testObjectsFactory itemNotSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'PhG 11/13/2021 12:44:27' prior: 50930277!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [ cart add: testObjectsFactory itemNotSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !

!methodRemoval: StoreTestObjectsFactory #itemNotSellByTheStore stamp: 'PhG 11/13/2021 12:44:27'!
itemNotSellByTheStore

	^'invalidBook'!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:44:39' prior: 50935306!
test11CanNotRemoveNonPositiveNumberOfItems

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [cart remove: 0 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !

!testRun: #CartTest #test11CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:44:40'!
ERROR!
!Cart methodsFor: 'removing' stamp: 'PhG 11/13/2021 12:44:49'!
remove: aSmallInteger of: aString 
	self shouldBeImplemented.! !
!Cart methodsFor: 'removing' stamp: 'PhG 11/13/2021 12:45:15' prior: 50935427!
remove: anItem 

	^self remove: 1 of: anItem.
	! !
!Cart methodsFor: 'removing' stamp: 'PhG 11/13/2021 12:45:25' prior: 50935556!
remove: aSmallInteger of: anItem 

	self assertCartIsNotEmpty.	
	self assertIsValidItem: anItem.! !
!Cart methodsFor: 'removing' stamp: 'PhG 11/13/2021 12:45:49' prior: 50935566!
remove: aQuantity of: anItem 

	self assertCartIsNotEmpty.	
	self assertIsValidQuantity: aQuantity.
	self assertIsValidItem: anItem.! !

!testRun: #CartTest #test11CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:46:00'!
FAILURE!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:46:19' prior: 50935539!
test11CanNotRemoveNonPositiveNumberOfItems

	| cart |

	cart := testObjectsFactory createCart.
	cart add: 1 of: testObjectsFactory itemSoldByTheStore.

	self
		should: [cart remove: 0 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !

!testRun: #CartTest #test11CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:46:20'!
FAILURE!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:46:37' prior: 50935583!
test11CanNotRemoveNonPositiveNumberOfItems

	| cart |

	cart := testObjectsFactory createCart.
	cart add: 1 of: testObjectsFactory itemSoldByTheStore.

	self
		should: [cart remove: 0 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self deny: cart isEmpty ]! !

!testRun: #CartTest #test11CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test09CanNotRemoveItemsFromEmptyCart stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test10CanNotRemoveItemsThatNotBelongToStore stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test11CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test12CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test13CanNotRemoveMoreThanOneItemNotSoldByTheStore stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!

!testRun: #CartTest #test14RemovingOneOfTwoAddedItemsLeavesOneItem stamp: 'PhG 11/13/2021 12:46:38'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'PhG 11/13/2021 12:47:25' prior: 50935286!
test12CartIsEmptyAfterAddingAndRemovingItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 1 of: testObjectsFactory itemSoldByTheStore.
	cart remove: 1 of: testObjectsFactory itemSoldByTheStore.
	
	self assert: cart isEmpty.
! !

!testRun: #CartTest #test12CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/13/2021 12:47:27'!
FAILURE!
!Cart methodsFor: 'removing' stamp: 'PhG 11/13/2021 12:47:58' prior: 50935572!
remove: aQuantity of: anItem 

	self assertCartIsNotEmpty.	
	self assertIsValidQuantity: aQuantity.
	self assertIsValidItem: anItem.
	
	items ! !

----QUIT----(13 November 2021 12:59:26) CuisUniversity-4532.image priorSource: 19274889!

----STARTUP---- (14 November 2021 17:04:40) as /Users/pgarrett/Documents/facultad/inge1/cuisUniversity/CuisUniversity-4532.image!

!CartTest methodsFor: 'tests' stamp: 'PhG 11/14/2021 17:05:55' prior: 50935265!
test13CanNotRemoveMoreThanOneItemNotSoldByTheStore

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 1 of: testObjectsFactory itemSoldByTheStore.
	cart remove: 2 of: testObjectsFactory itemNotSoldByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 2! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/14/2021 17:06:21' prior: 50935695!
test13CanNotRemoveMoreThanOneItemNotSoldByTheStore

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [ cart remove: 2 of: testObjectsFactory itemNotSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/14/2021 17:07:03' prior: 50935244!
test14RemovingOneOfTwoAddedItemsLeavesOneItem

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	cart remove: 1 of: testObjectsFactory itemSoldByTheStore.

	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 1.! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/14/2021 17:07:20'!
test15CanNotRemoveMoreItemsThanAddedInCart

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSoldByTheStore.
	cart remove: 1 of: testObjectsFactory itemSoldByTheStore.

	self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) = 1.! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/14/2021 17:07:50' prior: 50935733!
test15CanNotRemoveMoreItemsThanAddedInCart

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 1 of: testObjectsFactory itemSoldByTheStore.

	self
		should: [cart remove: 2 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self deny: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'PhG 11/14/2021 17:08:21' prior: 50935745!
test15CanNotRemoveMoreItemsThanAddedInCart

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 1 of: testObjectsFactory itemSoldByTheStore.

	self
		should: [cart remove: 2 of: testObjectsFactory itemSoldByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: (cart occurrencesOf: testObjectsFactory itemSoldByTheStore) equals: 1]! !

!testRun: #CartTest #test12CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/14/2021 17:08:47'!
FAILURE!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test09CanNotRemoveItemsFromEmptyCart stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test10CanNotRemoveItemsThatNotBelongToStore stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test11CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test12CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/14/2021 17:08:52'!
FAILURE!

!testRun: #CartTest #test13CanNotRemoveMoreThanOneItemNotSoldByTheStore stamp: 'PhG 11/14/2021 17:08:52'!
PASSED!

!testRun: #CartTest #test14RemovingOneOfTwoAddedItemsLeavesOneItem stamp: 'PhG 11/14/2021 17:08:52'!
FAILURE!

!testRun: #CartTest #test15CanNotRemoveMoreItemsThanAddedInCart stamp: 'PhG 11/14/2021 17:08:52'!
FAILURE!
!Cart methodsFor: 'removing' stamp: 'PhG 11/14/2021 17:10:25' prior: 50935681!
remove: aQuantity of: anItem 

	self assertCartIsNotEmpty.	
	self assertIsValidQuantity: aQuantity.
	self assertIsValidItem: anItem.
	
	aQuantity timesRepeat: [items remove: anItem.].! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test09CanNotRemoveItemsFromEmptyCart stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test10CanNotRemoveItemsThatNotBelongToStore stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test11CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test12CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test13CanNotRemoveMoreThanOneItemNotSoldByTheStore stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test14RemovingOneOfTwoAddedItemsLeavesOneItem stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test15CanNotRemoveMoreItemsThanAddedInCart stamp: 'PhG 11/14/2021 17:10:50'!
FAILURE!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21ListCatalogueOfStoreWithCatalogueReturnsCatalogue stamp: 'PhG 11/14/2021 17:10:50'!
PASSED!

!testRun: #CartTest #test15CanNotRemoveMoreItemsThanAddedInCart stamp: 'PhG 11/14/2021 17:10:50'!
FAILURE!
!Cart methodsFor: 'assertions' stamp: 'PhG 11/14/2021 17:12:31'!
assertValidRemovedItems: aQuantity of: anItem

	(aQuantity > (items occurrencesOf: anItem)) ifTrue: [self signalInvalidQuantity ].! !
!Cart methodsFor: 'removing' stamp: 'PhG 11/14/2021 17:13:09' prior: 50935831!
remove: aQuantity of: anItem 

	self assertCartIsNotEmpty.	
	self assertIsValidQuantity: aQuantity.
	self assertIsValidItem: anItem.
	self assertValidRemovedItems: aQuantity of: anItem.
	
	aQuantity timesRepeat: [items remove: anItem.].! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test09CanNotRemoveItemsFromEmptyCart stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test10CanNotRemoveItemsThatNotBelongToStore stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test11CanNotRemoveNonPositiveNumberOfItems stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test12CartIsEmptyAfterAddingAndRemovingItem stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test13CanNotRemoveMoreThanOneItemNotSoldByTheStore stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test14RemovingOneOfTwoAddedItemsLeavesOneItem stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CartTest #test15CanNotRemoveMoreItemsThanAddedInCart stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20ListCatalogueOfStoreWithoutCatalogueReturnsEmpty stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21ListCatalogueOfStoreWithCatalogueReturnsCatalogue stamp: 'PhG 11/14/2021 17:13:11'!
PASSED!

----SNAPSHOT----(14 November 2021 17:13:32) CuisUniversity-4532.image priorSource: 19329201!
!TusLibrosRestAPI methodsFor: 'register endpoints' stamp: 'PhG 11/14/2021 17:14:27'!
registerRemoveFromCartEndpoint

	webServer addService: '/removeFromCart' action:[:request |	 | cartId bookIsbn bookQuantity |
		[cartId := (request fields at: 'cartId' ).
		bookIsbn := (request fields at: 'bookIsbn' ).
		bookQuantity := (request fields at: 'bookQuantity' ).
		tusLibrosFacade remove: bookQuantity of: bookIsbn toCartIdentifiedAs: cartId.
		self respond200WithBody: 'OK' for: request]
		on: Error 
		do: (self respond400ErrorFor: request)]! !

----QUIT----(14 November 2021 17:14:45) CuisUniversity-4532.image priorSource: 19344300!